<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>phylogenies | Integrated Bioanalytics</title>

    <meta name="author" content="Lucas Busta and members of the Busta lab" />
  
   <meta name="description" content="phylogenies | Integrated Bioanalytics is a book describing how to perform chemical, phylogenetic, and genomic analyses." />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="phylogenies | Integrated Bioanalytics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="phylogenies | Integrated Bioanalytics is a book describing how to perform chemical, phylogenetic, and genomic analyses." />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="phylogenies | Integrated Bioanalytics" />
  
  <meta name="twitter:description" content="phylogenies | Integrated Bioanalytics is a book describing how to perform chemical, phylogenetic, and genomic analyses." />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <link href="libs/Lato-0.4.6/font.css" rel="stylesheet" />
    <link href="libs/Roboto_Mono-0.4.6/font.css" rel="stylesheet" />
    <link href="libs/Montserrat-0.4.6/font.css" rel="stylesheet" />
    <script src="libs/bs3compat-0.4.2/transition.js"></script>
    <script src="libs/bs3compat-0.4.2/tabs.js"></script>
    <script src="libs/bs3compat-0.4.2/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-99618359-1', 'auto');
      ga('send', 'pageview');

    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
    <link rel="stylesheet" href="style/style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h2>
        <a href="index.html" title="">Integrated Bioanalytics</a>
      </h2>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="phylogenies" class="section level1 unnumbered">
<h1>phylogenies</h1>
<div id="buildtree" class="section level2" number="1.14">
<h2><span class="header-section-number">1.14</span> buildTree</h2>
<p>This function is a swiss army knife for tree building. It takes as input alignments or existing phylogenies from which to derive a phylogeny of interest, it can use neighbor-joining or maximum liklihood methods (with model optimization), it can run bootstrap replicates, and it can calculate ancestral sequence states. To illustrate, let’s look at some examples:</p>
<div id="newick-input" class="section level3" number="1.14.1">
<h3><span class="header-section-number">1.14.1</span> newick input</h3>
<p>Let’s use the Busta lab’s plant phylogeny [derived from Qian et al., 2016] to build a phylogeny with five species in it.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="phylogenies.html#cb147-1" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> <span class="fu">buildTree</span>(</span>
<span id="cb147-2"><a href="phylogenies.html#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaffold_type =</span> <span class="st">&quot;newick&quot;</span>,</span>
<span id="cb147-3"><a href="phylogenies.html#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaffold =</span> <span class="st">&quot;https://thebustalab.github.io/data/plant_phylogeny.newick&quot;</span>,</span>
<span id="cb147-4"><a href="phylogenies.html#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">members =</span> <span class="fu">c</span>(<span class="st">&quot;Sorghum_bicolor&quot;</span>, <span class="st">&quot;Zea_mays&quot;</span>, <span class="st">&quot;Setaria_viridis&quot;</span>, <span class="st">&quot;Arabidopsis_thaliana&quot;</span>, <span class="st">&quot;Amborella_trichopoda&quot;</span>)</span>
<span id="cb147-5"><a href="phylogenies.html#cb147-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb147-6"><a href="phylogenies.html#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Pro tip: most tree read/write functions reset node numbers.</span></span>
<span id="cb147-7"><a href="phylogenies.html#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Fortify your tree and save it as a csv file to preserve node numbering.</span></span>
<span id="cb147-8"><a href="phylogenies.html#cb147-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Do not save your tree as a newick or nexus file.</span></span>
<span id="cb147-9"><a href="phylogenies.html#cb147-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-10"><a href="phylogenies.html#cb147-10" aria-hidden="true" tabindex="-1"></a>tree</span>
<span id="cb147-11"><a href="phylogenies.html#cb147-11" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb147-12"><a href="phylogenies.html#cb147-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Phylogenetic tree with 5 tips and 4 internal nodes.</span></span>
<span id="cb147-13"><a href="phylogenies.html#cb147-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb147-14"><a href="phylogenies.html#cb147-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Tip labels:</span></span>
<span id="cb147-15"><a href="phylogenies.html#cb147-15" aria-hidden="true" tabindex="-1"></a><span class="do">##   Amborella_trichopoda, Zea_mays, Sorghum_bicolor, Setaria_viridis, Arabidopsis_thaliana</span></span>
<span id="cb147-16"><a href="phylogenies.html#cb147-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Node labels:</span></span>
<span id="cb147-17"><a href="phylogenies.html#cb147-17" aria-hidden="true" tabindex="-1"></a><span class="do">##   , , , </span></span>
<span id="cb147-18"><a href="phylogenies.html#cb147-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb147-19"><a href="phylogenies.html#cb147-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Rooted; includes branch lengths.</span></span>
<span id="cb147-20"><a href="phylogenies.html#cb147-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-21"><a href="phylogenies.html#cb147-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-203-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Cool! We got our phylogeny. What happens if we want to build a phylogeny that has a species on it that isn’t in our scaffold? For example, what if we want to build a phylogeny that includes <em>Arabidopsis neglecta</em>? We can include that name in our list of members:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="phylogenies.html#cb148-1" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> <span class="fu">buildTree</span>(</span>
<span id="cb148-2"><a href="phylogenies.html#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaffold_type =</span> <span class="st">&quot;newick&quot;</span>,</span>
<span id="cb148-3"><a href="phylogenies.html#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaffold_in_path =</span> <span class="st">&quot;https://thebustalab.github.io/data/plant_phylogeny.newick&quot;</span>,</span>
<span id="cb148-4"><a href="phylogenies.html#cb148-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">members =</span> <span class="fu">c</span>(<span class="st">&quot;Sorghum_bicolor&quot;</span>, <span class="st">&quot;Zea_mays&quot;</span>, <span class="st">&quot;Setaria_viridis&quot;</span>, <span class="st">&quot;Arabidopsis_neglecta&quot;</span>, <span class="st">&quot;Amborella_trichopoda&quot;</span>)</span>
<span id="cb148-5"><a href="phylogenies.html#cb148-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb148-6"><a href="phylogenies.html#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Arabidopsis_thaliana substituted with Arabidopsis_neglecta </span></span>
<span id="cb148-7"><a href="phylogenies.html#cb148-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Pro tip: most tree read/write functions reset node numbers.</span></span>
<span id="cb148-8"><a href="phylogenies.html#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Fortify your tree and save it as a csv file to preserve node numbering.</span></span>
<span id="cb148-9"><a href="phylogenies.html#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Do not save your tree as a newick or nexus file.</span></span>
<span id="cb148-10"><a href="phylogenies.html#cb148-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-11"><a href="phylogenies.html#cb148-11" aria-hidden="true" tabindex="-1"></a>tree</span>
<span id="cb148-12"><a href="phylogenies.html#cb148-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb148-13"><a href="phylogenies.html#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Phylogenetic tree with 5 tips and 4 internal nodes.</span></span>
<span id="cb148-14"><a href="phylogenies.html#cb148-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb148-15"><a href="phylogenies.html#cb148-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Tip labels:</span></span>
<span id="cb148-16"><a href="phylogenies.html#cb148-16" aria-hidden="true" tabindex="-1"></a><span class="do">##   Amborella_trichopoda, Zea_mays, Sorghum_bicolor, Setaria_viridis, Arabidopsis_neglecta</span></span>
<span id="cb148-17"><a href="phylogenies.html#cb148-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Node labels:</span></span>
<span id="cb148-18"><a href="phylogenies.html#cb148-18" aria-hidden="true" tabindex="-1"></a><span class="do">##   , , , </span></span>
<span id="cb148-19"><a href="phylogenies.html#cb148-19" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb148-20"><a href="phylogenies.html#cb148-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Rooted; includes branch lengths.</span></span>
<span id="cb148-21"><a href="phylogenies.html#cb148-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-22"><a href="phylogenies.html#cb148-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-204-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Note that <code>buildTree</code> informs us: “Scaffold newick tip Arabidopsis_thaliana substituted with Arabidopsis_neglecta”. This means that <em>Arabidopsis neglecta</em> was grafted onto the tip originally occupied by <em>Arabidopsis thaliana</em>. This behaviour is useful when operating on a large phylogenetic scale (i.e. where <em>exact</em> phylogeny topology is not critical below the family level). However, if a person is interested in using an existing newick tree as a scaffold for a phylogeny where genus-level topology <em>is</em> critical, then beware! Your scaffold may not be appropriate if you see that message. When operating at the genus level, you probably want to use sequence data to build your phylogeny anyway. So let’s look at how to do that:</p>
</div>
<div id="alignment-input" class="section level3" number="1.14.2">
<h3><span class="header-section-number">1.14.2</span> alignment input</h3>
<p>Arguments in this case are:</p>
<ul>
<li>“scaffold_type”: “amin_alignment” or “nucl_alignment” for amino acids or nucleotides.</li>
<li>“scaffold_in_path”: path to the fasta file that contains the alignment from which you want to build a tree.</li>
<li>“ml”: Logical, TRUE if you want to use maximum liklihood, FALSE if not, in which case neighbor joining will ne used.</li>
<li>“model_test”: if you say TRUE to “ml”, should buildTree test different maximum liklihood models and then use the “best” one?</li>
<li>“bootstrap”: TRUE or FALSE, whether you want bootstrap values on the nodes.</li>
<li>“ancestral_states”: TRUE or FALSE, should buildTree() compute the ancestral sequence at each node?</li>
<li>“root”: NULL, or the name of an accession that should form the root of the tree.</li>
</ul>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="phylogenies.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">buildTree</span>(</span>
<span id="cb149-2"><a href="phylogenies.html#cb149-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaffold_type =</span> <span class="st">&quot;amin_alignment&quot;</span>,</span>
<span id="cb149-3"><a href="phylogenies.html#cb149-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaffold_in_path =</span> <span class="st">&quot;/path_to/a_folder_for_alignments/all_amin_seqs.fa&quot;</span>,</span>
<span id="cb149-4"><a href="phylogenies.html#cb149-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ml =</span> <span class="cn">FALSE</span>, </span>
<span id="cb149-5"><a href="phylogenies.html#cb149-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_test =</span> <span class="cn">FALSE</span>,</span>
<span id="cb149-6"><a href="phylogenies.html#cb149-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">bootstrap =</span> <span class="cn">FALSE</span>,</span>
<span id="cb149-7"><a href="phylogenies.html#cb149-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ancestral_states =</span> <span class="cn">FALSE</span>,</span>
<span id="cb149-8"><a href="phylogenies.html#cb149-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">root =</span> <span class="cn">NULL</span></span>
<span id="cb149-9"><a href="phylogenies.html#cb149-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="plotting-trees" class="section level2" number="1.15">
<h2><span class="header-section-number">1.15</span> plotting trees</h2>
<p>There are several approaches to plotting trees. A simple one is using the base <code>plot</code> function:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="phylogenies.html#cb150-1" aria-hidden="true" tabindex="-1"></a>test_tree_small <span class="ot">&lt;-</span> <span class="fu">buildTree</span>(</span>
<span id="cb150-2"><a href="phylogenies.html#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaffold_type =</span> <span class="st">&quot;newick&quot;</span>,</span>
<span id="cb150-3"><a href="phylogenies.html#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaffold_in_path =</span> <span class="st">&quot;https://thebustalab.github.io/data/plant_phylogeny.newick&quot;</span>,</span>
<span id="cb150-4"><a href="phylogenies.html#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">members =</span> <span class="fu">c</span>(<span class="st">&quot;Sorghum_bicolor&quot;</span>, <span class="st">&quot;Zea_mays&quot;</span>, <span class="st">&quot;Setaria_viridis&quot;</span>)</span>
<span id="cb150-5"><a href="phylogenies.html#cb150-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb150-6"><a href="phylogenies.html#cb150-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Pro tip: most tree read/write functions reset node numbers.</span></span>
<span id="cb150-7"><a href="phylogenies.html#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Fortify your tree and save it as a csv file to preserve node numbering.</span></span>
<span id="cb150-8"><a href="phylogenies.html#cb150-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Do not save your tree as a newick or nexus file.</span></span>
<span id="cb150-9"><a href="phylogenies.html#cb150-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-10"><a href="phylogenies.html#cb150-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(test_tree_small)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-206-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Though this can get messy when there are lots of tip labels:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="phylogenies.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">122</span>)</span>
<span id="cb151-2"><a href="phylogenies.html#cb151-2" aria-hidden="true" tabindex="-1"></a>test_tree_big <span class="ot">&lt;-</span> <span class="fu">buildTree</span>(</span>
<span id="cb151-3"><a href="phylogenies.html#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaffold_type =</span> <span class="st">&quot;newick&quot;</span>,</span>
<span id="cb151-4"><a href="phylogenies.html#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">scaffold_in_path =</span> <span class="st">&quot;https://thebustalab.github.io/data/plant_phylogeny.newick&quot;</span>,</span>
<span id="cb151-5"><a href="phylogenies.html#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">members =</span> plant_species<span class="sc">$</span>Genus_species[<span class="fu">abs</span>(<span class="fu">floor</span>(<span class="fu">rnorm</span>(<span class="dv">60</span>)<span class="sc">*</span><span class="dv">100000</span>))]</span>
<span id="cb151-6"><a href="phylogenies.html#cb151-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb151-7"><a href="phylogenies.html#cb151-7" aria-hidden="true" tabindex="-1"></a><span class="do">## The following species belong to a genus not found in the newick scaffold and were removed: </span></span>
<span id="cb151-8"><a href="phylogenies.html#cb151-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Steirodiscus_schlechteri</span></span>
<span id="cb151-9"><a href="phylogenies.html#cb151-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Phyllagathis_marumiaetricha</span></span>
<span id="cb151-10"><a href="phylogenies.html#cb151-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Jungia_sordida</span></span>
<span id="cb151-11"><a href="phylogenies.html#cb151-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Carpacoce_heteromorpha</span></span>
<span id="cb151-12"><a href="phylogenies.html#cb151-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Huttonaea_woodii</span></span>
<span id="cb151-13"><a href="phylogenies.html#cb151-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Ferulago_macrocarpa</span></span>
<span id="cb151-14"><a href="phylogenies.html#cb151-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Echinospartum_lusitanicum</span></span>
<span id="cb151-15"><a href="phylogenies.html#cb151-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Scurrula_lepidota</span></span>
<span id="cb151-16"><a href="phylogenies.html#cb151-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Astronidium_sudestense</span></span>
<span id="cb151-17"><a href="phylogenies.html#cb151-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb151-18"><a href="phylogenies.html#cb151-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Peperomia_fraseri substituted with Peperomia_kimachii </span></span>
<span id="cb151-19"><a href="phylogenies.html#cb151-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Telipogon_pulcher substituted with Telipogon_alberti </span></span>
<span id="cb151-20"><a href="phylogenies.html#cb151-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Elaeocarpus_angustifolius substituted with Elaeocarpus_miriensis </span></span>
<span id="cb151-21"><a href="phylogenies.html#cb151-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Angelica_sinensis substituted with Angelica_anomala </span></span>
<span id="cb151-22"><a href="phylogenies.html#cb151-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Senecio_pterophorus substituted with Senecio_isatideus </span></span>
<span id="cb151-23"><a href="phylogenies.html#cb151-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Macroscepis_hirsuta substituted with Macroscepis_pleistantha </span></span>
<span id="cb151-24"><a href="phylogenies.html#cb151-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Tithonia_diversifolia substituted with Tithonia_fruticosa </span></span>
<span id="cb151-25"><a href="phylogenies.html#cb151-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Spermacoce_princeae substituted with Spermacoce_latituba </span></span>
<span id="cb151-26"><a href="phylogenies.html#cb151-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Bothriocline_laxa substituted with Bothriocline_amphicoma </span></span>
<span id="cb151-27"><a href="phylogenies.html#cb151-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Siler_montanum substituted with Siler_zernyi </span></span>
<span id="cb151-28"><a href="phylogenies.html#cb151-28" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Teucrium_betchei substituted with Teucrium_rotundifolium </span></span>
<span id="cb151-29"><a href="phylogenies.html#cb151-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Calathea_pluriplicata substituted with Calathea_mediopicta </span></span>
<span id="cb151-30"><a href="phylogenies.html#cb151-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Phyllanthus_maderaspatensis substituted with Phyllanthus_roeperianus </span></span>
<span id="cb151-31"><a href="phylogenies.html#cb151-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Entada_abyssinica substituted with Entada_dolichorrhachis </span></span>
<span id="cb151-32"><a href="phylogenies.html#cb151-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Pimpinella_rhodantha substituted with Pimpinella_cypria </span></span>
<span id="cb151-33"><a href="phylogenies.html#cb151-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Baccharis_neglecta substituted with Baccharis_grisebachii </span></span>
<span id="cb151-34"><a href="phylogenies.html#cb151-34" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Mikania_micrantha substituted with Mikania_longipes </span></span>
<span id="cb151-35"><a href="phylogenies.html#cb151-35" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Raphionacme_flanaganii substituted with Raphionacme_hirsuta </span></span>
<span id="cb151-36"><a href="phylogenies.html#cb151-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Senecio_polyanthemoides substituted with Senecio_conferruminatus </span></span>
<span id="cb151-37"><a href="phylogenies.html#cb151-37" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Heracleum_austriacum substituted with Heracleum_bailletianum </span></span>
<span id="cb151-38"><a href="phylogenies.html#cb151-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Bulbophyllum_hainanense substituted with Bulbophyllum_kaniense </span></span>
<span id="cb151-39"><a href="phylogenies.html#cb151-39" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Madhuca_microphylla substituted with Madhuca_elmeri </span></span>
<span id="cb151-40"><a href="phylogenies.html#cb151-40" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Capparis_spinosa substituted with Capparis_cantoniensis </span></span>
<span id="cb151-41"><a href="phylogenies.html#cb151-41" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Albizia_lebbekoides substituted with Albizia_tulearensis </span></span>
<span id="cb151-42"><a href="phylogenies.html#cb151-42" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Cephalaria_syriaca substituted with Cephalaria_dirmilensis </span></span>
<span id="cb151-43"><a href="phylogenies.html#cb151-43" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Adesmia_exilis substituted with Adesmia_uspallatensis </span></span>
<span id="cb151-44"><a href="phylogenies.html#cb151-44" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Artemisia_biennis substituted with Artemisia_stricta </span></span>
<span id="cb151-45"><a href="phylogenies.html#cb151-45" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Osteospermum_ilicifolium substituted with Osteospermum_polycephalum </span></span>
<span id="cb151-46"><a href="phylogenies.html#cb151-46" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Atriplex_californica substituted with Atriplex_lanfrancoi </span></span>
<span id="cb151-47"><a href="phylogenies.html#cb151-47" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Oberonia_ensiformis substituted with Oberonia_anguina </span></span>
<span id="cb151-48"><a href="phylogenies.html#cb151-48" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Ceropegia_linearis_subsp._woodii substituted with Ceropegia_andamanica </span></span>
<span id="cb151-49"><a href="phylogenies.html#cb151-49" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Cousinia_severtzovii substituted with Cousinia_butkovii </span></span>
<span id="cb151-50"><a href="phylogenies.html#cb151-50" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Hoya_lanceolata substituted with Hoya_loyceandrewsiana </span></span>
<span id="cb151-51"><a href="phylogenies.html#cb151-51" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Cousinia_microcarpa substituted with Cousinia_trachylepis </span></span>
<span id="cb151-52"><a href="phylogenies.html#cb151-52" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Bossiaea_cordigera substituted with Bossiaea_oligosperma </span></span>
<span id="cb151-53"><a href="phylogenies.html#cb151-53" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Cayaponia_tubulosa substituted with Cayaponia_jenmanii </span></span>
<span id="cb151-54"><a href="phylogenies.html#cb151-54" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Pomatocalpa_kunstleri substituted with Pomatocalpa_linearipetalum </span></span>
<span id="cb151-55"><a href="phylogenies.html#cb151-55" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Endlicheria_verticillata substituted with Endlicheria_xerampela </span></span>
<span id="cb151-56"><a href="phylogenies.html#cb151-56" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Eugenia_moschata substituted with Eugenia_azurensis </span></span>
<span id="cb151-57"><a href="phylogenies.html#cb151-57" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Gastrolobium_punctatum substituted with Gastrolobium_spinosum </span></span>
<span id="cb151-58"><a href="phylogenies.html#cb151-58" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Dioscorea_mexicana substituted with Dioscorea_pennellii </span></span>
<span id="cb151-59"><a href="phylogenies.html#cb151-59" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Mitrella_kentii substituted with Mitrella_ledermannii </span></span>
<span id="cb151-60"><a href="phylogenies.html#cb151-60" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Ageratina_adenophora substituted with Ageratina_ayerscottiana </span></span>
<span id="cb151-61"><a href="phylogenies.html#cb151-61" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Astragalus_vogelii substituted with Astragalus_jolderensis </span></span>
<span id="cb151-62"><a href="phylogenies.html#cb151-62" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Eremocharis_fruticosa substituted with Eremocharis_longiramea </span></span>
<span id="cb151-63"><a href="phylogenies.html#cb151-63" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Spathiphyllum_floribundum substituted with Spathiphyllum_monachinoi </span></span>
<span id="cb151-64"><a href="phylogenies.html#cb151-64" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaffold newick tip Balanops_vieillardii substituted with Balanops_microstachya </span></span>
<span id="cb151-65"><a href="phylogenies.html#cb151-65" aria-hidden="true" tabindex="-1"></a><span class="do">## Pro tip: most tree read/write functions reset node numbers.</span></span>
<span id="cb151-66"><a href="phylogenies.html#cb151-66" aria-hidden="true" tabindex="-1"></a><span class="do">## Fortify your tree and save it as a csv file to preserve node numbering.</span></span>
<span id="cb151-67"><a href="phylogenies.html#cb151-67" aria-hidden="true" tabindex="-1"></a><span class="do">## Do not save your tree as a newick or nexus file.</span></span>
<span id="cb151-68"><a href="phylogenies.html#cb151-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-69"><a href="phylogenies.html#cb151-69" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(test_tree_big)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-207-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>One solution is to use <code>ggtree</code>, which by default doesn’t show tip labels. <code>plot</code> can do that too, but <code>ggtree</code> does a bunch of other useful things, so I recommend that:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="phylogenies.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtree</span>(test_tree_big)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-208-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Another convenient fucntion is ggplot’s <code>fortify</code>. This will convert your <code>phylo</code> object into a data frame:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="phylogenies.html#cb153-1" aria-hidden="true" tabindex="-1"></a>test_tree_big_fortified <span class="ot">&lt;-</span> <span class="fu">fortify</span>(test_tree_big)</span>
<span id="cb153-2"><a href="phylogenies.html#cb153-2" aria-hidden="true" tabindex="-1"></a>test_tree_big_fortified</span>
<span id="cb153-3"><a href="phylogenies.html#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 101 × 9</span></span>
<span id="cb153-4"><a href="phylogenies.html#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="do">##    parent  node branch.length label isTip     x     y branch</span></span>
<span id="cb153-5"><a href="phylogenies.html#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="do">##     &lt;int&gt; &lt;int&gt;         &lt;dbl&gt; &lt;chr&gt; &lt;lgl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb153-6"><a href="phylogenies.html#cb153-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  1     54     1          83.0 Wolf… TRUE   188.     1   147.</span></span>
<span id="cb153-7"><a href="phylogenies.html#cb153-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  2     54     2          83.0 Spat… TRUE   188.     2   147.</span></span>
<span id="cb153-8"><a href="phylogenies.html#cb153-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  3     55     3         138.  Dios… TRUE   188.     3   120.</span></span>
<span id="cb153-9"><a href="phylogenies.html#cb153-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  4     58     4          42.7 Bulb… TRUE   188.     5   167.</span></span>
<span id="cb153-10"><a href="phylogenies.html#cb153-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  5     58     5          42.7 Ober… TRUE   188.     6   167.</span></span>
<span id="cb153-11"><a href="phylogenies.html#cb153-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  6     59     6          32.0 Poma… TRUE   188.     7   172.</span></span>
<span id="cb153-12"><a href="phylogenies.html#cb153-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  7     59     7          32.0 Teli… TRUE   188.     8   172.</span></span>
<span id="cb153-13"><a href="phylogenies.html#cb153-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  8     56     8         135.  Cala… TRUE   188.     4   121.</span></span>
<span id="cb153-14"><a href="phylogenies.html#cb153-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  9     61     9         147.  Pepe… TRUE   188.     9   115.</span></span>
<span id="cb153-15"><a href="phylogenies.html#cb153-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 10     62    10         121.  Endl… TRUE   188.    10   128.</span></span>
<span id="cb153-16"><a href="phylogenies.html#cb153-16" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 91 more rows</span></span>
<span id="cb153-17"><a href="phylogenies.html#cb153-17" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 1 more variable: angle &lt;dbl&gt;</span></span></code></pre></div>
<p><code>ggtree</code> can still plot this dataframe, and it allows metadata to be stored in a human readable format by using mutating joins (explained below). This metadata can be plotted with standard ggplot geoms, and these dataframes can also conveniently be saved as .csv files:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="phylogenies.html#cb154-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-2"><a href="phylogenies.html#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Note that &quot;plant_species&quot; comes with the phylochemistry source.</span></span>
<span id="cb154-3"><a href="phylogenies.html#cb154-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-4"><a href="phylogenies.html#cb154-4" aria-hidden="true" tabindex="-1"></a>test_tree_big_fortified_w_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(test_tree_big_fortified, plant_species, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;label&quot;</span> <span class="ot">=</span> <span class="st">&quot;Genus_species&quot;</span>))</span>
<span id="cb154-5"><a href="phylogenies.html#cb154-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-6"><a href="phylogenies.html#cb154-6" aria-hidden="true" tabindex="-1"></a>test_tree_big_fortified_w_data</span>
<span id="cb154-7"><a href="phylogenies.html#cb154-7" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 101 × 14</span></span>
<span id="cb154-8"><a href="phylogenies.html#cb154-8" aria-hidden="true" tabindex="-1"></a><span class="do">##    parent  node branch.length label isTip     x     y branch</span></span>
<span id="cb154-9"><a href="phylogenies.html#cb154-9" aria-hidden="true" tabindex="-1"></a><span class="do">##     &lt;int&gt; &lt;int&gt;         &lt;dbl&gt; &lt;chr&gt; &lt;lgl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb154-10"><a href="phylogenies.html#cb154-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  1     54     1          83.0 Wolf… TRUE   188.     1   147.</span></span>
<span id="cb154-11"><a href="phylogenies.html#cb154-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  2     54     2          83.0 Spat… TRUE   188.     2   147.</span></span>
<span id="cb154-12"><a href="phylogenies.html#cb154-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  3     55     3         138.  Dios… TRUE   188.     3   120.</span></span>
<span id="cb154-13"><a href="phylogenies.html#cb154-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  4     58     4          42.7 Bulb… TRUE   188.     5   167.</span></span>
<span id="cb154-14"><a href="phylogenies.html#cb154-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  5     58     5          42.7 Ober… TRUE   188.     6   167.</span></span>
<span id="cb154-15"><a href="phylogenies.html#cb154-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  6     59     6          32.0 Poma… TRUE   188.     7   172.</span></span>
<span id="cb154-16"><a href="phylogenies.html#cb154-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  7     59     7          32.0 Teli… TRUE   188.     8   172.</span></span>
<span id="cb154-17"><a href="phylogenies.html#cb154-17" aria-hidden="true" tabindex="-1"></a><span class="do">##  8     56     8         135.  Cala… TRUE   188.     4   121.</span></span>
<span id="cb154-18"><a href="phylogenies.html#cb154-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  9     61     9         147.  Pepe… TRUE   188.     9   115.</span></span>
<span id="cb154-19"><a href="phylogenies.html#cb154-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 10     62    10         121.  Endl… TRUE   188.    10   128.</span></span>
<span id="cb154-20"><a href="phylogenies.html#cb154-20" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 91 more rows</span></span>
<span id="cb154-21"><a href="phylogenies.html#cb154-21" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 6 more variables: angle &lt;dbl&gt;, Phylum &lt;chr&gt;,</span></span>
<span id="cb154-22"><a href="phylogenies.html#cb154-22" aria-hidden="true" tabindex="-1"></a><span class="do">## #   Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;, species &lt;chr&gt;</span></span>
<span id="cb154-23"><a href="phylogenies.html#cb154-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-24"><a href="phylogenies.html#cb154-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtree</span>(test_tree_big_fortified_w_data) <span class="sc">+</span> </span>
<span id="cb154-25"><a href="phylogenies.html#cb154-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb154-26"><a href="phylogenies.html#cb154-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">filter</span>(test_tree_big_fortified_w_data, isTip <span class="sc">==</span> <span class="cn">TRUE</span>),</span>
<span id="cb154-27"><a href="phylogenies.html#cb154-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> Order), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb154-28"><a href="phylogenies.html#cb154-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb154-29"><a href="phylogenies.html#cb154-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">filter</span>(test_tree_big_fortified_w_data, isTip <span class="sc">==</span> <span class="cn">TRUE</span>),</span>
<span id="cb154-30"><a href="phylogenies.html#cb154-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> y), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb154-31"><a href="phylogenies.html#cb154-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tiplab</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">offset =</span> <span class="dv">10</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb154-32"><a href="phylogenies.html#cb154-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb154-33"><a href="phylogenies.html#cb154-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> discrete_palette) <span class="sc">+</span></span>
<span id="cb154-34"><a href="phylogenies.html#cb154-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">280</span>)) <span class="sc">+</span></span>
<span id="cb154-35"><a href="phylogenies.html#cb154-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb154-36"><a href="phylogenies.html#cb154-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.75</span>)</span>
<span id="cb154-37"><a href="phylogenies.html#cb154-37" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-210-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="collapsetree" class="section level2" number="1.16">
<h2><span class="header-section-number">1.16</span> collapseTree</h2>
<p>Sometimes we want to view a tree at a higher level of taxonomical organization, or some other higher level. This can be done easily using the <code>collapseTree</code> function. It takes two arguments: an un-fortified tree (<code>tree</code>), and a two-column data frame (<code>associations</code>). In the first column of the data frame are all the tip labels of the tree, and in the second column are the higher level of organization to which each tip belongs. The function will prune the tree so that only one member of the higher level of organization is included in the output. For example, let’s look at the tree from the previous section at the family level:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="phylogenies.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">collapseTree</span>(</span>
<span id="cb155-2"><a href="phylogenies.html#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">tree =</span> test_tree_big,</span>
<span id="cb155-3"><a href="phylogenies.html#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">associations =</span> <span class="fu">data.frame</span>(</span>
<span id="cb155-4"><a href="phylogenies.html#cb155-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">tip.label =</span> test_tree_big<span class="sc">$</span>tip.label,</span>
<span id="cb155-5"><a href="phylogenies.html#cb155-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> plant_species<span class="sc">$</span>Family[<span class="fu">match</span>(test_tree_big<span class="sc">$</span>tip.label, plant_species<span class="sc">$</span>Genus_species)]</span>
<span id="cb155-6"><a href="phylogenies.html#cb155-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb155-7"><a href="phylogenies.html#cb155-7" aria-hidden="true" tabindex="-1"></a>) <span class="ot">-&gt;</span> test_tree_big_families</span>
<span id="cb155-8"><a href="phylogenies.html#cb155-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-9"><a href="phylogenies.html#cb155-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtree</span>(test_tree_big_families) <span class="sc">+</span> <span class="fu">geom_tiplab</span>() <span class="sc">+</span> <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">300</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-211-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <h2>Note: Second Edition is under construction 🏗</h2>
    <p>Now is a great time to provide feedback</p>
        <ul class="list-unstyled">
          <li><a href="https://forms.gle/SZmB2Ct2exE2dBwv9">Provide feedback (5 min)</a></li>
          <!-- <li><a href="https://geocompr.robinlovelace.net/#reproducibility">Install updated packages</a></li> -->
          <!-- <li><a href="https://github.com/Robinlovelace/geocompr/issues">Open an issue <i class="fas fa-question"></i></a></li> -->
          <!-- <li><a href="https://discord.gg/Te3gWeDwmf">Chat on Discord <i class="fab fa-discord"></i></a></li> -->
        </ul>
        <hr>
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Integrated Bioanalytics</strong>" was written by Lucas Busta and members of the Busta lab. It was last built on 2023-06-16.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


</body>

</html>
