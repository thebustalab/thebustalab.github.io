<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>k-means | Integrated Bioanalytics</title>
<meta name="author" content="Lucas Busta and members of the Busta lab">
<meta name="description" content="‚ÄúDo my samples fall into definable clusters?‚Äù  1.12 theory One of the questions we‚Äôve been asking is ‚Äúwhich of my samples are most closely related?‚Äù. We‚Äôve been answering that question using...">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="k-means | Integrated Bioanalytics">
<meta property="og:type" content="book">
<meta property="og:description" content="‚ÄúDo my samples fall into definable clusters?‚Äù  1.12 theory One of the questions we‚Äôve been asking is ‚Äúwhich of my samples are most closely related?‚Äù. We‚Äôve been answering that question using...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="k-means | Integrated Bioanalytics">
<meta name="twitter:description" content="‚ÄúDo my samples fall into definable clusters?‚Äù  1.12 theory One of the questions we‚Äôve been asking is ‚Äúwhich of my samples are most closely related?‚Äù. We‚Äôve been answering that question using...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/_Lato-0.4.1/font.css" rel="stylesheet">
<link href="libs/_Roboto%20Mono-0.4.1/font.css" rel="stylesheet">
<link href="libs/_Montserrat-0.4.1/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.3.1.9000/transition.js"></script><script src="libs/bs3compat-0.3.1.9000/tabs.js"></script><script src="libs/bs3compat-0.3.1.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">
<script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-99618359-1', 'auto');
      ga('send', 'pageview');

    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h2>
        <a href="index.html" title="">Integrated Bioanalytics</a>
      </h2>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">welcome</a></li>
<li class="book-part">data analysis in r</li>
<li><a class="" href="overview.html">overview</a></li>
<li><a class="" href="installation.html">installation</a></li>
<li><a class="" href="data-visualization.html">data visualization</a></li>
<li><a class="" href="data-wranging.html">data wranging</a></li>
<li><a class="" href="clustering.html">clustering</a></li>
<li><a class="" href="pca.html">pca</a></li>
<li><a class="active" href="k-means.html">k-means</a></li>
<li><a class="" href="models.html">models</a></li>
<li><a class="" href="comparing-means.html">comparing means</a></li>
<li class="book-part">mass spectrometry data</li>
<li><a class="" href="mass-spectrometric-analysis.html">mass spectrometric analysis</a></li>
<li class="book-part">dna and rna sequence data</li>
<li><a class="" href="data-acquisition.html">data acquisition</a></li>
<li><a class="" href="data-transfer.html">data transfer</a></li>
<li><a class="" href="sequence-assessment.html">sequence assessment</a></li>
<li><a class="" href="illumina-read-assessment.html">illumina read assessment</a></li>
<li class="book-part">transcriptome analysis</li>
<li><a class="" href="transcriptomic-analyses.html">transcriptomic analyses</a></li>
<li class="book-part">genomic analysis</li>
<li><a class="" href="setup.html">setup</a></li>
<li><a class="" href="genome-assembly.html">genome assembly</a></li>
<li><a class="" href="comparative-genomics.html">comparative genomics</a></li>
<li class="book-part">evolutionary analysis</li>
<li><a class="" href="evolutionary-analyses.html">evolutionary analyses</a></li>
<li class="book-part">scientific writing</li>
<li><a class="" href="overview-1.html">overview</a></li>
<li><a class="" href="a-mini-manuscript.html">a mini manuscript</a></li>
<li><a class="" href="figures-captions.html"><span class="header-section-number">2</span> figures &amp; captions</a></li>
<li><a class="" href="results-and-discussion.html"><span class="header-section-number">3</span> results and discussion</a></li>
<li><a class="" href="conclusion-and-introduction.html">conclusion and introduction</a></li>
<li><a class="" href="abstract-and-title.html">abstract and title</a></li>
<li><a class="" href="proposals.html">proposals</a></li>
<li class="book-part">image analysis</li>
<li><a class="" href="section-3.html"></a></li>
<li><a class="" href="image-analysis.html">IMAGE ANALYSIS</a></li>
<li><a class="" href="image-color-analysis.html">image color analysis</a></li>
<li><a class="" href="images-of-mass-spectra.html"><span class="header-section-number">4</span> images of mass spectra</a></li>
<li class="book-part">appendix</li>
<li><a class="" href="links.html"><span class="header-section-number">5</span> links</a></li>
<li><a class="" href="r-faq.html"><span class="header-section-number">6</span> r faq</a></li>
<li><a class="" href="templates.html"><span class="header-section-number">7</span> templates</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/thebustalab/thebustalab.github.io/tree/master/integrated_bioanalytics">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="k-means" class="section level1 unnumbered">
<h1>k-means<a class="anchor" aria-label="anchor" href="#k-means"><i class="fas fa-link"></i></a>
</h1>
<p>‚ÄúDo my samples fall into definable clusters?‚Äù</p>
<div id="theory-1" class="section level2" number="1.12">
<h2>
<span class="header-section-number">1.12</span> theory<a class="anchor" aria-label="anchor" href="#theory-1"><i class="fas fa-link"></i></a>
</h2>
<p>One of the questions we‚Äôve been asking is ‚Äúwhich of my samples are most closely related?‚Äù. We‚Äôve been answering that question using clustering. However, now that we know how to run principal components analyses, we can use another approach. This alternative approach is called k-means, and can help us decide how to assign our data into clusters. It is generally desirable to have a small number of clusters, however, this must be balanced by not having the variance within each cluster be too big. To strike this balance point, the elbow method is used. For it, we must first determine the maximum within-group variance at each possible number of clusters. An illustration of this is shown in <strong>A</strong> below:</p>
<div class="inline-figure"><img src="https://thebustalab.github.io/integrated_bioanalytics/images/kmeans.png" width="100%" style="display: block; margin: auto;"></div>
<p>One we know within-group variances, we find the ‚Äúelbow‚Äù point - the point with minimum angle theta - thus picking the outcome with a good balance of cluster number and within-cluster variance (illustrated above in <strong>B</strong> and <strong>C</strong>.)</p>
<p>Let‚Äôs try k-means using <code>runMatrixAnalysis</code>. We can use it in conjunction with <code>analysis = "pca"</code> or <code>analysis = "hclust"</code>. Let‚Äôs do PCA first. To include k-means, we can just set <code>kmeans = "auto"</code>. It‚Äôs important to note that kmeans cannot handle NAs. We must set something for the <code>na_replacement</code> argument. One solution is to ignore variables that have NAs for some values, which can be done by setting <code>na_replacement = "drop"</code>.</p>
<p>With <code>kmeans = "auto"</code> and <code>na_replacement = "drop"</code>, we can now run our analyssis. The output now has an additional column called <code>kmeans_cluster</code>, which indicates what cluster each sample is in:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">solvents_pca_kmeans</span> <span class="op">&lt;-</span> <span class="fu">runMatrixAnalysis</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">solvents</span>,
  analysis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pca"</span><span class="op">)</span>,
  column_w_names_of_multiple_analytes <span class="op">=</span> <span class="cn">NULL</span>,
  column_w_values_for_multiple_analytes <span class="op">=</span> <span class="cn">NULL</span>,
  columns_w_values_for_single_analyte <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">solvents</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">9</span>, <span class="fl">11</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">]</span>,
  columns_w_additional_analyte_info <span class="op">=</span> <span class="cn">NULL</span>,
  columns_w_sample_ID_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"solvent"</span>, <span class="st">"formula"</span>, <span class="st">"miscible_with_water"</span>, <span class="st">"CAS_number"</span>, <span class="st">"category"</span><span class="op">)</span>,
  transpose <span class="op">=</span> <span class="cn">FALSE</span>,
  kmeans <span class="op">=</span> <span class="st">"auto"</span>,
  na_replacement <span class="op">=</span> <span class="st">"drop"</span>
<span class="op">)</span>
<span class="co">## Dropping any variables in your dataset that have NA as a value.</span>
<span class="co">## Variables dropped:</span>
<span class="co">## solubility_in_water vapor_pressure</span>

<span class="va">solvents_pca_kmeans</span>
<span class="co">## # A tibble: 32 √ó 15</span>
<span class="co">##    sample_unique_ID         solvent formula miscible_with_w‚Ä¶</span>
<span class="co">##    &lt;chr&gt;                    &lt;chr&gt;   &lt;chr&gt;   &lt;lgl&gt;           </span>
<span class="co">##  1 acetic_acid_C2H4O2_TRUE‚Ä¶ acetic‚Ä¶ C2H4O2  TRUE            </span>
<span class="co">##  2 acetone_C3H6O_TRUE_67-6‚Ä¶ acetone C3H6O   TRUE            </span>
<span class="co">##  3 acetonitrile_C2H3N_TRUE‚Ä¶ aceton‚Ä¶ C2H3N   TRUE            </span>
<span class="co">##  4 benzene_C6H6_FALSE_71-4‚Ä¶ benzene C6H6    FALSE           </span>
<span class="co">##  5 benzonitrile_C7H5N_FALS‚Ä¶ benzon‚Ä¶ C7H5N   FALSE           </span>
<span class="co">##  6 1-butanol_C4H10O_FALSE_‚Ä¶ 1-buta‚Ä¶ C4H10O  FALSE           </span>
<span class="co">##  7 2-butanone_C4H8O_FALSE_‚Ä¶ 2-buta‚Ä¶ C4H8O   FALSE           </span>
<span class="co">##  8 carbon_disulfide_CS2_FA‚Ä¶ carbon‚Ä¶ CS2     FALSE           </span>
<span class="co">##  9 carbon_tetrachloride_CC‚Ä¶ carbon‚Ä¶ CCl4    FALSE           </span>
<span class="co">## 10 chlorobenzene_C6H5Cl_FA‚Ä¶ chloro‚Ä¶ C6H5Cl  FALSE           </span>
<span class="co">## # ‚Ä¶ with 22 more rows, and 11 more variables:</span>
<span class="co">## #   CAS_number &lt;chr&gt;, category &lt;chr&gt;, Dim.1 &lt;dbl&gt;,</span>
<span class="co">## #   Dim.2 &lt;dbl&gt;, kmeans_cluster &lt;chr&gt;, boiling_point &lt;dbl&gt;,</span>
<span class="co">## #   melting_point &lt;dbl&gt;, density &lt;dbl&gt;,</span>
<span class="co">## #   relative_polarity &lt;dbl&gt;, formula_weight &lt;dbl&gt;,</span>
<span class="co">## #   refractive_index &lt;dbl&gt;</span></code></pre></div>
<p>We can plot the results and color them according to the group that kmeans suggested:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">solvents_pca_kmeans</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Dim.1</span>, y <span class="op">=</span> <span class="va">Dim.2</span>, fill <span class="op">=</span> <span class="va">kmeans_cluster</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="index_files/figure-html/unnamed-chunk-105-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>Hmmm, it looks like the elbow algorithm is suggesting lots of clusters. Why is this? Let‚Äôs look at the elbow plot itself. For this, we can just set <code>kmeans = "elbow"</code>:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">solvents_pca_kmeans_elbow</span> <span class="op">&lt;-</span> <span class="fu">runMatrixAnalysis</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">solvents</span>,
  analysis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pca"</span><span class="op">)</span>,
  column_w_names_of_multiple_analytes <span class="op">=</span> <span class="cn">NULL</span>,
  column_w_values_for_multiple_analytes <span class="op">=</span> <span class="cn">NULL</span>,
  columns_w_values_for_single_analyte <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">solvents</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">9</span>, <span class="fl">11</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">]</span>,
  columns_w_additional_analyte_info <span class="op">=</span> <span class="cn">NULL</span>,
  columns_w_sample_ID_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"solvent"</span>, <span class="st">"formula"</span>, <span class="st">"miscible_with_water"</span>, <span class="st">"CAS_number"</span>, <span class="st">"category"</span><span class="op">)</span>,
  transpose <span class="op">=</span> <span class="cn">FALSE</span>,
  kmeans <span class="op">=</span> <span class="st">"elbow"</span>,
  na_replacement <span class="op">=</span> <span class="st">"drop"</span>
<span class="op">)</span>
<span class="co">## Dropping any variables in your dataset that have NA as a value.</span>
<span class="co">## Variables dropped:</span>
<span class="co">## solubility_in_water vapor_pressure</span>

<span class="va">solvents_pca_kmeans_elbow</span>
<span class="co">## # A tibble: 31 √ó 2</span>
<span class="co">##    cluster_number variance_within_cluster</span>
<span class="co">##             &lt;dbl&gt;                   &lt;dbl&gt;</span>
<span class="co">##  1              1                   186. </span>
<span class="co">##  2              2                   128. </span>
<span class="co">##  3              3                    99.1</span>
<span class="co">##  4              4                    73.6</span>
<span class="co">##  5              5                    62.5</span>
<span class="co">##  6              6                    51.8</span>
<span class="co">##  7              7                    42.8</span>
<span class="co">##  8              8                    36.4</span>
<span class="co">##  9              9                    31.7</span>
<span class="co">## 10             10                    27.8</span>
<span class="co">## # ‚Ä¶ with 21 more rows</span></code></pre></div>
<p>This gives us the maximum variance within a cluster for each number of clusters. Let‚Äôs plot that:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  <span class="va">solvents_pca_kmeans_elbow</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cluster_number</span>, y <span class="op">=</span> <span class="va">variance_within_cluster</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="index_files/figure-html/unnamed-chunk-107-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>Hmm, it looks like there aren‚Äôt any strong elbows in this plot - probably the reason that the elbow method chooses such a high number of clusters. Suppose we want to manually set the number of clusters? We can set <code>kmeans = 3</code> if we want three clusters in the output. Below, let‚Äôs do just that. Let‚Äôs also plot the results and use <code>geom_mark_ellipse</code>.</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">runMatrixAnalysis</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">solvents</span>,
  analysis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pca"</span><span class="op">)</span>,
  column_w_names_of_multiple_analytes <span class="op">=</span> <span class="cn">NULL</span>,
  column_w_values_for_multiple_analytes <span class="op">=</span> <span class="cn">NULL</span>,
  columns_w_values_for_single_analyte <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">solvents</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">9</span>, <span class="fl">11</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">]</span>,
  columns_w_additional_analyte_info <span class="op">=</span> <span class="cn">NULL</span>,
  columns_w_sample_ID_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"solvent"</span>, <span class="st">"formula"</span>, <span class="st">"miscible_with_water"</span>, <span class="st">"CAS_number"</span>, <span class="st">"category"</span><span class="op">)</span>,
  transpose <span class="op">=</span> <span class="cn">FALSE</span>,
  kmeans <span class="op">=</span> <span class="fl">3</span>,
  na_replacement <span class="op">=</span> <span class="st">"drop"</span>
<span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Dim.1</span>, y <span class="op">=</span> <span class="va">Dim.2</span>, fill <span class="op">=</span> <span class="va">kmeans_cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_mark_ellipse</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">kmeans_cluster</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="co">## Dropping any variables in your dataset that have NA as a value.</span>
<span class="co">## Variables dropped:</span>
<span class="co">## solubility_in_water vapor_pressure</span></code></pre></div>
<div class="inline-figure"><img src="index_files/figure-html/unnamed-chunk-108-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>Cool!</p>
<p>One more important point: when using kmeans, the output of runMatrixAnalysis (specifically the kmeans_cluster column) can be used to create groupings for summary statistics. For example, suppose we want two groups of solvents and we want to calculate the mean and standard deviation in boiling points for each of those groups:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">solvents_clustered</span> <span class="op">&lt;-</span> <span class="fu">runMatrixAnalysis</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">solvents</span>,
  analysis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pca"</span><span class="op">)</span>,
  column_w_names_of_multiple_analytes <span class="op">=</span> <span class="cn">NULL</span>,
  column_w_values_for_multiple_analytes <span class="op">=</span> <span class="cn">NULL</span>,
  columns_w_values_for_single_analyte <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">solvents</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">9</span>, <span class="fl">11</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">]</span>,
  columns_w_additional_analyte_info <span class="op">=</span> <span class="cn">NULL</span>,
  columns_w_sample_ID_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"solvent"</span>, <span class="st">"formula"</span>, <span class="st">"miscible_with_water"</span>, <span class="st">"CAS_number"</span>, <span class="st">"category"</span><span class="op">)</span>,
  transpose <span class="op">=</span> <span class="cn">FALSE</span>,
  kmeans <span class="op">=</span> <span class="fl">2</span>,
  na_replacement <span class="op">=</span> <span class="st">"drop"</span>
<span class="op">)</span>
<span class="co">## Dropping any variables in your dataset that have NA as a value.</span>
<span class="co">## Variables dropped:</span>
<span class="co">## solubility_in_water vapor_pressure</span>

<span class="va">solvents_clustered_summary</span> <span class="op">&lt;-</span> <span class="va">solvents_clustered</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">kmeans_cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">summarize</span><span class="op">(</span>mean_bp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">boiling_point</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_col</span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">solvents_clustered_summary</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">kmeans_cluster</span>, y <span class="op">=</span> <span class="va">mean_bp</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"white"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">solvents_clustered</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">kmeans_cluster</span>, y <span class="op">=</span> <span class="va">boiling_point</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="index_files/figure-html/unnamed-chunk-109-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>Very good! Since we can use the outputs of our k-means analyses to run and visualize summary statistics, it‚Äôs possible that we‚Äôll want to see the cluster plot (dendrogram or pca plot) alongside the summary stats plot. For this we can use the <code>plot_grid</code> function from the <code>cowplot</code> package. Let‚Äôs check it out:</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">solvents_clustered</span> <span class="op">&lt;-</span> <span class="fu">runMatrixAnalysis</span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">solvents</span>,
  analysis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pca"</span><span class="op">)</span>,
  column_w_names_of_multiple_analytes <span class="op">=</span> <span class="cn">NULL</span>,
  column_w_values_for_multiple_analytes <span class="op">=</span> <span class="cn">NULL</span>,
  columns_w_values_for_single_analyte <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">solvents</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">9</span>, <span class="fl">11</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">]</span>,
  columns_w_additional_analyte_info <span class="op">=</span> <span class="cn">NULL</span>,
  columns_w_sample_ID_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"solvent"</span>, <span class="st">"formula"</span>, <span class="st">"miscible_with_water"</span>, <span class="st">"CAS_number"</span>, <span class="st">"category"</span><span class="op">)</span>,
  transpose <span class="op">=</span> <span class="cn">FALSE</span>,
  kmeans <span class="op">=</span> <span class="fl">4</span>,
  na_replacement <span class="op">=</span> <span class="st">"drop"</span>
<span class="op">)</span>
<span class="co">## Dropping any variables in your dataset that have NA as a value.</span>
<span class="co">## Variables dropped:</span>
<span class="co">## solubility_in_water vapor_pressure</span>

<span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"maroon"</span>, <span class="st">"gold"</span>, <span class="st">"grey"</span>, <span class="st">"white"</span><span class="op">)</span>

<span class="va">pca_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span> data <span class="op">=</span> <span class="va">solvents_clustered</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Dim.1</span>, y <span class="op">=</span> <span class="va">Dim.2</span>, fill <span class="op">=</span> <span class="va">kmeans_cluster</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_mark_ellipse</span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">kmeans_cluster</span><span class="op">)</span>, 
    alpha <span class="op">=</span> <span class="fl">0.5</span>, label.lineheight <span class="op">=</span> <span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">guides</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"PCA dimension 1"</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8</span>,<span class="fl">8</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"PCA dimension 2"</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7</span>,<span class="fl">7</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">colors</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8</span>,<span class="fl">8</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span>

<span class="va">solvents_clustered_summary</span> <span class="op">&lt;-</span> <span class="va">solvents_clustered</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">kmeans_cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">summarize</span><span class="op">(</span>mean_bp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">boiling_point</span><span class="op">)</span><span class="op">)</span>

<span class="va">bar_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_violin</span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">solvents_clustered</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">kmeans_cluster</span>, y <span class="op">=</span> <span class="va">boiling_point</span>, fill <span class="op">=</span> <span class="va">kmeans_cluster</span><span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.6</span>, width <span class="op">=</span> <span class="fl">0.5</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_crossbar</span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">solvents_clustered_summary</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">kmeans_cluster</span>, y <span class="op">=</span> <span class="va">mean_bp</span>, ymin <span class="op">=</span> <span class="va">mean_bp</span>, ymax <span class="op">=</span> <span class="va">mean_bp</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"black"</span>, width <span class="op">=</span> <span class="fl">0.5</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">solvents_clustered</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">kmeans_cluster</span>, y <span class="op">=</span> <span class="va">boiling_point</span><span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.6</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Boiling point"</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">250</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_discrete</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">colors</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">guides</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span>

<span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">pca_plot</span>, <span class="va">bar_plot</span>, align <span class="op">=</span> <span class="st">"h"</span>, axis <span class="op">=</span> <span class="st">"b"</span>, labels <span class="op">=</span> <span class="st">"AUTO"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="index_files/figure-html/unnamed-chunk-110-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>Now we are really rockin!!</p>
</div>
<div id="exercises-3" class="section level2" number="1.13">
<h2>
<span class="header-section-number">1.13</span> exercises<a class="anchor" aria-label="anchor" href="#exercises-3"><i class="fas fa-link"></i></a>
</h2>
<p>Use the wine grapes dataset (it‚Äôs stored as <code>wine_grape_data</code> after you run the <code>source(...)</code> command).</p>
<div id="question-1" class="section level3" number="1.13.1">
<h3>
<span class="header-section-number">1.13.1</span> Question 1<a class="anchor" aria-label="anchor" href="#question-1"><i class="fas fa-link"></i></a>
</h3>
<p>Run a principal components analysis on the dataset. Use <code>na_replacement = "drop"</code> (so that variables with NA values are not included in the analysis) and generate clusters automatically using kmeans by setting <code>kmeans = "auto"</code>. Make scatter plot of the results. How many clusters does kmeans recommend?</p>
</div>
<div id="question-2" class="section level3" number="1.13.2">
<h3>
<span class="header-section-number">1.13.2</span> Question 2<a class="anchor" aria-label="anchor" href="#question-2"><i class="fas fa-link"></i></a>
</h3>
<p>Modify your code from Question 1 so that only two clusters are generated. Plot the results. Use <code>geom_mark_ellipse</code> to highlight each cluster in your plot (note that the <code>fill</code> aesthetic is required to mark groups). Which varieties are put into each of the two clusters?</p>
</div>
<div id="question-3" class="section level3" number="1.13.3">
<h3>
<span class="header-section-number">1.13.3</span> Question 3<a class="anchor" aria-label="anchor" href="#question-3"><i class="fas fa-link"></i></a>
</h3>
<p>Use an ordination plot to determine what chemicals makes Chardonnay so different from the other varieties. To what class of compounds do these chemical belong?</p>
</div>
<div id="question-4" class="section level3" number="1.13.4">
<h3>
<span class="header-section-number">1.13.4</span> Question 4<a class="anchor" aria-label="anchor" href="#question-4"><i class="fas fa-link"></i></a>
</h3>
<p>Modify your code from Question 2 so that five clusters are generated. Plot the results. Use <code>geom_mark_ellipse</code> to highlight each cluster in your plot (note that the <code>fill</code> aesthetic is required to mark groups). Based on this plot, which grape variety undergoes the least amount of change, chemically speaking, between dry and well-watered conditions?</p>
</div>
<div id="question-5" class="section level3" number="1.13.5">
<h3>
<span class="header-section-number">1.13.5</span> Question 5<a class="anchor" aria-label="anchor" href="#question-5"><i class="fas fa-link"></i></a>
</h3>
<p>Run a heirarchical clustering analysis on the wine grapes data set, using kmeans to create five groups, and also continue using <code>na_replacement = "drop"</code>. Plot the results. Which grape variety undergoes the most change in terms of its chemistry between well-watered and dry conditions? (hint: remember that the x-axis shows the distances between nodes and tips, the y-axis is meaningless). Compare the method you used to compare sample shifts in question 4 (i.e.¬†pca+kmeans) versus the method you used in this question (i.e.¬†hclust+kmeans). Which do you is better? Would this change depending on the circumstances?</p>
</div>
<div id="question-6" class="section level3" number="1.13.6">
<h3>
<span class="header-section-number">1.13.6</span> Question 6<a class="anchor" aria-label="anchor" href="#question-6"><i class="fas fa-link"></i></a>
</h3>
<p>Google ‚ÄúQuercetin‚Äù. What kind of compound is it? Use the clusters created by the heirarchical clustering analysis in question 5 as groups for which to calculate summary statistics. Calculate the mean and standard deviation of the concentration of Quercetin in each group. Plot the result using <code>geom_pointrange</code> and adjust axis font sizes so that they are in good proportion with the size of the plot. Also specify a theme (for example, <code>theme_classic()</code>).</p>
<p>Does one cluster have a large amount of variation in Quercetin abundance? Why do you think this might be?</p>
</div>
<div id="question-7" class="section level3" number="1.13.7">
<h3>
<span class="header-section-number">1.13.7</span> Question 7<a class="anchor" aria-label="anchor" href="#question-7"><i class="fas fa-link"></i></a>
</h3>
<p>Use <code><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">cowplot::plot_grid</a></code> to display your plots from questions 4 and 5 next to each other.</p>
</div>
<div id="challenge-optional" class="section level3" number="1.13.8">
<h3>
<span class="header-section-number">1.13.8</span> Challenge (optional)<a class="anchor" aria-label="anchor" href="#challenge-optional"><i class="fas fa-link"></i></a>
</h3>
<p>Use cowplot to display your plots from questions 4, 5, and 6 alongside each other. <strong>Make your combined plot as attractive as possible!</strong> Use each of the following:</p>
<p><code>align = TRUE</code> inside <code><a href="https://rdrr.io/pkg/ggtree/man/geom_tiplab.html">geom_tiplab()</a></code></p>
<p><code>nrow = 1</code> inside <code>plot_grid()</code></p>
<p><code>rel_widths = &lt;your_choice&gt;</code> inside <code>plot_grid()</code></p>
<p><code>name = &lt;your_choice&gt;</code> inside <code>scale_*_*</code></p>
<p><code>label = kmeans_cluster</code> inside <code>geom_mark_ellipse()</code></p>
<p><code>breaks = &lt;your_choice&gt;</code> inside <code>scale_x_continuous()</code> or <code>scale_y_continuous()</code> (as an example, <code>breaks = seq(0,10,1)</code>)</p>
<p>Also, consider using:</p>
<p><code>guides(fill = "none", color = "none")</code></p>
<p>Install the RColorBrewer package, and use one of its color schemes. As an example with the color scheme <code>Set1</code>:</p>
<p><code>scale_fill_brewer(palette = "Set1", na.value = "grey")</code></p>
<p><code>scale_color_brewer(palette = "Set1", na.value = "grey")</code></p>
<p>Save your plot as a png using <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>.</p>
<p>Maybe something like this:</p>
<div class="inline-figure"><img src="https://thebustalab.github.io/integrated_bioanalytics/images/Ex6Challenge.png" width="100%" style="display: block; margin: auto;"></div>
<!-- end -->
<!-- start models -->
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="pca.html">pca</a></div>
<div class="next"><a href="models.html">models</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <h2>Note: Second Edition is under construction üèó</h2>
    <p>Now is a great time to provide feedback</p>
        <ul class="list-unstyled">
<li><a href="https://forms.gle/SZmB2Ct2exE2dBwv9">Provide feedback (5 min)</a></li>
          <!-- <li><a href="https://geocompr.robinlovelace.net/#reproducibility">Install updated packages</a></li> -->
          <!-- <li><a href="https://github.com/Robinlovelace/geocompr/issues">Open an issue <i class="fas fa-question"></i></a></li> -->
          <!-- <li><a href="https://discord.gg/Te3gWeDwmf">Chat on Discord <i class="fab fa-discord"></i></a></li> -->
        </ul>
<hr>
<nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#k-means">k-means</a></li>
<li><a class="nav-link" href="#theory-1"><span class="header-section-number">1.12</span> theory</a></li>
<li>
<a class="nav-link" href="#exercises-3"><span class="header-section-number">1.13</span> exercises</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#question-1"><span class="header-section-number">1.13.1</span> Question 1</a></li>
<li><a class="nav-link" href="#question-2"><span class="header-section-number">1.13.2</span> Question 2</a></li>
<li><a class="nav-link" href="#question-3"><span class="header-section-number">1.13.3</span> Question 3</a></li>
<li><a class="nav-link" href="#question-4"><span class="header-section-number">1.13.4</span> Question 4</a></li>
<li><a class="nav-link" href="#question-5"><span class="header-section-number">1.13.5</span> Question 5</a></li>
<li><a class="nav-link" href="#question-6"><span class="header-section-number">1.13.6</span> Question 6</a></li>
<li><a class="nav-link" href="#question-7"><span class="header-section-number">1.13.7</span> Question 7</a></li>
<li><a class="nav-link" href="#challenge-optional"><span class="header-section-number">1.13.8</span> Challenge (optional)</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/thebustalab/thebustalab.github.io/tree/master/integrated_bioanalytics/blob/main/index.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/thebustalab/thebustalab.github.io/tree/master/integrated_bioanalytics/edit/main/index.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Integrated Bioanalytics</strong>" was written by Lucas Busta and members of the Busta lab. It was last built on 2022-07-29.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
