<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>figures &amp; captions | Integrated Bioanalytics</title>

    <meta name="author" content="Lucas Busta and members of the Busta lab" />
  
   <meta name="description" content="figures &amp; captions | Integrated Bioanalytics is a book describing how to perform chemical, phylogenetic, and genomic analyses." />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="figures &amp; captions | Integrated Bioanalytics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="figures &amp; captions | Integrated Bioanalytics is a book describing how to perform chemical, phylogenetic, and genomic analyses." />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="figures &amp; captions | Integrated Bioanalytics" />
  
  <meta name="twitter:description" content="figures &amp; captions | Integrated Bioanalytics is a book describing how to perform chemical, phylogenetic, and genomic analyses." />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <link href="libs/Lato-0.4.6/font.css" rel="stylesheet" />
    <link href="libs/Roboto_Mono-0.4.6/font.css" rel="stylesheet" />
    <link href="libs/Montserrat-0.4.6/font.css" rel="stylesheet" />
    <script src="libs/bs3compat-0.4.2/transition.js"></script>
    <script src="libs/bs3compat-0.4.2/tabs.js"></script>
    <script src="libs/bs3compat-0.4.2/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-99618359-1', 'auto');
      ga('send', 'pageview');

    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
    <link rel="stylesheet" href="style/style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h2>
        <a href="index.html" title="">Integrated Bioanalytics</a>
      </h2>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="figures-captions" class="section level1 unnumbered">
<h1>figures &amp; captions</h1>
<p>A high quality figure is one in which, for example, axes tick labels do not overlap but also fill the space available to them, colors are used, raw data is plotted (if possible), axes labels are customized, an appropriate theme is chosen, and geoms are chosen carefully. The plots should be visually attractive and professional.</p>
<p><img src="https://thebustalab.github.io/integrated_bioanalytics/images/plot_quality.jpg" width="100%" style="display: block; margin: auto;" /></p>
<div id="zoomed-figures" class="section level2 unnumbered">
<h2>zoomed figures</h2>
<p>Zoom in on certain plot regions</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="figures-captions.html#cb156-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb156-2"><a href="figures-captions.html#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span>
<span id="cb156-3"><a href="figures-captions.html#cb156-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-4"><a href="figures-captions.html#cb156-4" aria-hidden="true" tabindex="-1"></a>data.tb <span class="ot">&lt;-</span> </span>
<span id="cb156-5"><a href="figures-captions.html#cb156-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">44</span>, </span>
<span id="cb156-6"><a href="figures-captions.html#cb156-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot =</span> <span class="fu">list</span>(p <span class="sc">+</span> </span>
<span id="cb156-7"><a href="figures-captions.html#cb156-7" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">4.9</span>, <span class="fl">6.2</span>), </span>
<span id="cb156-8"><a href="figures-captions.html#cb156-8" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb156-9"><a href="figures-captions.html#cb156-9" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb156-10"><a href="figures-captions.html#cb156-10" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">theme_bw</span>(<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb156-11"><a href="figures-captions.html#cb156-11" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">scale_colour_discrete</span>(<span class="at">guide =</span> <span class="st">&quot;none&quot;</span>)))</span>
<span id="cb156-12"><a href="figures-captions.html#cb156-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-13"><a href="figures-captions.html#cb156-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb156-14"><a href="figures-captions.html#cb156-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_plot</span>(<span class="at">data =</span> data.tb, <span class="fu">aes</span>(x, y, <span class="at">label =</span> plot)) <span class="sc">+</span></span>
<span id="cb156-15"><a href="figures-captions.html#cb156-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;rect&quot;</span>, </span>
<span id="cb156-16"><a href="figures-captions.html#cb156-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmin =</span> <span class="fl">4.9</span>, <span class="at">xmax =</span> <span class="fl">6.2</span>, <span class="at">ymin =</span> <span class="dv">13</span>, <span class="at">ymax =</span> <span class="dv">21</span>,</span>
<span id="cb156-17"><a href="figures-captions.html#cb156-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb156-18"><a href="figures-captions.html#cb156-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-216-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="inset-figures" class="section level2 unnumbered">
<h2>inset figures</h2>
<div id="plot-insets" class="section level3 unnumbered">
<h3>plot insets</h3>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="figures-captions.html#cb157-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), hwy, <span class="at">fill =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb157-2"><a href="figures-captions.html#cb157-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">&quot;col&quot;</span>, <span class="at">fun =</span> mean, <span class="at">width =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb157-3"><a href="figures-captions.html#cb157-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Number of cylinders&quot;</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title =</span> <span class="st">&quot;Means&quot;</span>) <span class="sc">+</span></span>
<span id="cb157-4"><a href="figures-captions.html#cb157-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">guide =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb157-5"><a href="figures-captions.html#cb157-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-6"><a href="figures-captions.html#cb157-6" aria-hidden="true" tabindex="-1"></a>data.tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">44</span>, </span>
<span id="cb157-7"><a href="figures-captions.html#cb157-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">plot =</span> <span class="fu">list</span>(p <span class="sc">+</span></span>
<span id="cb157-8"><a href="figures-captions.html#cb157-8" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">theme_bw</span>(<span class="dv">8</span>)))</span>
<span id="cb157-9"><a href="figures-captions.html#cb157-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-10"><a href="figures-captions.html#cb157-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb157-11"><a href="figures-captions.html#cb157-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_plot</span>(<span class="at">data =</span> data.tb, <span class="fu">aes</span>(x, y, <span class="at">label =</span> plot)) <span class="sc">+</span></span>
<span id="cb157-12"><a href="figures-captions.html#cb157-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb157-13"><a href="figures-captions.html#cb157-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Engine displacement (l)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Fuel use efficiency (MPG)&quot;</span>,</span>
<span id="cb157-14"><a href="figures-captions.html#cb157-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Engine cylinders</span><span class="sc">\n</span><span class="st">(number)&quot;</span>) <span class="sc">+</span></span>
<span id="cb157-15"><a href="figures-captions.html#cb157-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-217-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="image-insets" class="section level3 unnumbered">
<h3>image insets</h3>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="figures-captions.html#cb158-1" aria-hidden="true" tabindex="-1"></a>Isoquercitin_synthase <span class="ot">&lt;-</span> magick<span class="sc">::</span><span class="fu">image_read</span>(<span class="st">&quot;https://thebustalab.github.io/integrated_bioanalytics/images/homology.png&quot;</span>)</span>
<span id="cb158-2"><a href="figures-captions.html#cb158-2" aria-hidden="true" tabindex="-1"></a>grobs.tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">40</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">9</span>),</span>
<span id="cb158-3"><a href="figures-captions.html#cb158-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">width =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="dv">1</span>),</span>
<span id="cb158-4"><a href="figures-captions.html#cb158-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">height =</span>  <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.3</span>),</span>
<span id="cb158-5"><a href="figures-captions.html#cb158-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">grob =</span> <span class="fu">list</span>(grid<span class="sc">::</span><span class="fu">circleGrob</span>(), </span>
<span id="cb158-6"><a href="figures-captions.html#cb158-6" aria-hidden="true" tabindex="-1"></a>                               grid<span class="sc">::</span><span class="fu">rectGrob</span>(), </span>
<span id="cb158-7"><a href="figures-captions.html#cb158-7" aria-hidden="true" tabindex="-1"></a>                               grid<span class="sc">::</span><span class="fu">textGrob</span>(<span class="st">&quot;I am a Grob&quot;</span>),</span>
<span id="cb158-8"><a href="figures-captions.html#cb158-8" aria-hidden="true" tabindex="-1"></a>                               grid<span class="sc">::</span><span class="fu">rasterGrob</span>(<span class="at">image =</span> Isoquercitin_synthase)))</span>
<span id="cb158-9"><a href="figures-captions.html#cb158-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-10"><a href="figures-captions.html#cb158-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb158-11"><a href="figures-captions.html#cb158-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_grob</span>(<span class="at">data =</span> grobs.tb, </span>
<span id="cb158-12"><a href="figures-captions.html#cb158-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(x, y, <span class="at">label =</span> grob, <span class="at">vp.width =</span> width, <span class="at">vp.height =</span> height),</span>
<span id="cb158-13"><a href="figures-captions.html#cb158-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">0.7</span>, <span class="at">vjust =</span> <span class="fl">0.55</span>) <span class="sc">+</span></span>
<span id="cb158-14"><a href="figures-captions.html#cb158-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.3</span>, <span class="at">add =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb158-15"><a href="figures-captions.html#cb158-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.2</span>, <span class="at">add =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb158-16"><a href="figures-captions.html#cb158-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="dv">12</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-218-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="figures-captions.html#cb159-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-2"><a href="figures-captions.html#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb159-3"><a href="figures-captions.html#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;grob&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">3</span>, <span class="at">vp.width =</span> <span class="fl">0.5</span>,</span>
<span id="cb159-4"><a href="figures-captions.html#cb159-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> grid<span class="sc">::</span><span class="fu">rasterGrob</span>(<span class="at">image =</span> Isoquercitin_synthase, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb159-5"><a href="figures-captions.html#cb159-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="dv">12</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-219-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="composite-figures" class="section level2 unnumbered">
<h2>composite figures</h2>
<p>Many high quality figures are composite figures in which there is more than one panel. Here is a simple way to make such figures in R. First, make each component of the composite figure and send the plot to a new object:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="figures-captions.html#cb160-1" aria-hidden="true" tabindex="-1"></a>color_palette <span class="ot">&lt;-</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">11</span>, <span class="st">&quot;Paired&quot;</span>)</span>
<span id="cb160-2"><a href="figures-captions.html#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(color_palette) <span class="ot">&lt;-</span> <span class="fu">unique</span>(alaska_lake_data<span class="sc">$</span>element)</span>
<span id="cb160-3"><a href="figures-captions.html#cb160-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-4"><a href="figures-captions.html#cb160-4" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb160-5"><a href="figures-captions.html#cb160-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">filter</span>(alaska_lake_data, element_type <span class="sc">==</span> <span class="st">&quot;bound&quot;</span>),</span>
<span id="cb160-6"><a href="figures-captions.html#cb160-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y =</span> lake, <span class="at">x =</span> mg_per_L)</span>
<span id="cb160-7"><a href="figures-captions.html#cb160-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb160-8"><a href="figures-captions.html#cb160-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(</span>
<span id="cb160-9"><a href="figures-captions.html#cb160-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> element), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>,</span>
<span id="cb160-10"><a href="figures-captions.html#cb160-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb160-11"><a href="figures-captions.html#cb160-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb160-12"><a href="figures-captions.html#cb160-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(park<span class="sc">~</span>., <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">space =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb160-13"><a href="figures-captions.html#cb160-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb160-14"><a href="figures-captions.html#cb160-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> color_palette) <span class="sc">+</span></span>
<span id="cb160-15"><a href="figures-captions.html#cb160-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Lake Name&quot;</span>) <span class="sc">+</span></span>
<span id="cb160-16"><a href="figures-captions.html#cb160-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Abundance mg/L)&quot;</span>) <span class="sc">+</span></span>
<span id="cb160-17"><a href="figures-captions.html#cb160-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb160-18"><a href="figures-captions.html#cb160-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb160-19"><a href="figures-captions.html#cb160-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb160-20"><a href="figures-captions.html#cb160-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-21"><a href="figures-captions.html#cb160-21" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb160-22"><a href="figures-captions.html#cb160-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">filter</span>(alaska_lake_data, element_type <span class="sc">==</span> <span class="st">&quot;free&quot;</span>),</span>
<span id="cb160-23"><a href="figures-captions.html#cb160-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y =</span> lake, <span class="at">x =</span> mg_per_L)</span>
<span id="cb160-24"><a href="figures-captions.html#cb160-24" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb160-25"><a href="figures-captions.html#cb160-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(</span>
<span id="cb160-26"><a href="figures-captions.html#cb160-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> element), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>,</span>
<span id="cb160-27"><a href="figures-captions.html#cb160-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb160-28"><a href="figures-captions.html#cb160-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb160-29"><a href="figures-captions.html#cb160-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(park<span class="sc">~</span>., <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">space =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb160-30"><a href="figures-captions.html#cb160-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb160-31"><a href="figures-captions.html#cb160-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> color_palette) <span class="sc">+</span></span>
<span id="cb160-32"><a href="figures-captions.html#cb160-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Lake Name&quot;</span>) <span class="sc">+</span></span>
<span id="cb160-33"><a href="figures-captions.html#cb160-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Abundance mg/L)&quot;</span>) <span class="sc">+</span></span>
<span id="cb160-34"><a href="figures-captions.html#cb160-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb160-35"><a href="figures-captions.html#cb160-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb160-36"><a href="figures-captions.html#cb160-36" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Now, add them together to lay them out. Let‚Äôs look at various ways to lay this out:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="figures-captions.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(plot1, plot2)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-221-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="figures-captions.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(plot1, plot2, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-222-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="figures-captions.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(<span class="fu">plot_grid</span>(plot1,plot2), plot1, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-223-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="exporting-graphics" class="section level2 unnumbered">
<h2>exporting graphics</h2>
<p>To export graphics from R, consider the code below. The <path_to_file_you_want_to_create> should be something like: ‚ÄúC:\Desktop\the_file.png‚Äù (i.e.¬†a path to a specific file with a .png suffix. It should be a file that does not yet exist - if it does already exist, it will be overwritten. You should adjust with height and width to get the image to look how you want, then once you have that dialed in, crank the resolution to 1200 or 2400 and export a final version.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="figures-captions.html#cb164-1" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb164-2"><a href="figures-captions.html#cb164-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-3"><a href="figures-captions.html#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">filename =</span> <span class="sc">&lt;</span>path_to_file_you_want_to_create<span class="sc">&gt;</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">res =</span> <span class="dv">600</span>, <span class="at">units =</span> <span class="st">&quot;in&quot;</span>)</span>
<span id="cb164-4"><a href="figures-captions.html#cb164-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-5"><a href="figures-captions.html#cb164-5" aria-hidden="true" tabindex="-1"></a>plot</span>
<span id="cb164-6"><a href="figures-captions.html#cb164-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-7"><a href="figures-captions.html#cb164-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="captions" class="section level2 unnumbered">
<h2>captions</h2>
<ol style="list-style-type: decimal">
<li>Title - an overall description of the what is shown</li>
<li>For each subplot:</li>
</ol>
<ul>
<li>The type of plot (line plot, bar chart, etc.)</li>
<li>Describe what is plotted as y vs x in words.</li>
<li>Describe what each bar, point, or error bar represents.</li>
<li>If applicable, describe the number of independent samples or measurements (sometimes called ‚Äúreplicates‚Äù) that underlie a given geometric feature or summary statistic.</li>
<li>Describe where the data are from.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Avoid abbreviations, but if you do use any, specify what they mean.</li>
</ol>
<p>An example:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="figures-captions.html#cb165-1" aria-hidden="true" tabindex="-1"></a>(plot1 <span class="sc">+</span> plot2 <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">caption =</span> <span class="fu">str_wrap</span>(<span class="st">&quot;Figure 1: Carbon, nitrogen, and phosphorous in Alaskan lakes. A) A bar chart showing the abundance (in mg per L, x-axis) of the bound elements (C, N, and P) in various Alaskan lakes (lake names on y-axis) that are located in one of three parks in Alaska (park names on right y groupings). B) A bar chart showing the abundance (in mg per L, x-axis) of the free elements (Cl, S, F, Br, Na, K, Ca, and Mg) in various Alaskan lakes (lake names on y-axis) that are located in one of three parks in Alaska (park names on right y groupings). The data are from a public chemistry data repository. Each bar represents the result of a single measurement of a single analyte, the identity of which is coded using color as shown in the color legend. Abbreviations: BELA - Bering Land Bridge National Preserve, GAAR - Gates Of The Arctic National Park &amp; Preserve, NOAT - Noatak National Preserve.&quot;</span>, <span class="dv">90</span>))) <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&#39;A&#39;</span>) <span class="sc">+</span> </span>
<span id="cb165-2"><a href="figures-captions.html#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="fl">1.1</span>, <span class="dv">3</span>), <span class="at">guides =</span> <span class="st">&#39;collect&#39;</span>) <span class="sc">&amp;</span></span>
<span id="cb165-3"><a href="figures-captions.html#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;right&#39;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-225-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="further-reading-9" class="section level2 unnumbered">
<h2>further reading</h2>
<div id="insets" class="section level3 unnumbered">
<h3>insets</h3>
<p><a href="https://docs.r4photobiology.info/ggpp/articles/grammar-extensions.html#geom_plot" class="uri">https://docs.r4photobiology.info/ggpp/articles/grammar-extensions.html#geom_plot</a></p>
</div>
<div id="plot-layout" class="section level3 unnumbered">
<h3>plot layout</h3>
<p>One option for plot layout, <code>patchwork</code>. This one is quick and simple.
<a href="https://patchwork.data-imaginist.com/index.html">patchwork, for plot layout</a></p>
<p>Another option for plot layout is <code>cowplot</code>. Cowplot is a bit more complicated, but is more versatile.
<a href="https://wilkelab.org/cowplot/articles/plot_grid.html">cowplot on Github</a></p>
</div>
</div>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <h2>Note: Second Edition is under construction üèó</h2>
    <p>Now is a great time to provide feedback</p>
        <ul class="list-unstyled">
          <li><a href="https://forms.gle/SZmB2Ct2exE2dBwv9">Provide feedback (5 min)</a></li>
          <!-- <li><a href="https://geocompr.robinlovelace.net/#reproducibility">Install updated packages</a></li> -->
          <!-- <li><a href="https://github.com/Robinlovelace/geocompr/issues">Open an issue <i class="fas fa-question"></i></a></li> -->
          <!-- <li><a href="https://discord.gg/Te3gWeDwmf">Chat on Discord <i class="fab fa-discord"></i></a></li> -->
        </ul>
        <hr>
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Integrated Bioanalytics</strong>" was written by Lucas Busta and members of the Busta lab. It was last built on 2023-06-16.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


</body>

</html>
