<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Summary Statistics | R For Chemists</title>
  <meta name="description" content="Textbook R For Chemists." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Summary Statistics | R For Chemists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Textbook R For Chemists." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Summary Statistics | R For Chemists" />
  
  <meta name="twitter:description" content="Textbook R For Chemists." />
  

<meta name="author" content="Lucas Busta" />


<meta name="date" content="2020-10-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Exercises-2.html"/>
<link rel="next" href="Exercises-3.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a><ul>
<li class="chapter" data-level="2.1" data-path="installation.html"><a href="installation.html#installing-r"><i class="fa fa-check"></i><b>2.1</b> Installing <code>R</code></a></li>
<li class="chapter" data-level="2.2" data-path="installation.html"><a href="installation.html#installing-rstudio"><i class="fa fa-check"></i><b>2.2</b> Installing <code>RStudio</code></a></li>
<li class="chapter" data-level="2.3" data-path="installation.html"><a href="installation.html#verifying-installations"><i class="fa fa-check"></i><b>2.3</b> Verifying installations</a></li>
<li class="chapter" data-level="2.4" data-path="installation.html"><a href="installation.html#installing-the-tidyverse"><i class="fa fa-check"></i><b>2.4</b> Installing the <code>tidyverse</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="R-Basics.html"><a href="R-Basics.html"><i class="fa fa-check"></i><b>3</b> R Basics</a><ul>
<li class="chapter" data-level="3.1" data-path="R-Basics.html"><a href="R-Basics.html#before-we-start"><i class="fa fa-check"></i><b>3.1</b> Before we start…</a><ul>
<li class="chapter" data-level="3.1.1" data-path="R-Basics.html"><a href="R-Basics.html#help"><i class="fa fa-check"></i><b>3.1.1</b> Help</a></li>
<li class="chapter" data-level="3.1.2" data-path="R-Basics.html"><a href="R-Basics.html#syntax"><i class="fa fa-check"></i><b>3.1.2</b> Syntax</a></li>
<li class="chapter" data-level="3.1.3" data-path="R-Basics.html"><a href="R-Basics.html#paths"><i class="fa fa-check"></i><b>3.1.3</b> Paths</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="R-Basics.html"><a href="R-Basics.html#functions"><i class="fa fa-check"></i><b>3.2</b> Functions</a></li>
<li class="chapter" data-level="3.3" data-path="R-Basics.html"><a href="R-Basics.html#objects"><i class="fa fa-check"></i><b>3.3</b> Objects</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Visualization-1.html"><a href="Visualization-1.html"><i class="fa fa-check"></i><b>4</b> Visualization 1</a><ul>
<li class="chapter" data-level="4.1" data-path="Visualization-1.html"><a href="Visualization-1.html#setting-up-a-ggplot"><i class="fa fa-check"></i><b>4.1</b> Setting up a ggplot</a><ul>
<li class="chapter" data-level="4.1.1" data-path="Visualization-1.html"><a href="Visualization-1.html#step-1-define-the-data-you-want-to-use."><i class="fa fa-check"></i><b>4.1.1</b> Step 1: Define the data you want to use.</a></li>
<li class="chapter" data-level="4.1.2" data-path="Visualization-1.html"><a href="Visualization-1.html#step-2-define-how-your-variables-map-onto-the-axes."><i class="fa fa-check"></i><b>4.1.2</b> Step 2: Define how your variables map onto the axes.</a></li>
<li class="chapter" data-level="4.1.3" data-path="Visualization-1.html"><a href="Visualization-1.html#step-3-use-geometric-shapes-to-represent-other-variables-in-your-data."><i class="fa fa-check"></i><b>4.1.3</b> Step 3: Use geometric shapes to represent other variables in your data.</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="Visualization-1.html"><a href="Visualization-1.html#geoms"><i class="fa fa-check"></i><b>4.2</b> Geoms</a><ul>
<li class="chapter" data-level="4.2.1" data-path="Visualization-1.html"><a href="Visualization-1.html#modifying-geoms"><i class="fa fa-check"></i><b>4.2.1</b> Modifying geoms</a></li>
<li class="chapter" data-level="4.2.2" data-path="Visualization-1.html"><a href="Visualization-1.html#using-multiple-geoms"><i class="fa fa-check"></i><b>4.2.2</b> Using multiple geoms</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Exercises-1.html"><a href="Exercises-1.html"><i class="fa fa-check"></i><b>5</b> Exercises 1</a><ul>
<li class="chapter" data-level="5.1" data-path="Exercises-1.html"><a href="Exercises-1.html#part-1-algae-chemistry-dataset"><i class="fa fa-check"></i><b>5.1</b> Part 1: Algae Chemistry Dataset</a><ul>
<li class="chapter" data-level="5.1.1" data-path="Exercises-1.html"><a href="Exercises-1.html#question-1-importing-data"><i class="fa fa-check"></i><b>5.1.1</b> Question 1: Importing data</a></li>
<li class="chapter" data-level="5.1.2" data-path="Exercises-1.html"><a href="Exercises-1.html#question-2-dataset-dimensions"><i class="fa fa-check"></i><b>5.1.2</b> Question 2: Dataset dimensions</a></li>
<li class="chapter" data-level="5.1.3" data-path="Exercises-1.html"><a href="Exercises-1.html#question-3-objects"><i class="fa fa-check"></i><b>5.1.3</b> Question 3: Objects</a></li>
<li class="chapter" data-level="5.1.4" data-path="Exercises-1.html"><a href="Exercises-1.html#question-4-filtering"><i class="fa fa-check"></i><b>5.1.4</b> Question 4: Filtering</a></li>
<li class="chapter" data-level="5.1.5" data-path="Exercises-1.html"><a href="Exercises-1.html#question-5-plotting"><i class="fa fa-check"></i><b>5.1.5</b> Question 5: Plotting</a></li>
<li class="chapter" data-level="5.1.6" data-path="Exercises-1.html"><a href="Exercises-1.html#question-6-plotting"><i class="fa fa-check"></i><b>5.1.6</b> Question 6: Plotting</a></li>
<li class="chapter" data-level="5.1.7" data-path="Exercises-1.html"><a href="Exercises-1.html#question-7-filtering-and-plotting"><i class="fa fa-check"></i><b>5.1.7</b> Question 7: Filtering and plotting</a></li>
<li class="chapter" data-level="5.1.8" data-path="Exercises-1.html"><a href="Exercises-1.html#question-8-filtering-and-plotting"><i class="fa fa-check"></i><b>5.1.8</b> Question 8: Filtering and plotting</a></li>
<li class="chapter" data-level="5.1.9" data-path="Exercises-1.html"><a href="Exercises-1.html#question-9-open-ended-plotting"><i class="fa fa-check"></i><b>5.1.9</b> Question 9: Open-ended plotting</a></li>
<li class="chapter" data-level="5.1.10" data-path="Exercises-1.html"><a href="Exercises-1.html#question-10-a-peek-at-whats-to-come"><i class="fa fa-check"></i><b>5.1.10</b> Question 10: A peek at what’s to come…</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="Exercises-1.html"><a href="Exercises-1.html#part-2-alaska-lakes-dataset"><i class="fa fa-check"></i><b>5.2</b> Part 2: Alaska Lakes Dataset</a><ul>
<li class="chapter" data-level="5.2.1" data-path="Exercises-1.html"><a href="Exercises-1.html#question-1-importing-data-1"><i class="fa fa-check"></i><b>5.2.1</b> Question 1: Importing Data</a></li>
<li class="chapter" data-level="5.2.2" data-path="Exercises-1.html"><a href="Exercises-1.html#question-2-objects"><i class="fa fa-check"></i><b>5.2.2</b> Question 2: Objects</a></li>
<li class="chapter" data-level="5.2.3" data-path="Exercises-1.html"><a href="Exercises-1.html#question-3-filtering"><i class="fa fa-check"></i><b>5.2.3</b> Question 3: Filtering</a></li>
<li class="chapter" data-level="5.2.4" data-path="Exercises-1.html"><a href="Exercises-1.html#question-4-plotting"><i class="fa fa-check"></i><b>5.2.4</b> Question 4: Plotting</a></li>
<li class="chapter" data-level="5.2.5" data-path="Exercises-1.html"><a href="Exercises-1.html#question-5-plotting-1"><i class="fa fa-check"></i><b>5.2.5</b> Question 5: Plotting</a></li>
<li class="chapter" data-level="5.2.6" data-path="Exercises-1.html"><a href="Exercises-1.html#question-6-filtering-and-plotting"><i class="fa fa-check"></i><b>5.2.6</b> Question 6: Filtering and Plotting</a></li>
<li class="chapter" data-level="5.2.7" data-path="Exercises-1.html"><a href="Exercises-1.html#question-7-filtering-and-plotting-1"><i class="fa fa-check"></i><b>5.2.7</b> Question 7: Filtering and Plotting</a></li>
<li class="chapter" data-level="5.2.8" data-path="Exercises-1.html"><a href="Exercises-1.html#question-8-open-ended-plotting"><i class="fa fa-check"></i><b>5.2.8</b> Question 8: Open-ended Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html"><i class="fa fa-check"></i><b>6</b> geoms, facets, scales, themes</a><ul>
<li class="chapter" data-level="6.1" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#geoms-1"><i class="fa fa-check"></i><b>6.1</b> Geoms</a></li>
<li class="chapter" data-level="6.2" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#facets"><i class="fa fa-check"></i><b>6.2</b> Facets</a></li>
<li class="chapter" data-level="6.3" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#scales"><i class="fa fa-check"></i><b>6.3</b> Scales</a></li>
<li class="chapter" data-level="6.4" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#themes"><i class="fa fa-check"></i><b>6.4</b> Themes</a><ul>
<li class="chapter" data-level="6.4.1" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#complete-themes"><i class="fa fa-check"></i><b>6.4.1</b> Complete themes</a></li>
<li class="chapter" data-level="6.4.2" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#theme-components"><i class="fa fa-check"></i><b>6.4.2</b> Theme components</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Exercises-2.html"><a href="Exercises-2.html"><i class="fa fa-check"></i><b>7</b> Exercises 2</a><ul>
<li class="chapter" data-level="7.1" data-path="Exercises-2.html"><a href="Exercises-2.html#question-1"><i class="fa fa-check"></i><b>7.1</b> Question 1</a></li>
<li class="chapter" data-level="7.2" data-path="Exercises-2.html"><a href="Exercises-2.html#question-2"><i class="fa fa-check"></i><b>7.2</b> Question 2</a></li>
<li class="chapter" data-level="7.3" data-path="Exercises-2.html"><a href="Exercises-2.html#question-3"><i class="fa fa-check"></i><b>7.3</b> Question 3</a></li>
<li class="chapter" data-level="7.4" data-path="Exercises-2.html"><a href="Exercises-2.html#question-4"><i class="fa fa-check"></i><b>7.4</b> Question 4</a></li>
<li class="chapter" data-level="7.5" data-path="Exercises-2.html"><a href="Exercises-2.html#question-5"><i class="fa fa-check"></i><b>7.5</b> Question 5</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>8</b> Summary Statistics</a><ul>
<li class="chapter" data-level="8.1" data-path="summary-statistics.html"><a href="summary-statistics.html#summary-statistics"><i class="fa fa-check"></i><b>8.1</b> Summary statistics</a></li>
<li class="chapter" data-level="8.2" data-path="summary-statistics.html"><a href="summary-statistics.html#the-pipe"><i class="fa fa-check"></i><b>8.2</b> The pipe (%&gt;%)</a></li>
<li class="chapter" data-level="8.3" data-path="summary-statistics.html"><a href="summary-statistics.html#tidy-data"><i class="fa fa-check"></i><b>8.3</b> Tidy data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Exercises-3.html"><a href="Exercises-3.html"><i class="fa fa-check"></i><b>9</b> Exercises 3</a><ul>
<li class="chapter" data-level="9.1" data-path="Exercises-3.html"><a href="Exercises-3.html#question-1-1"><i class="fa fa-check"></i><b>9.1</b> Question 1</a></li>
<li class="chapter" data-level="9.2" data-path="Exercises-3.html"><a href="Exercises-3.html#question-2-1"><i class="fa fa-check"></i><b>9.2</b> Question 2</a></li>
<li class="chapter" data-level="9.3" data-path="Exercises-3.html"><a href="Exercises-3.html#question-3-1"><i class="fa fa-check"></i><b>9.3</b> Question 3</a></li>
<li class="chapter" data-level="9.4" data-path="Exercises-3.html"><a href="Exercises-3.html#question-4-1"><i class="fa fa-check"></i><b>9.4</b> Question 4</a></li>
<li class="chapter" data-level="9.5" data-path="Exercises-3.html"><a href="Exercises-3.html#question-5-1"><i class="fa fa-check"></i><b>9.5</b> Question 5</a></li>
<li class="chapter" data-level="9.6" data-path="Exercises-3.html"><a href="Exercises-3.html#question-6"><i class="fa fa-check"></i><b>9.6</b> Question 6</a></li>
<li class="chapter" data-level="9.7" data-path="Exercises-3.html"><a href="Exercises-3.html#question-7"><i class="fa fa-check"></i><b>9.7</b> Question 7</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Clustering.html"><a href="Clustering.html"><i class="fa fa-check"></i><b>10</b> Clustering</a></li>
<li class="chapter" data-level="11" data-path="Exercises-4.html"><a href="Exercises-4.html"><i class="fa fa-check"></i><b>11</b> Exercises 4</a></li>
<li class="chapter" data-level="12" data-path="PCA.html"><a href="PCA.html"><i class="fa fa-check"></i><b>12</b> PCA</a><ul>
<li class="chapter" data-level="12.1" data-path="PCA.html"><a href="PCA.html#pca"><i class="fa fa-check"></i><b>12.1</b> PCA</a></li>
<li class="chapter" data-level="12.2" data-path="PCA.html"><a href="PCA.html#drivers-of-pca-dimensions"><i class="fa fa-check"></i><b>12.2</b> Drivers of PCA dimensions</a></li>
<li class="chapter" data-level="12.3" data-path="PCA.html"><a href="PCA.html#comparing-principal-components"><i class="fa fa-check"></i><b>12.3</b> Comparing principal components</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="Exercises-5.html"><a href="Exercises-5.html"><i class="fa fa-check"></i><b>13</b> Exercises 5</a><ul>
<li class="chapter" data-level="13.1" data-path="Exercises-5.html"><a href="Exercises-5.html#option-1-human-metabolomics."><i class="fa fa-check"></i><b>13.1</b> Option 1: Human metabolomics.</a></li>
<li class="chapter" data-level="13.2" data-path="Exercises-5.html"><a href="Exercises-5.html#option-2-grape-vine-varieties"><i class="fa fa-check"></i><b>13.2</b> Option 2: Grape vine varieties</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="k-means.html"><a href="k-means.html"><i class="fa fa-check"></i><b>14</b> k-means</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="functions-1.html"><a href="functions-1.html"><i class="fa fa-check"></i><b>A</b> Functions</a></li>
<li class="chapter" data-level="B" data-path="custom-functions.html"><a href="custom-functions.html"><i class="fa fa-check"></i><b>B</b> Custom functions</a><ul>
<li class="chapter" data-level="B.1" data-path="custom-functions.html"><a href="custom-functions.html#activating-custom-functions"><i class="fa fa-check"></i><b>B.1</b> Activating custom functions</a></li>
<li class="chapter" data-level="B.2" data-path="custom-functions.html"><a href="custom-functions.html#basic-runmatrixanalysis-template"><i class="fa fa-check"></i><b>B.2</b> Basic <code>runMatrixAnalysis()</code> template</a></li>
<li class="chapter" data-level="B.3" data-path="custom-functions.html"><a href="custom-functions.html#advanced-runmatrixanalysis-template"><i class="fa fa-check"></i><b>B.3</b> Advanced <code>runMatrixAnalysis()</code> template</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>C</b> FAQ</a><ul>
<li class="chapter" data-level="C.1" data-path="faq.html"><a href="faq.html#filtering"><i class="fa fa-check"></i><b>C.1</b> Filtering</a></li>
<li class="chapter" data-level="C.2" data-path="faq.html"><a href="faq.html#order-categorical-axes"><i class="fa fa-check"></i><b>C.2</b> Order categorical axes</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="pca-and-big-data.html"><a href="pca-and-big-data.html"><i class="fa fa-check"></i><b>D</b> PCA and Big Data</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R For Chemists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="summary_statistics" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Summary Statistics</h1>
<div id="summary-statistics" class="section level2">
<h2><span class="header-section-number">8.1</span> Summary statistics</h2>
<p>So far, we have been importing and plotting raw data. This is well and good, but it is not always suitable. Often we have scientific questions that cannot be answered by looking at raw data alone, or sometimes there is too much raw data to plot. For this, we need summary statistics - things like averages, standard deviations, and so on. While these metrics can be computed in Excel, programming such can be time consuming, especially for group statistics. Consider the example below, which uses the <a href="https://thebustalab.github.io/R_For_Chemists/sample_data/NY_trees.csv">NY Trees</a> dataset.</p>
<p>The NY Trees dataset contains information on nearly half a million trees in New York City (this is after considerable filtering and simplification):</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="summary-statistics.html#cb35-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb35-2"><a href="summary-statistics.html#cb35-2"></a>ny_trees &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://thebustalab.github.io/R_For_Chemists/sample_data/NY_trees.csv&quot;</span>)</span>
<span id="cb35-3"><a href="summary-statistics.html#cb35-3"></a><span class="co">## Parsed with column specification:</span></span>
<span id="cb35-4"><a href="summary-statistics.html#cb35-4"></a><span class="co">## cols(</span></span>
<span id="cb35-5"><a href="summary-statistics.html#cb35-5"></a><span class="co">##   tree_height = col_double(),</span></span>
<span id="cb35-6"><a href="summary-statistics.html#cb35-6"></a><span class="co">##   tree_diameter = col_double(),</span></span>
<span id="cb35-7"><a href="summary-statistics.html#cb35-7"></a><span class="co">##   address = col_character(),</span></span>
<span id="cb35-8"><a href="summary-statistics.html#cb35-8"></a><span class="co">##   tree_loc = col_character(),</span></span>
<span id="cb35-9"><a href="summary-statistics.html#cb35-9"></a><span class="co">##   pit_type = col_character(),</span></span>
<span id="cb35-10"><a href="summary-statistics.html#cb35-10"></a><span class="co">##   soil_lvl = col_character(),</span></span>
<span id="cb35-11"><a href="summary-statistics.html#cb35-11"></a><span class="co">##   status = col_character(),</span></span>
<span id="cb35-12"><a href="summary-statistics.html#cb35-12"></a><span class="co">##   spc_latin = col_character(),</span></span>
<span id="cb35-13"><a href="summary-statistics.html#cb35-13"></a><span class="co">##   spc_common = col_character(),</span></span>
<span id="cb35-14"><a href="summary-statistics.html#cb35-14"></a><span class="co">##   trunk_dmg = col_character(),</span></span>
<span id="cb35-15"><a href="summary-statistics.html#cb35-15"></a><span class="co">##   zipcode = col_double(),</span></span>
<span id="cb35-16"><a href="summary-statistics.html#cb35-16"></a><span class="co">##   boroname = col_character(),</span></span>
<span id="cb35-17"><a href="summary-statistics.html#cb35-17"></a><span class="co">##   latitude = col_double(),</span></span>
<span id="cb35-18"><a href="summary-statistics.html#cb35-18"></a><span class="co">##   longitude = col_double()</span></span>
<span id="cb35-19"><a href="summary-statistics.html#cb35-19"></a><span class="co">## )</span></span>
<span id="cb35-20"><a href="summary-statistics.html#cb35-20"></a>ny_trees</span>
<span id="cb35-21"><a href="summary-statistics.html#cb35-21"></a><span class="co">## # A tibble: 378,762 x 14</span></span>
<span id="cb35-22"><a href="summary-statistics.html#cb35-22"></a><span class="co">##    tree_height tree_diameter address tree_loc pit_type soil_lvl status</span></span>
<span id="cb35-23"><a href="summary-statistics.html#cb35-23"></a><span class="co">##          &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt; </span></span>
<span id="cb35-24"><a href="summary-statistics.html#cb35-24"></a><span class="co">##  1        21.1             6 1139 5… Front    Sidewal… Level    Good  </span></span>
<span id="cb35-25"><a href="summary-statistics.html#cb35-25"></a><span class="co">##  2        59.0             6 2220 B… Across   Sidewal… Level    Good  </span></span>
<span id="cb35-26"><a href="summary-statistics.html#cb35-26"></a><span class="co">##  3        92.4            13 2254 B… Across   Sidewal… Level    Good  </span></span>
<span id="cb35-27"><a href="summary-statistics.html#cb35-27"></a><span class="co">##  4        50.2            15 2332 B… Across   Sidewal… Level    Good  </span></span>
<span id="cb35-28"><a href="summary-statistics.html#cb35-28"></a><span class="co">##  5        95.0            21 2361 E… Front    Sidewal… Level    Poor  </span></span>
<span id="cb35-29"><a href="summary-statistics.html#cb35-29"></a><span class="co">##  6        67.5            19 2409 E… Front    Continu… Level    Good  </span></span>
<span id="cb35-30"><a href="summary-statistics.html#cb35-30"></a><span class="co">##  7        75.3            11 1481 E… Front    Lawn     Level    Excel…</span></span>
<span id="cb35-31"><a href="summary-statistics.html#cb35-31"></a><span class="co">##  8        27.9             7 1129 5… Front    Sidewal… Level    Good  </span></span>
<span id="cb35-32"><a href="summary-statistics.html#cb35-32"></a><span class="co">##  9       111.             26 2076 E… Across   Sidewal… Level    Excel…</span></span>
<span id="cb35-33"><a href="summary-statistics.html#cb35-33"></a><span class="co">## 10        83.9            20 2025 E… Front    Sidewal… Level    Excel…</span></span>
<span id="cb35-34"><a href="summary-statistics.html#cb35-34"></a><span class="co">## # … with 378,752 more rows, and 7 more variables: spc_latin &lt;chr&gt;,</span></span>
<span id="cb35-35"><a href="summary-statistics.html#cb35-35"></a><span class="co">## #   spc_common &lt;chr&gt;, trunk_dmg &lt;chr&gt;, zipcode &lt;dbl&gt;, boroname &lt;chr&gt;,</span></span>
<span id="cb35-36"><a href="summary-statistics.html#cb35-36"></a><span class="co">## #   latitude &lt;dbl&gt;, longitude &lt;dbl&gt;</span></span></code></pre></div>
<p>More than 300,000 observations of 14 variables! That’s 4.2M datapoints! Now, what is the average and standard deviation of the height and diameter of each tree species within each NY borough? Do those values change for trees that are in parks versus sidewalk pits?? I don’t even know how one would begin to approach such questions using traditional spreadsheets. Here, we will answer these questions with ease using two new commands: <code>group_by()</code> and <code>summarize()</code>. Let’s get to it.</p>
<p>Say that we want to know (and of course, visualize) the mean and standard deviation of the heights of each tree species in NYC. We can see that data in first few columns of the NY trees dataset above, but how to calculate these statistics? In R, mean can be computed with <code>mean()</code> and standard deviation can be calculated with <code>sd()</code>. Also, keep in mind that a single column of a dataset can be accessed using <code>$</code>. So, we can calculate the average and standard deviation of all the trees in the data set as follows:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="summary-statistics.html#cb36-1"></a><span class="kw">mean</span>(ny_trees<span class="op">$</span>tree_height)</span>
<span id="cb36-2"><a href="summary-statistics.html#cb36-2"></a><span class="co">## [1] 72.57976</span></span>
<span id="cb36-3"><a href="summary-statistics.html#cb36-3"></a><span class="kw">sd</span>(ny_trees<span class="op">$</span>tree_height)</span>
<span id="cb36-4"><a href="summary-statistics.html#cb36-4"></a><span class="co">## [1] 28.65391</span></span></code></pre></div>
<p>Great! But how to do this for each species? We need to divide up the data by species, then compute the mean and standard deviation, then recombine the results into a new table. First, we use <code>group_by()</code>. Note that in ny_trees, species are indicated in the column called <code>spc_latin</code>. Once the data is grouped, we can use <code>summarize()</code> to compute statistics. Please note that both <code>group_by()</code> and <code>summarize()</code> require <code>.data =</code> as an argument, as opposed to <code>data =</code>, which we have been using up to this point.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="summary-statistics.html#cb37-1"></a>ny_trees_by_spc &lt;-<span class="st"> </span><span class="kw">group_by</span>(<span class="dt">.data =</span> ny_trees, spc_latin)</span>
<span id="cb37-2"><a href="summary-statistics.html#cb37-2"></a><span class="kw">summarize</span>(<span class="dt">.data =</span> ny_trees_by_spc, <span class="dt">mean_height =</span> <span class="kw">mean</span>(tree_height))</span>
<span id="cb37-3"><a href="summary-statistics.html#cb37-3"></a><span class="co">## # A tibble: 12 x 2</span></span>
<span id="cb37-4"><a href="summary-statistics.html#cb37-4"></a><span class="co">##    spc_latin              mean_height</span></span>
<span id="cb37-5"><a href="summary-statistics.html#cb37-5"></a><span class="co">##    &lt;chr&gt;                        &lt;dbl&gt;</span></span>
<span id="cb37-6"><a href="summary-statistics.html#cb37-6"></a><span class="co">##  1 ACER PLATANOIDES              82.6</span></span>
<span id="cb37-7"><a href="summary-statistics.html#cb37-7"></a><span class="co">##  2 ACER RUBRUM                  106. </span></span>
<span id="cb37-8"><a href="summary-statistics.html#cb37-8"></a><span class="co">##  3 ACER SACCHARINUM              65.6</span></span>
<span id="cb37-9"><a href="summary-statistics.html#cb37-9"></a><span class="co">##  4 FRAXINUS PENNSYLVANICA        60.6</span></span>
<span id="cb37-10"><a href="summary-statistics.html#cb37-10"></a><span class="co">##  5 GINKGO BILOBA                 90.4</span></span>
<span id="cb37-11"><a href="summary-statistics.html#cb37-11"></a><span class="co">##  6 GLEDITSIA TRIACANTHOS         53.0</span></span>
<span id="cb37-12"><a href="summary-statistics.html#cb37-12"></a><span class="co">##  7 PLATANUS ACERIFOLIA           82.0</span></span>
<span id="cb37-13"><a href="summary-statistics.html#cb37-13"></a><span class="co">##  8 PYRUS CALLERYANA              21.0</span></span>
<span id="cb37-14"><a href="summary-statistics.html#cb37-14"></a><span class="co">##  9 QUERCUS PALUSTRIS             65.5</span></span>
<span id="cb37-15"><a href="summary-statistics.html#cb37-15"></a><span class="co">## 10 QUERCUS RUBRA                111. </span></span>
<span id="cb37-16"><a href="summary-statistics.html#cb37-16"></a><span class="co">## 11 TILIA CORDATA                 98.8</span></span>
<span id="cb37-17"><a href="summary-statistics.html#cb37-17"></a><span class="co">## 12 ZELKOVA SERRATA              101.</span></span></code></pre></div>
<p>Bam. Mean height of each tree species. <code>summarize()</code> is more powerful though, we can do many summary statistics at once:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="summary-statistics.html#cb38-1"></a>ny_trees_by_spc &lt;-<span class="st"> </span><span class="kw">group_by</span>(<span class="dt">.data =</span> ny_trees, spc_latin)</span>
<span id="cb38-2"><a href="summary-statistics.html#cb38-2"></a>ny_trees_by_spc_summ &lt;-<span class="st"> </span><span class="kw">summarize</span>(<span class="dt">.data =</span> ny_trees_by_spc, <span class="dt">mean_height =</span> <span class="kw">mean</span>(tree_height), <span class="dt">stdev_height =</span> <span class="kw">sd</span>(tree_height))</span>
<span id="cb38-3"><a href="summary-statistics.html#cb38-3"></a>ny_trees_by_spc_summ</span>
<span id="cb38-4"><a href="summary-statistics.html#cb38-4"></a><span class="co">## # A tibble: 12 x 3</span></span>
<span id="cb38-5"><a href="summary-statistics.html#cb38-5"></a><span class="co">##    spc_latin              mean_height stdev_height</span></span>
<span id="cb38-6"><a href="summary-statistics.html#cb38-6"></a><span class="co">##    &lt;chr&gt;                        &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb38-7"><a href="summary-statistics.html#cb38-7"></a><span class="co">##  1 ACER PLATANOIDES              82.6        17.6 </span></span>
<span id="cb38-8"><a href="summary-statistics.html#cb38-8"></a><span class="co">##  2 ACER RUBRUM                  106.         15.7 </span></span>
<span id="cb38-9"><a href="summary-statistics.html#cb38-9"></a><span class="co">##  3 ACER SACCHARINUM              65.6        16.6 </span></span>
<span id="cb38-10"><a href="summary-statistics.html#cb38-10"></a><span class="co">##  4 FRAXINUS PENNSYLVANICA        60.6        21.3 </span></span>
<span id="cb38-11"><a href="summary-statistics.html#cb38-11"></a><span class="co">##  5 GINKGO BILOBA                 90.4        24.5 </span></span>
<span id="cb38-12"><a href="summary-statistics.html#cb38-12"></a><span class="co">##  6 GLEDITSIA TRIACANTHOS         53.0        13.0 </span></span>
<span id="cb38-13"><a href="summary-statistics.html#cb38-13"></a><span class="co">##  7 PLATANUS ACERIFOLIA           82.0        16.0 </span></span>
<span id="cb38-14"><a href="summary-statistics.html#cb38-14"></a><span class="co">##  8 PYRUS CALLERYANA              21.0         5.00</span></span>
<span id="cb38-15"><a href="summary-statistics.html#cb38-15"></a><span class="co">##  9 QUERCUS PALUSTRIS             65.5         6.48</span></span>
<span id="cb38-16"><a href="summary-statistics.html#cb38-16"></a><span class="co">## 10 QUERCUS RUBRA                111.         20.7 </span></span>
<span id="cb38-17"><a href="summary-statistics.html#cb38-17"></a><span class="co">## 11 TILIA CORDATA                 98.8        32.6 </span></span>
<span id="cb38-18"><a href="summary-statistics.html#cb38-18"></a><span class="co">## 12 ZELKOVA SERRATA              101.         10.7</span></span></code></pre></div>
<p>Now we can use this data in plotting. For this, we will use a new geom, <code>geom_pointrange</code>, which takes <code>x</code> and <code>y</code> aesthetics, as usual, but also requires two additional y-ish aesthetics <code>ymin</code> and <code>ymax</code>. Note that in this case, if we map spc_latin to the x axis, the x axis tick labels will have long names that will overlap in our plot. In the past we have avoided this by swapping the mappings of x and y in out plots. Here, this gets a bit tedious since we will have to change ymin and ymax as well. Instead of all this, we can just add <code>coord_flip()</code> to our plot, which will swap x and y axes automatically. Also, note that in the aesthetic mappings for <code>ymin</code> and <code>ymax</code>, we can use a mathematical expression: <code>mean-stdev</code> and <code>mean+stdev</code>, respectivey. In our case, these are <code>mean_height - stdev_height</code> and <code>mean_height + stdev_height</code>. Let’s see it in action:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="summary-statistics.html#cb39-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ny_trees_by_spc_summ) <span class="op">+</span></span>
<span id="cb39-2"><a href="summary-statistics.html#cb39-2"></a><span class="st">  </span><span class="kw">geom_pointrange</span>(</span>
<span id="cb39-3"><a href="summary-statistics.html#cb39-3"></a>      <span class="kw">aes</span>(</span>
<span id="cb39-4"><a href="summary-statistics.html#cb39-4"></a>        <span class="dt">x =</span> spc_latin,</span>
<span id="cb39-5"><a href="summary-statistics.html#cb39-5"></a>        <span class="dt">y =</span> mean_height,</span>
<span id="cb39-6"><a href="summary-statistics.html#cb39-6"></a>        <span class="dt">ymin =</span> mean_height <span class="op">-</span><span class="st"> </span>stdev_height,</span>
<span id="cb39-7"><a href="summary-statistics.html#cb39-7"></a>        <span class="dt">ymax =</span> mean_height <span class="op">+</span><span class="st"> </span>stdev_height</span>
<span id="cb39-8"><a href="summary-statistics.html#cb39-8"></a>      )</span>
<span id="cb39-9"><a href="summary-statistics.html#cb39-9"></a>    ) <span class="op">+</span></span>
<span id="cb39-10"><a href="summary-statistics.html#cb39-10"></a><span class="st">    </span><span class="kw">coord_flip</span>()</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-65-1.png" width="576" /></p>
<p>Cool! Just like that we’ve found (and visualized) the average and standard deviation of tree heights, by species, in NYC. But it doesn’t stop there. We can use <code>group_by()</code> and <code>summarize()</code> on multiple variables (i.e. more groups). We can do this to examine the properties of each tree species in each NYC borough. Let’s check it out.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="summary-statistics.html#cb40-1"></a>ny_trees_by_spc_boro &lt;-<span class="st"> </span><span class="kw">group_by</span>(<span class="dt">.data =</span> ny_trees, spc_latin, boroname)</span>
<span id="cb40-2"><a href="summary-statistics.html#cb40-2"></a>ny_trees_by_spc_boro_summ &lt;-<span class="st"> </span><span class="kw">summarize</span>(<span class="dt">.data =</span> ny_trees_by_spc_boro, <span class="dt">mean_diam =</span> <span class="kw">mean</span>(tree_diameter), <span class="dt">stdev_diam =</span> <span class="kw">sd</span>(tree_diameter))</span>
<span id="cb40-3"><a href="summary-statistics.html#cb40-3"></a>ny_trees_by_spc_boro_summ</span>
<span id="cb40-4"><a href="summary-statistics.html#cb40-4"></a><span class="co">## # A tibble: 48 x 4</span></span>
<span id="cb40-5"><a href="summary-statistics.html#cb40-5"></a><span class="co">##    spc_latin        boroname  mean_diam stdev_diam</span></span>
<span id="cb40-6"><a href="summary-statistics.html#cb40-6"></a><span class="co">##    &lt;chr&gt;            &lt;chr&gt;         &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb40-7"><a href="summary-statistics.html#cb40-7"></a><span class="co">##  1 ACER PLATANOIDES Bronx         13.9        6.74</span></span>
<span id="cb40-8"><a href="summary-statistics.html#cb40-8"></a><span class="co">##  2 ACER PLATANOIDES Brooklyn      15.4       14.9 </span></span>
<span id="cb40-9"><a href="summary-statistics.html#cb40-9"></a><span class="co">##  3 ACER PLATANOIDES Manhattan     11.6        8.45</span></span>
<span id="cb40-10"><a href="summary-statistics.html#cb40-10"></a><span class="co">##  4 ACER PLATANOIDES Queens        15.1       12.9 </span></span>
<span id="cb40-11"><a href="summary-statistics.html#cb40-11"></a><span class="co">##  5 ACER RUBRUM      Bronx         11.4        7.88</span></span>
<span id="cb40-12"><a href="summary-statistics.html#cb40-12"></a><span class="co">##  6 ACER RUBRUM      Brooklyn      10.5        7.41</span></span>
<span id="cb40-13"><a href="summary-statistics.html#cb40-13"></a><span class="co">##  7 ACER RUBRUM      Manhattan      6.63       4.23</span></span>
<span id="cb40-14"><a href="summary-statistics.html#cb40-14"></a><span class="co">##  8 ACER RUBRUM      Queens        14.1        8.36</span></span>
<span id="cb40-15"><a href="summary-statistics.html#cb40-15"></a><span class="co">##  9 ACER SACCHARINUM Bronx         19.7       10.5 </span></span>
<span id="cb40-16"><a href="summary-statistics.html#cb40-16"></a><span class="co">## 10 ACER SACCHARINUM Brooklyn      22.2       10.1 </span></span>
<span id="cb40-17"><a href="summary-statistics.html#cb40-17"></a><span class="co">## # … with 38 more rows</span></span></code></pre></div>
<p>Now we have summary statistics for each tree species within each borough. This is different from the previous plot in that we now have an additional variable (boroname) in our summarized dataset. This additional variable needs to be encoded in our plot. Let’s map boroname to x and facet over tree species, which used to be on x. We’ll also manually modify the theme element <code>strip.text.y</code> to get the species names in a readable position.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="summary-statistics.html#cb41-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ny_trees_by_spc_boro_summ) <span class="op">+</span></span>
<span id="cb41-2"><a href="summary-statistics.html#cb41-2"></a><span class="st">  </span><span class="kw">geom_pointrange</span>(</span>
<span id="cb41-3"><a href="summary-statistics.html#cb41-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb41-4"><a href="summary-statistics.html#cb41-4"></a>      <span class="dt">x =</span> boroname,</span>
<span id="cb41-5"><a href="summary-statistics.html#cb41-5"></a>      <span class="dt">y =</span> mean_diam,</span>
<span id="cb41-6"><a href="summary-statistics.html#cb41-6"></a>      <span class="dt">ymin =</span> mean_diam<span class="op">-</span>stdev_diam,</span>
<span id="cb41-7"><a href="summary-statistics.html#cb41-7"></a>      <span class="dt">ymax =</span> mean_diam<span class="op">+</span>stdev_diam</span>
<span id="cb41-8"><a href="summary-statistics.html#cb41-8"></a>    )</span>
<span id="cb41-9"><a href="summary-statistics.html#cb41-9"></a>  ) <span class="op">+</span></span>
<span id="cb41-10"><a href="summary-statistics.html#cb41-10"></a><span class="st">  </span><span class="kw">facet_grid</span>(spc_latin<span class="op">~</span>.) <span class="op">+</span></span>
<span id="cb41-11"><a href="summary-statistics.html#cb41-11"></a><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></span>
<span id="cb41-12"><a href="summary-statistics.html#cb41-12"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb41-13"><a href="summary-statistics.html#cb41-13"></a>    <span class="dt">strip.text.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>)</span>
<span id="cb41-14"><a href="summary-statistics.html#cb41-14"></a>  )</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-67-1.png" width="576" /></p>
<p>Excellent! And if we really want to go for something pretty:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="summary-statistics.html#cb42-1"></a><span class="kw">library</span>(RColorBrewer)</span>
<span id="cb42-2"><a href="summary-statistics.html#cb42-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ny_trees_by_spc_boro_summ) <span class="op">+</span></span>
<span id="cb42-3"><a href="summary-statistics.html#cb42-3"></a><span class="st">  </span><span class="kw">geom_pointrange</span>(</span>
<span id="cb42-4"><a href="summary-statistics.html#cb42-4"></a>    <span class="kw">aes</span>(</span>
<span id="cb42-5"><a href="summary-statistics.html#cb42-5"></a>      <span class="dt">x =</span> boroname,</span>
<span id="cb42-6"><a href="summary-statistics.html#cb42-6"></a>      <span class="dt">y =</span> mean_diam,</span>
<span id="cb42-7"><a href="summary-statistics.html#cb42-7"></a>      <span class="dt">ymin =</span> mean_diam<span class="op">-</span>stdev_diam,</span>
<span id="cb42-8"><a href="summary-statistics.html#cb42-8"></a>      <span class="dt">ymax =</span> mean_diam<span class="op">+</span>stdev_diam,</span>
<span id="cb42-9"><a href="summary-statistics.html#cb42-9"></a>      <span class="dt">fill =</span> spc_latin</span>
<span id="cb42-10"><a href="summary-statistics.html#cb42-10"></a>    ), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">shape =</span> <span class="dv">21</span></span>
<span id="cb42-11"><a href="summary-statistics.html#cb42-11"></a>  ) <span class="op">+</span></span>
<span id="cb42-12"><a href="summary-statistics.html#cb42-12"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb42-13"><a href="summary-statistics.html#cb42-13"></a>    <span class="dt">x =</span> <span class="st">&quot;Borough&quot;</span>, </span>
<span id="cb42-14"><a href="summary-statistics.html#cb42-14"></a>    <span class="dt">y =</span> <span class="st">&quot;Trunk diameter&quot;</span>,</span>
<span id="cb42-15"><a href="summary-statistics.html#cb42-15"></a>    <span class="dt">caption =</span> <span class="kw">str_wrap</span>(<span class="st">&quot;Figure 1: Diameters of trees in New York City. Points correspond to average diameters of each tree species in each borough. Horizontal lines indicate the standard deviation of tree diameters. Points are colored according to tree species.&quot;</span>, <span class="dt">width =</span> <span class="dv">80</span>)</span>
<span id="cb42-16"><a href="summary-statistics.html#cb42-16"></a>  ) <span class="op">+</span></span>
<span id="cb42-17"><a href="summary-statistics.html#cb42-17"></a><span class="st">  </span><span class="kw">facet_grid</span>(spc_latin<span class="op">~</span>.) <span class="op">+</span></span>
<span id="cb42-18"><a href="summary-statistics.html#cb42-18"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb42-19"><a href="summary-statistics.html#cb42-19"></a><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Paired&quot;</span>) <span class="op">+</span></span>
<span id="cb42-20"><a href="summary-statistics.html#cb42-20"></a><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></span>
<span id="cb42-21"><a href="summary-statistics.html#cb42-21"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb42-22"><a href="summary-statistics.html#cb42-22"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb42-23"><a href="summary-statistics.html#cb42-23"></a>    <span class="dt">strip.text.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>),</span>
<span id="cb42-24"><a href="summary-statistics.html#cb42-24"></a>    <span class="dt">plot.caption =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb42-25"><a href="summary-statistics.html#cb42-25"></a>  )</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-68-1.png" width="576" /></p>
<p><em>Now</em> we are getting somewhere. It looks like there are some really big maple trees (Acer) in Queens.</p>
</div>
<div id="the-pipe" class="section level2">
<h2><span class="header-section-number">8.2</span> The pipe (%&gt;%)</h2>
<p>When we want to get summary statistics for a dataset, we often end up creating lots of new objects, sometimes with convoluted names. For example, what if we want to know and visualize the average temperature across the lakes in each of the three Alaska parks? We might do something like the below:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="summary-statistics.html#cb43-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb43-2"><a href="summary-statistics.html#cb43-2"></a>AK_lakes &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://thebustalab.github.io/R_For_Chemists/sample_data/alaska_lake_data.csv&quot;</span>)</span>
<span id="cb43-3"><a href="summary-statistics.html#cb43-3"></a><span class="co">## Parsed with column specification:</span></span>
<span id="cb43-4"><a href="summary-statistics.html#cb43-4"></a><span class="co">## cols(</span></span>
<span id="cb43-5"><a href="summary-statistics.html#cb43-5"></a><span class="co">##   lake = col_character(),</span></span>
<span id="cb43-6"><a href="summary-statistics.html#cb43-6"></a><span class="co">##   park = col_character(),</span></span>
<span id="cb43-7"><a href="summary-statistics.html#cb43-7"></a><span class="co">##   water_temp = col_double(),</span></span>
<span id="cb43-8"><a href="summary-statistics.html#cb43-8"></a><span class="co">##   pH = col_double(),</span></span>
<span id="cb43-9"><a href="summary-statistics.html#cb43-9"></a><span class="co">##   element = col_character(),</span></span>
<span id="cb43-10"><a href="summary-statistics.html#cb43-10"></a><span class="co">##   mg_per_L = col_double(),</span></span>
<span id="cb43-11"><a href="summary-statistics.html#cb43-11"></a><span class="co">##   element_type = col_character()</span></span>
<span id="cb43-12"><a href="summary-statistics.html#cb43-12"></a><span class="co">## )</span></span>
<span id="cb43-13"><a href="summary-statistics.html#cb43-13"></a><span class="kw">head</span>(AK_lakes)</span>
<span id="cb43-14"><a href="summary-statistics.html#cb43-14"></a><span class="co">## # A tibble: 6 x 7</span></span>
<span id="cb43-15"><a href="summary-statistics.html#cb43-15"></a><span class="co">##   lake                park  water_temp    pH element mg_per_L element_type</span></span>
<span id="cb43-16"><a href="summary-statistics.html#cb43-16"></a><span class="co">##   &lt;chr&gt;               &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;       </span></span>
<span id="cb43-17"><a href="summary-statistics.html#cb43-17"></a><span class="co">## 1 Devil_Mountain_Lake BELA        6.46  7.69 C          3.4   bound       </span></span>
<span id="cb43-18"><a href="summary-statistics.html#cb43-18"></a><span class="co">## 2 Devil_Mountain_Lake BELA        6.46  7.69 N          0.028 bound       </span></span>
<span id="cb43-19"><a href="summary-statistics.html#cb43-19"></a><span class="co">## 3 Devil_Mountain_Lake BELA        6.46  7.69 P          0     bound       </span></span>
<span id="cb43-20"><a href="summary-statistics.html#cb43-20"></a><span class="co">## 4 Devil_Mountain_Lake BELA        6.46  7.69 Cl        10.4   free        </span></span>
<span id="cb43-21"><a href="summary-statistics.html#cb43-21"></a><span class="co">## 5 Devil_Mountain_Lake BELA        6.46  7.69 S          0.62  free        </span></span>
<span id="cb43-22"><a href="summary-statistics.html#cb43-22"></a><span class="co">## 6 Devil_Mountain_Lake BELA        6.46  7.69 F          0.04  free</span></span>
<span id="cb43-23"><a href="summary-statistics.html#cb43-23"></a></span>
<span id="cb43-24"><a href="summary-statistics.html#cb43-24"></a>AK_lakes_by_park &lt;-<span class="st"> </span><span class="kw">group_by</span>(<span class="dt">.data =</span> AK_lakes, park)</span>
<span id="cb43-25"><a href="summary-statistics.html#cb43-25"></a></span>
<span id="cb43-26"><a href="summary-statistics.html#cb43-26"></a>AK_lakes_by_park_summ &lt;-<span class="st"> </span><span class="kw">summarize</span>(<span class="dt">.data =</span> AK_lakes_by_park, <span class="dt">mean_temperature =</span> <span class="kw">mean</span>(water_temp))</span>
<span id="cb43-27"><a href="summary-statistics.html#cb43-27"></a></span>
<span id="cb43-28"><a href="summary-statistics.html#cb43-28"></a><span class="kw">ggplot</span>(AK_lakes_by_park_summ) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> park, <span class="dt">y =</span> mean_temperature))</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-69-1.png" width="576" /></p>
<p>In order to do that, we created two new objects <code>AK_lakes_by_park</code> and <code>AK_lakes_by_park_summ</code>. In big analysis chains, we can end up creating lots of objects with complicated names. There must be a better way! There is. Meet the pipe: <code>%&gt;%</code>. It sends the output from one command directly to the next, so we neither need to have each command create a new object, nor do we need to start each command by telling it what data to use. With the pipe, the same analysis as above can be done with the text below. Neat! Easier!</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="summary-statistics.html#cb44-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb44-2"><a href="summary-statistics.html#cb44-2"></a><span class="kw">read_csv</span>(<span class="st">&quot;https://thebustalab.github.io/R_For_Chemists/sample_data/alaska_lake_data.csv&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb44-3"><a href="summary-statistics.html#cb44-3"></a></span>
<span id="cb44-4"><a href="summary-statistics.html#cb44-4"></a><span class="kw">group_by</span>(park) <span class="op">%&gt;%</span></span>
<span id="cb44-5"><a href="summary-statistics.html#cb44-5"></a></span>
<span id="cb44-6"><a href="summary-statistics.html#cb44-6"></a><span class="kw">summarize</span>(<span class="dt">mean_temperature =</span> <span class="kw">mean</span>(water_temp)) <span class="op">%&gt;%</span></span>
<span id="cb44-7"><a href="summary-statistics.html#cb44-7"></a></span>
<span id="cb44-8"><a href="summary-statistics.html#cb44-8"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> park, <span class="dt">y =</span> mean_temperature))</span>
<span id="cb44-9"><a href="summary-statistics.html#cb44-9"></a><span class="co">## Parsed with column specification:</span></span>
<span id="cb44-10"><a href="summary-statistics.html#cb44-10"></a><span class="co">## cols(</span></span>
<span id="cb44-11"><a href="summary-statistics.html#cb44-11"></a><span class="co">##   lake = col_character(),</span></span>
<span id="cb44-12"><a href="summary-statistics.html#cb44-12"></a><span class="co">##   park = col_character(),</span></span>
<span id="cb44-13"><a href="summary-statistics.html#cb44-13"></a><span class="co">##   water_temp = col_double(),</span></span>
<span id="cb44-14"><a href="summary-statistics.html#cb44-14"></a><span class="co">##   pH = col_double(),</span></span>
<span id="cb44-15"><a href="summary-statistics.html#cb44-15"></a><span class="co">##   element = col_character(),</span></span>
<span id="cb44-16"><a href="summary-statistics.html#cb44-16"></a><span class="co">##   mg_per_L = col_double(),</span></span>
<span id="cb44-17"><a href="summary-statistics.html#cb44-17"></a><span class="co">##   element_type = col_character()</span></span>
<span id="cb44-18"><a href="summary-statistics.html#cb44-18"></a><span class="co">## )</span></span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-70-1.png" width="576" /></p>
</div>
<div id="tidy-data" class="section level2">
<h2><span class="header-section-number">8.3</span> Tidy data</h2>
<p>When we make data tables by hand, it’s often easy to make a <strong>wide-style table</strong> like the following. In it, the abundances of 7 different fatty acids in 10 different species are tabulated. Each fatty acid gets its own row, each species, its own column.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="summary-statistics.html#cb45-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb45-2"><a href="summary-statistics.html#cb45-2"></a>FAs &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://thebustalab.github.io/R_For_Chemists/sample_data/fadb_sample.csv&quot;</span>)</span>
<span id="cb45-3"><a href="summary-statistics.html#cb45-3"></a><span class="co">## Parsed with column specification:</span></span>
<span id="cb45-4"><a href="summary-statistics.html#cb45-4"></a><span class="co">## cols(</span></span>
<span id="cb45-5"><a href="summary-statistics.html#cb45-5"></a><span class="co">##   fatty_acid = col_character(),</span></span>
<span id="cb45-6"><a href="summary-statistics.html#cb45-6"></a><span class="co">##   Agonandra_brasiliensis = col_double(),</span></span>
<span id="cb45-7"><a href="summary-statistics.html#cb45-7"></a><span class="co">##   Agonandra_silvatica = col_double(),</span></span>
<span id="cb45-8"><a href="summary-statistics.html#cb45-8"></a><span class="co">##   Agonandra_excelsa = col_double(),</span></span>
<span id="cb45-9"><a href="summary-statistics.html#cb45-9"></a><span class="co">##   Heisteria_silvianii = col_double(),</span></span>
<span id="cb45-10"><a href="summary-statistics.html#cb45-10"></a><span class="co">##   Malania_oleifera = col_double(),</span></span>
<span id="cb45-11"><a href="summary-statistics.html#cb45-11"></a><span class="co">##   Ximenia_americana = col_double(),</span></span>
<span id="cb45-12"><a href="summary-statistics.html#cb45-12"></a><span class="co">##   Ongokea_gore = col_double(),</span></span>
<span id="cb45-13"><a href="summary-statistics.html#cb45-13"></a><span class="co">##   Comandra_pallida = col_double(),</span></span>
<span id="cb45-14"><a href="summary-statistics.html#cb45-14"></a><span class="co">##   Buckleya_distichophylla = col_double(),</span></span>
<span id="cb45-15"><a href="summary-statistics.html#cb45-15"></a><span class="co">##   Nuytsia_floribunda = col_double()</span></span>
<span id="cb45-16"><a href="summary-statistics.html#cb45-16"></a><span class="co">## )</span></span>
<span id="cb45-17"><a href="summary-statistics.html#cb45-17"></a>FAs</span>
<span id="cb45-18"><a href="summary-statistics.html#cb45-18"></a><span class="co">## # A tibble: 7 x 11</span></span>
<span id="cb45-19"><a href="summary-statistics.html#cb45-19"></a><span class="co">##   fatty_acid Agonandra_brasi… Agonandra_silva… Agonandra_excel…</span></span>
<span id="cb45-20"><a href="summary-statistics.html#cb45-20"></a><span class="co">##   &lt;chr&gt;                 &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb45-21"><a href="summary-statistics.html#cb45-21"></a><span class="co">## 1 Hexadecan…              3.4              1                1.2</span></span>
<span id="cb45-22"><a href="summary-statistics.html#cb45-22"></a><span class="co">## 2 Octadecan…              6.2              0.1              0.4</span></span>
<span id="cb45-23"><a href="summary-statistics.html#cb45-23"></a><span class="co">## 3 Eicosanoi…              4.7              3.5              1.7</span></span>
<span id="cb45-24"><a href="summary-statistics.html#cb45-24"></a><span class="co">## 4 Docosanoi…             77.4              0.4              1  </span></span>
<span id="cb45-25"><a href="summary-statistics.html#cb45-25"></a><span class="co">## 5 Tetracosa…              1.4              1                1.4</span></span>
<span id="cb45-26"><a href="summary-statistics.html#cb45-26"></a><span class="co">## 6 Hexacosan…              1.9             12.6             23.1</span></span>
<span id="cb45-27"><a href="summary-statistics.html#cb45-27"></a><span class="co">## 7 Octacosan…              5               81.4             71.3</span></span>
<span id="cb45-28"><a href="summary-statistics.html#cb45-28"></a><span class="co">## # … with 7 more variables: Heisteria_silvianii &lt;dbl&gt;,</span></span>
<span id="cb45-29"><a href="summary-statistics.html#cb45-29"></a><span class="co">## #   Malania_oleifera &lt;dbl&gt;, Ximenia_americana &lt;dbl&gt;, Ongokea_gore &lt;dbl&gt;,</span></span>
<span id="cb45-30"><a href="summary-statistics.html#cb45-30"></a><span class="co">## #   Comandra_pallida &lt;dbl&gt;, Buckleya_distichophylla &lt;dbl&gt;,</span></span>
<span id="cb45-31"><a href="summary-statistics.html#cb45-31"></a><span class="co">## #   Nuytsia_floribunda &lt;dbl&gt;</span></span></code></pre></div>
<p>While this format is very nice for filling in my hand (such as in a lab notebook or similar), it does not groove with ggplot and other <code>tidyverse</code> functions very well. We need to convert it into a <strong>long-style table</strong>. This is done using <code>pivot_longer()</code>. You can think of this function as transforming both your data’s column names (or some of the column names) and your data matrix’s values (in this case, the measurements) each into their own variables (i.e. columns). We can do this for our fatty acid dataset using the command below. In it, we specify what data we want to transform (<code>data = FAs</code>), we need to tell it what columns we want to transform (<code>cols = 2:11</code>), what we want the new variable that contains column names to be called (<code>names_to = "plant_species"</code>) and what we want the new variable that contains matrix values to be called (<code>values_to = "relative_abundance"</code>). All together now:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="summary-statistics.html#cb46-1"></a><span class="kw">pivot_longer</span>(<span class="dt">data =</span> FAs, <span class="dt">cols =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">11</span>, <span class="dt">names_to =</span> <span class="st">&quot;plant_species&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;relative_abundance&quot;</span>)</span>
<span id="cb46-2"><a href="summary-statistics.html#cb46-2"></a><span class="co">## # A tibble: 70 x 3</span></span>
<span id="cb46-3"><a href="summary-statistics.html#cb46-3"></a><span class="co">##    fatty_acid        plant_species           relative_abundance</span></span>
<span id="cb46-4"><a href="summary-statistics.html#cb46-4"></a><span class="co">##    &lt;chr&gt;             &lt;chr&gt;                                &lt;dbl&gt;</span></span>
<span id="cb46-5"><a href="summary-statistics.html#cb46-5"></a><span class="co">##  1 Hexadecanoic acid Agonandra_brasiliensis                 3.4</span></span>
<span id="cb46-6"><a href="summary-statistics.html#cb46-6"></a><span class="co">##  2 Hexadecanoic acid Agonandra_silvatica                    1  </span></span>
<span id="cb46-7"><a href="summary-statistics.html#cb46-7"></a><span class="co">##  3 Hexadecanoic acid Agonandra_excelsa                      1.2</span></span>
<span id="cb46-8"><a href="summary-statistics.html#cb46-8"></a><span class="co">##  4 Hexadecanoic acid Heisteria_silvianii                    2.9</span></span>
<span id="cb46-9"><a href="summary-statistics.html#cb46-9"></a><span class="co">##  5 Hexadecanoic acid Malania_oleifera                       0.7</span></span>
<span id="cb46-10"><a href="summary-statistics.html#cb46-10"></a><span class="co">##  6 Hexadecanoic acid Ximenia_americana                      3.3</span></span>
<span id="cb46-11"><a href="summary-statistics.html#cb46-11"></a><span class="co">##  7 Hexadecanoic acid Ongokea_gore                           1  </span></span>
<span id="cb46-12"><a href="summary-statistics.html#cb46-12"></a><span class="co">##  8 Hexadecanoic acid Comandra_pallida                       2.3</span></span>
<span id="cb46-13"><a href="summary-statistics.html#cb46-13"></a><span class="co">##  9 Hexadecanoic acid Buckleya_distichophylla                1.6</span></span>
<span id="cb46-14"><a href="summary-statistics.html#cb46-14"></a><span class="co">## 10 Hexadecanoic acid Nuytsia_floribunda                     3.8</span></span>
<span id="cb46-15"><a href="summary-statistics.html#cb46-15"></a><span class="co">## # … with 60 more rows</span></span></code></pre></div>
<p>Brilliant! Now we have a tidy, long-style table that can be used with ggplot.
<!-- end --></p>
<!-- start Exercises 3 -->
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Exercises-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Exercises-3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

</body>

</html>
