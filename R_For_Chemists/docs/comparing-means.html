<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 comparing means | R For Chemists</title>
  <meta name="description" content="Textbook R For Chemists." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 comparing means | R For Chemists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Textbook R For Chemists." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 comparing means | R For Chemists" />
  
  <meta name="twitter:description" content="Textbook R For Chemists." />
  

<meta name="author" content="Lucas Busta" />


<meta name="date" content="2020-11-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Exercises-6.html"/>
<link rel="next" href="exam.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a><ul>
<li class="chapter" data-level="2.1" data-path="installation.html"><a href="installation.html#installing-r"><i class="fa fa-check"></i><b>2.1</b> Installing <code>R</code></a></li>
<li class="chapter" data-level="2.2" data-path="installation.html"><a href="installation.html#installing-rstudio"><i class="fa fa-check"></i><b>2.2</b> Installing <code>RStudio</code></a></li>
<li class="chapter" data-level="2.3" data-path="installation.html"><a href="installation.html#verifying-installations"><i class="fa fa-check"></i><b>2.3</b> Verifying installations</a></li>
<li class="chapter" data-level="2.4" data-path="installation.html"><a href="installation.html#installing-the-tidyverse"><i class="fa fa-check"></i><b>2.4</b> Installing the <code>tidyverse</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="R-Basics.html"><a href="R-Basics.html"><i class="fa fa-check"></i><b>3</b> R Basics</a><ul>
<li class="chapter" data-level="3.1" data-path="R-Basics.html"><a href="R-Basics.html#before-we-start"><i class="fa fa-check"></i><b>3.1</b> Before we start…</a><ul>
<li class="chapter" data-level="3.1.1" data-path="R-Basics.html"><a href="R-Basics.html#help"><i class="fa fa-check"></i><b>3.1.1</b> Help</a></li>
<li class="chapter" data-level="3.1.2" data-path="R-Basics.html"><a href="R-Basics.html#syntax"><i class="fa fa-check"></i><b>3.1.2</b> Syntax</a></li>
<li class="chapter" data-level="3.1.3" data-path="R-Basics.html"><a href="R-Basics.html#paths"><i class="fa fa-check"></i><b>3.1.3</b> Paths</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="R-Basics.html"><a href="R-Basics.html#functions"><i class="fa fa-check"></i><b>3.2</b> Functions</a></li>
<li class="chapter" data-level="3.3" data-path="R-Basics.html"><a href="R-Basics.html#objects"><i class="fa fa-check"></i><b>3.3</b> Objects</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>4</b> ggplot2</a><ul>
<li class="chapter" data-level="4.1" data-path="ggplot2.html"><a href="ggplot2.html#setting-up-a-ggplot"><i class="fa fa-check"></i><b>4.1</b> Setting up a ggplot</a><ul>
<li class="chapter" data-level="4.1.1" data-path="ggplot2.html"><a href="ggplot2.html#step-1-define-the-data-you-want-to-use."><i class="fa fa-check"></i><b>4.1.1</b> Step 1: Define the data you want to use.</a></li>
<li class="chapter" data-level="4.1.2" data-path="ggplot2.html"><a href="ggplot2.html#step-2-define-how-your-variables-map-onto-the-axes."><i class="fa fa-check"></i><b>4.1.2</b> Step 2: Define how your variables map onto the axes.</a></li>
<li class="chapter" data-level="4.1.3" data-path="ggplot2.html"><a href="ggplot2.html#step-3-use-geometric-shapes-to-represent-other-variables-in-your-data."><i class="fa fa-check"></i><b>4.1.3</b> Step 3: Use geometric shapes to represent other variables in your data.</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ggplot2.html"><a href="ggplot2.html#geoms"><i class="fa fa-check"></i><b>4.2</b> Geoms</a><ul>
<li class="chapter" data-level="4.2.1" data-path="ggplot2.html"><a href="ggplot2.html#modifying-geoms"><i class="fa fa-check"></i><b>4.2.1</b> Modifying geoms</a></li>
<li class="chapter" data-level="4.2.2" data-path="ggplot2.html"><a href="ggplot2.html#using-multiple-geoms"><i class="fa fa-check"></i><b>4.2.2</b> Using multiple geoms</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Exercises-1.html"><a href="Exercises-1.html"><i class="fa fa-check"></i><b>5</b> Exercises 1</a><ul>
<li class="chapter" data-level="5.1" data-path="Exercises-1.html"><a href="Exercises-1.html#part-1-algae-chemistry-dataset"><i class="fa fa-check"></i><b>5.1</b> Part 1: Algae Chemistry Dataset</a><ul>
<li class="chapter" data-level="5.1.1" data-path="Exercises-1.html"><a href="Exercises-1.html#question-1-importing-data"><i class="fa fa-check"></i><b>5.1.1</b> Question 1: Importing data</a></li>
<li class="chapter" data-level="5.1.2" data-path="Exercises-1.html"><a href="Exercises-1.html#question-2-dataset-dimensions"><i class="fa fa-check"></i><b>5.1.2</b> Question 2: Dataset dimensions</a></li>
<li class="chapter" data-level="5.1.3" data-path="Exercises-1.html"><a href="Exercises-1.html#question-3-objects"><i class="fa fa-check"></i><b>5.1.3</b> Question 3: Objects</a></li>
<li class="chapter" data-level="5.1.4" data-path="Exercises-1.html"><a href="Exercises-1.html#question-4-filtering"><i class="fa fa-check"></i><b>5.1.4</b> Question 4: Filtering</a></li>
<li class="chapter" data-level="5.1.5" data-path="Exercises-1.html"><a href="Exercises-1.html#question-5-plotting"><i class="fa fa-check"></i><b>5.1.5</b> Question 5: Plotting</a></li>
<li class="chapter" data-level="5.1.6" data-path="Exercises-1.html"><a href="Exercises-1.html#question-6-plotting"><i class="fa fa-check"></i><b>5.1.6</b> Question 6: Plotting</a></li>
<li class="chapter" data-level="5.1.7" data-path="Exercises-1.html"><a href="Exercises-1.html#question-7-filtering-and-plotting"><i class="fa fa-check"></i><b>5.1.7</b> Question 7: Filtering and plotting</a></li>
<li class="chapter" data-level="5.1.8" data-path="Exercises-1.html"><a href="Exercises-1.html#question-8-filtering-and-plotting"><i class="fa fa-check"></i><b>5.1.8</b> Question 8: Filtering and plotting</a></li>
<li class="chapter" data-level="5.1.9" data-path="Exercises-1.html"><a href="Exercises-1.html#question-9-open-ended-plotting"><i class="fa fa-check"></i><b>5.1.9</b> Question 9: Open-ended plotting</a></li>
<li class="chapter" data-level="5.1.10" data-path="Exercises-1.html"><a href="Exercises-1.html#question-10-a-peek-at-whats-to-come"><i class="fa fa-check"></i><b>5.1.10</b> Question 10: A peek at what’s to come…</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="Exercises-1.html"><a href="Exercises-1.html#part-2-alaska-lakes-dataset"><i class="fa fa-check"></i><b>5.2</b> Part 2: Alaska Lakes Dataset</a><ul>
<li class="chapter" data-level="5.2.1" data-path="Exercises-1.html"><a href="Exercises-1.html#question-1-importing-data-1"><i class="fa fa-check"></i><b>5.2.1</b> Question 1: Importing Data</a></li>
<li class="chapter" data-level="5.2.2" data-path="Exercises-1.html"><a href="Exercises-1.html#question-2-objects"><i class="fa fa-check"></i><b>5.2.2</b> Question 2: Objects</a></li>
<li class="chapter" data-level="5.2.3" data-path="Exercises-1.html"><a href="Exercises-1.html#question-3-filtering"><i class="fa fa-check"></i><b>5.2.3</b> Question 3: Filtering</a></li>
<li class="chapter" data-level="5.2.4" data-path="Exercises-1.html"><a href="Exercises-1.html#question-4-plotting"><i class="fa fa-check"></i><b>5.2.4</b> Question 4: Plotting</a></li>
<li class="chapter" data-level="5.2.5" data-path="Exercises-1.html"><a href="Exercises-1.html#question-5-plotting-1"><i class="fa fa-check"></i><b>5.2.5</b> Question 5: Plotting</a></li>
<li class="chapter" data-level="5.2.6" data-path="Exercises-1.html"><a href="Exercises-1.html#question-6-filtering-and-plotting"><i class="fa fa-check"></i><b>5.2.6</b> Question 6: Filtering and Plotting</a></li>
<li class="chapter" data-level="5.2.7" data-path="Exercises-1.html"><a href="Exercises-1.html#question-7-filtering-and-plotting-1"><i class="fa fa-check"></i><b>5.2.7</b> Question 7: Filtering and Plotting</a></li>
<li class="chapter" data-level="5.2.8" data-path="Exercises-1.html"><a href="Exercises-1.html#question-8-open-ended-plotting"><i class="fa fa-check"></i><b>5.2.8</b> Question 8: Open-ended Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html"><i class="fa fa-check"></i><b>6</b> geoms, facets, scales, themes</a><ul>
<li class="chapter" data-level="6.1" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#geoms-1"><i class="fa fa-check"></i><b>6.1</b> Geoms</a></li>
<li class="chapter" data-level="6.2" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#facets"><i class="fa fa-check"></i><b>6.2</b> Facets</a></li>
<li class="chapter" data-level="6.3" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#scales"><i class="fa fa-check"></i><b>6.3</b> Scales</a><ul>
<li class="chapter" data-level="6.3.1" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#rcolorbrewer"><i class="fa fa-check"></i><b>6.3.1</b> RColorBrewer</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#themes"><i class="fa fa-check"></i><b>6.4</b> Themes</a><ul>
<li class="chapter" data-level="6.4.1" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#complete-themes"><i class="fa fa-check"></i><b>6.4.1</b> Complete themes</a></li>
<li class="chapter" data-level="6.4.2" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#theme-components"><i class="fa fa-check"></i><b>6.4.2</b> Theme components</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Exercises-2.html"><a href="Exercises-2.html"><i class="fa fa-check"></i><b>7</b> Exercises 2</a><ul>
<li class="chapter" data-level="7.1" data-path="Exercises-2.html"><a href="Exercises-2.html#question-1"><i class="fa fa-check"></i><b>7.1</b> Question 1</a></li>
<li class="chapter" data-level="7.2" data-path="Exercises-2.html"><a href="Exercises-2.html#question-2"><i class="fa fa-check"></i><b>7.2</b> Question 2</a></li>
<li class="chapter" data-level="7.3" data-path="Exercises-2.html"><a href="Exercises-2.html#question-3"><i class="fa fa-check"></i><b>7.3</b> Question 3</a></li>
<li class="chapter" data-level="7.4" data-path="Exercises-2.html"><a href="Exercises-2.html#question-4"><i class="fa fa-check"></i><b>7.4</b> Question 4</a></li>
<li class="chapter" data-level="7.5" data-path="Exercises-2.html"><a href="Exercises-2.html#question-5"><i class="fa fa-check"></i><b>7.5</b> Question 5</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>8</b> Summary Statistics</a><ul>
<li class="chapter" data-level="8.1" data-path="summary-statistics.html"><a href="summary-statistics.html#summary-statistics"><i class="fa fa-check"></i><b>8.1</b> Summary statistics</a></li>
<li class="chapter" data-level="8.2" data-path="summary-statistics.html"><a href="summary-statistics.html#the-pipe"><i class="fa fa-check"></i><b>8.2</b> The pipe (%&gt;%)</a></li>
<li class="chapter" data-level="8.3" data-path="summary-statistics.html"><a href="summary-statistics.html#tidy-data"><i class="fa fa-check"></i><b>8.3</b> Tidy data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Exercises-3.html"><a href="Exercises-3.html"><i class="fa fa-check"></i><b>9</b> Exercises 3</a><ul>
<li class="chapter" data-level="9.1" data-path="Exercises-3.html"><a href="Exercises-3.html#question-1-1"><i class="fa fa-check"></i><b>9.1</b> Question 1</a></li>
<li class="chapter" data-level="9.2" data-path="Exercises-3.html"><a href="Exercises-3.html#question-2-1"><i class="fa fa-check"></i><b>9.2</b> Question 2</a></li>
<li class="chapter" data-level="9.3" data-path="Exercises-3.html"><a href="Exercises-3.html#question-3-1"><i class="fa fa-check"></i><b>9.3</b> Question 3</a></li>
<li class="chapter" data-level="9.4" data-path="Exercises-3.html"><a href="Exercises-3.html#question-4-1"><i class="fa fa-check"></i><b>9.4</b> Question 4</a></li>
<li class="chapter" data-level="9.5" data-path="Exercises-3.html"><a href="Exercises-3.html#question-5-1"><i class="fa fa-check"></i><b>9.5</b> Question 5</a></li>
<li class="chapter" data-level="9.6" data-path="Exercises-3.html"><a href="Exercises-3.html#question-6"><i class="fa fa-check"></i><b>9.6</b> Question 6</a></li>
<li class="chapter" data-level="9.7" data-path="Exercises-3.html"><a href="Exercises-3.html#question-7"><i class="fa fa-check"></i><b>9.7</b> Question 7</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Clustering.html"><a href="Clustering.html"><i class="fa fa-check"></i><b>10</b> Clustering</a></li>
<li class="chapter" data-level="11" data-path="Exercises-4.html"><a href="Exercises-4.html"><i class="fa fa-check"></i><b>11</b> Exercises 4</a></li>
<li class="chapter" data-level="12" data-path="PCA.html"><a href="PCA.html"><i class="fa fa-check"></i><b>12</b> PCA</a><ul>
<li class="chapter" data-level="12.1" data-path="PCA.html"><a href="PCA.html#pca"><i class="fa fa-check"></i><b>12.1</b> PCA</a></li>
<li class="chapter" data-level="12.2" data-path="PCA.html"><a href="PCA.html#drivers-of-pca-dimensions"><i class="fa fa-check"></i><b>12.2</b> Drivers of PCA dimensions</a></li>
<li class="chapter" data-level="12.3" data-path="PCA.html"><a href="PCA.html#comparing-principal-components"><i class="fa fa-check"></i><b>12.3</b> Comparing principal components</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="Exercises-5.html"><a href="Exercises-5.html"><i class="fa fa-check"></i><b>13</b> Exercises 5</a><ul>
<li class="chapter" data-level="13.1" data-path="Exercises-5.html"><a href="Exercises-5.html#option-1-human-metabolomics."><i class="fa fa-check"></i><b>13.1</b> Option 1: Human metabolomics.</a></li>
<li class="chapter" data-level="13.2" data-path="Exercises-5.html"><a href="Exercises-5.html#option-2-grape-vine-varieties"><i class="fa fa-check"></i><b>13.2</b> Option 2: Grape vine varieties</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="k-means.html"><a href="k-means.html"><i class="fa fa-check"></i><b>14</b> k-means</a></li>
<li class="chapter" data-level="15" data-path="Exercises-6.html"><a href="Exercises-6.html"><i class="fa fa-check"></i><b>15</b> Exercises 6</a><ul>
<li class="chapter" data-level="15.1" data-path="Exercises-6.html"><a href="Exercises-6.html#question-1-2"><i class="fa fa-check"></i><b>15.1</b> Question 1</a></li>
<li class="chapter" data-level="15.2" data-path="Exercises-6.html"><a href="Exercises-6.html#question-2-2"><i class="fa fa-check"></i><b>15.2</b> Question 2</a></li>
<li class="chapter" data-level="15.3" data-path="Exercises-6.html"><a href="Exercises-6.html#question-3-2"><i class="fa fa-check"></i><b>15.3</b> Question 3</a></li>
<li class="chapter" data-level="15.4" data-path="Exercises-6.html"><a href="Exercises-6.html#question-4-2"><i class="fa fa-check"></i><b>15.4</b> Question 4</a></li>
<li class="chapter" data-level="15.5" data-path="Exercises-6.html"><a href="Exercises-6.html#question-5-2"><i class="fa fa-check"></i><b>15.5</b> Question 5</a></li>
<li class="chapter" data-level="15.6" data-path="Exercises-6.html"><a href="Exercises-6.html#question-6-1"><i class="fa fa-check"></i><b>15.6</b> Question 6</a></li>
<li class="chapter" data-level="15.7" data-path="Exercises-6.html"><a href="Exercises-6.html#question-7-1"><i class="fa fa-check"></i><b>15.7</b> Question 7</a></li>
<li class="chapter" data-level="15.8" data-path="Exercises-6.html"><a href="Exercises-6.html#challenge-optional"><i class="fa fa-check"></i><b>15.8</b> Challenge (optional)</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="comparing-means.html"><a href="comparing-means.html"><i class="fa fa-check"></i><b>16</b> comparing means</a><ul>
<li class="chapter" data-level="16.1" data-path="comparing-means.html"><a href="comparing-means.html#the-p-value"><i class="fa fa-check"></i><b>16.1</b> The p value</a></li>
<li class="chapter" data-level="16.2" data-path="comparing-means.html"><a href="comparing-means.html#two-means"><i class="fa fa-check"></i><b>16.2</b> Two means</a></li>
<li class="chapter" data-level="16.3" data-path="comparing-means.html"><a href="comparing-means.html#more-than-two-means"><i class="fa fa-check"></i><b>16.3</b> More than two means</a><ul>
<li class="chapter" data-level="16.3.1" data-path="comparing-means.html"><a href="comparing-means.html#anova-tukey-tests"><i class="fa fa-check"></i><b>16.3.1</b> ANOVA, Tukey tests</a></li>
<li class="chapter" data-level="16.3.2" data-path="comparing-means.html"><a href="comparing-means.html#kruskal-dunn-tests"><i class="fa fa-check"></i><b>16.3.2</b> Kruskal, Dunn tests</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="comparing-means.html"><a href="comparing-means.html#further-reading"><i class="fa fa-check"></i><b>16.4</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="exam.html"><a href="exam.html"><i class="fa fa-check"></i><b>17</b> Exam</a><ul>
<li class="chapter" data-level="17.1" data-path="exam.html"><a href="exam.html#data-set-1-beer_components"><i class="fa fa-check"></i><b>17.1</b> Data set 1: beer_components</a><ul>
<li class="chapter" data-level="17.1.1" data-path="exam.html"><a href="exam.html#question-1-3"><i class="fa fa-check"></i><b>17.1.1</b> Question 1:</a></li>
<li class="chapter" data-level="17.1.2" data-path="exam.html"><a href="exam.html#question-2-3"><i class="fa fa-check"></i><b>17.1.2</b> Question 2:</a></li>
<li class="chapter" data-level="17.1.3" data-path="exam.html"><a href="exam.html#question-3-3"><i class="fa fa-check"></i><b>17.1.3</b> Question 3:</a></li>
<li class="chapter" data-level="17.1.4" data-path="exam.html"><a href="exam.html#question-4-3"><i class="fa fa-check"></i><b>17.1.4</b> Question 4:</a></li>
<li class="chapter" data-level="17.1.5" data-path="exam.html"><a href="exam.html#question-5-3"><i class="fa fa-check"></i><b>17.1.5</b> Question 5:</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="exam.html"><a href="exam.html#data-set-2-hops_components"><i class="fa fa-check"></i><b>17.2</b> Data set 2: hops_components</a><ul>
<li class="chapter" data-level="17.2.1" data-path="exam.html"><a href="exam.html#question-1-4"><i class="fa fa-check"></i><b>17.2.1</b> Question 1</a></li>
<li class="chapter" data-level="17.2.2" data-path="exam.html"><a href="exam.html#question-2-4"><i class="fa fa-check"></i><b>17.2.2</b> Question 2:</a></li>
<li class="chapter" data-level="17.2.3" data-path="exam.html"><a href="exam.html#question-3-4"><i class="fa fa-check"></i><b>17.2.3</b> Question 3:</a></li>
<li class="chapter" data-level="17.2.4" data-path="exam.html"><a href="exam.html#question-4-4"><i class="fa fa-check"></i><b>17.2.4</b> Question 4:</a></li>
<li class="chapter" data-level="17.2.5" data-path="exam.html"><a href="exam.html#question-5-4"><i class="fa fa-check"></i><b>17.2.5</b> Question 5:</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="datasets.html"><a href="datasets.html"><i class="fa fa-check"></i><b>A</b> Datasets</a><ul>
<li class="chapter" data-level="A.1" data-path="datasets.html"><a href="datasets.html#hawaii_aquifers"><i class="fa fa-check"></i><b>A.1</b> hawaii_aquifers</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="functions-1.html"><a href="functions-1.html"><i class="fa fa-check"></i><b>B</b> Functions</a><ul>
<li class="chapter" data-level="B.1" data-path="functions-1.html"><a href="functions-1.html#libraries-and-packages"><i class="fa fa-check"></i><b>B.1</b> Libraries and packages</a><ul>
<li class="chapter" data-level="B.1.1" data-path="functions-1.html"><a href="functions-1.html#install.packages"><i class="fa fa-check"></i><b>B.1.1</b> <code>install.packages()</code></a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="functions-1.html"><a href="functions-1.html#operators"><i class="fa fa-check"></i><b>B.2</b> Operators</a><ul>
<li class="chapter" data-level="B.2.1" data-path="functions-1.html"><a href="functions-1.html#in"><i class="fa fa-check"></i><b>B.2.1</b> <code>%in%</code></a></li>
<li class="chapter" data-level="B.2.2" data-path="functions-1.html"><a href="functions-1.html#section"><i class="fa fa-check"></i><b>B.2.2</b> &lt;</a></li>
<li class="chapter" data-level="B.2.3" data-path="functions-1.html"><a href="functions-1.html#section-1"><i class="fa fa-check"></i><b>B.2.3</b> &lt;=</a></li>
<li class="chapter" data-level="B.2.4" data-path="functions-1.html"><a href="functions-1.html#section-2"><i class="fa fa-check"></i><b>B.2.4</b> &gt;</a></li>
<li class="chapter" data-level="B.2.5" data-path="functions-1.html"><a href="functions-1.html#section-3"><i class="fa fa-check"></i><b>B.2.5</b> &gt;=</a></li>
<li class="chapter" data-level="B.2.6" data-path="functions-1.html"><a href="functions-1.html#section-4"><i class="fa fa-check"></i><b>B.2.6</b> ==</a></li>
<li class="chapter" data-level="B.2.7" data-path="functions-1.html"><a href="functions-1.html#section-5"><i class="fa fa-check"></i><b>B.2.7</b> !=</a></li>
<li class="chapter" data-level="B.2.8" data-path="functions-1.html"><a href="functions-1.html#section-6"><i class="fa fa-check"></i><b>B.2.8</b> |</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="functions-1.html"><a href="functions-1.html#data-wrangling"><i class="fa fa-check"></i><b>B.3</b> Data wrangling</a><ul>
<li class="chapter" data-level="B.3.1" data-path="functions-1.html"><a href="functions-1.html#read_csv"><i class="fa fa-check"></i><b>B.3.1</b> <code>read_csv()</code></a></li>
<li class="chapter" data-level="B.3.2" data-path="functions-1.html"><a href="functions-1.html#read.csv"><i class="fa fa-check"></i><b>B.3.2</b> <code>read.csv()</code></a></li>
<li class="chapter" data-level="B.3.3" data-path="functions-1.html"><a href="functions-1.html#readcsv"><i class="fa fa-check"></i><b>B.3.3</b> <code>readCSV()</code></a></li>
<li class="chapter" data-level="B.3.4" data-path="functions-1.html"><a href="functions-1.html#head"><i class="fa fa-check"></i><b>B.3.4</b> <code>head()</code></a></li>
<li class="chapter" data-level="B.3.5" data-path="functions-1.html"><a href="functions-1.html#filter"><i class="fa fa-check"></i><b>B.3.5</b> <code>filter()</code></a></li>
<li class="chapter" data-level="B.3.6" data-path="functions-1.html"><a href="functions-1.html#mutate"><i class="fa fa-check"></i><b>B.3.6</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="B.3.7" data-path="functions-1.html"><a href="functions-1.html#case_when"><i class="fa fa-check"></i><b>B.3.7</b> <code>case_when()</code></a></li>
<li class="chapter" data-level="B.3.8" data-path="functions-1.html"><a href="functions-1.html#pivot_longer"><i class="fa fa-check"></i><b>B.3.8</b> <code>pivot_longer()</code></a></li>
<li class="chapter" data-level="B.3.9" data-path="functions-1.html"><a href="functions-1.html#group_by"><i class="fa fa-check"></i><b>B.3.9</b> <code>group_by()</code></a></li>
<li class="chapter" data-level="B.3.10" data-path="functions-1.html"><a href="functions-1.html#summarize"><i class="fa fa-check"></i><b>B.3.10</b> <code>summarize()</code></a></li>
<li class="chapter" data-level="B.3.11" data-path="functions-1.html"><a href="functions-1.html#section-7"><i class="fa fa-check"></i><b>B.3.11</b> <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="functions-1.html"><a href="functions-1.html#plotting"><i class="fa fa-check"></i><b>B.4</b> Plotting</a><ul>
<li class="chapter" data-level="B.4.1" data-path="functions-1.html"><a href="functions-1.html#plot"><i class="fa fa-check"></i><b>B.4.1</b> <code>plot()</code></a></li>
<li class="chapter" data-level="B.4.2" data-path="functions-1.html"><a href="functions-1.html#ggplot2ggplot"><i class="fa fa-check"></i><b>B.4.2</b> <code>ggplot2::ggplot()</code></a></li>
<li class="chapter" data-level="B.4.3" data-path="functions-1.html"><a href="functions-1.html#ggplot2aes"><i class="fa fa-check"></i><b>B.4.3</b> <code>ggplot2::aes()</code></a></li>
<li class="chapter" data-level="B.4.4" data-path="functions-1.html"><a href="functions-1.html#ggplot2geom_"><i class="fa fa-check"></i><b>B.4.4</b> <code>ggplot2::geom_*()</code></a></li>
<li class="chapter" data-level="B.4.5" data-path="functions-1.html"><a href="functions-1.html#ggplot2facet_grid"><i class="fa fa-check"></i><b>B.4.5</b> <code>ggplot2::facet_grid()</code></a></li>
<li class="chapter" data-level="B.4.6" data-path="functions-1.html"><a href="functions-1.html#ggplot2scale__"><i class="fa fa-check"></i><b>B.4.6</b> <code>ggplot2::scale_*_*()</code></a></li>
<li class="chapter" data-level="B.4.7" data-path="functions-1.html"><a href="functions-1.html#ggplot2theme_"><i class="fa fa-check"></i><b>B.4.7</b> <code>ggplot2::theme_*()</code></a></li>
<li class="chapter" data-level="B.4.8" data-path="functions-1.html"><a href="functions-1.html#ggplot2coord_flip"><i class="fa fa-check"></i><b>B.4.8</b> <code>ggplot2::coord_flip()</code></a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="functions-1.html"><a href="functions-1.html#statistics"><i class="fa fa-check"></i><b>B.5</b> Statistics</a><ul>
<li class="chapter" data-level="B.5.1" data-path="functions-1.html"><a href="functions-1.html#mean"><i class="fa fa-check"></i><b>B.5.1</b> <code>mean()</code></a></li>
<li class="chapter" data-level="B.5.2" data-path="functions-1.html"><a href="functions-1.html#sd"><i class="fa fa-check"></i><b>B.5.2</b> <code>sd()</code></a></li>
<li class="chapter" data-level="B.5.3" data-path="functions-1.html"><a href="functions-1.html#table"><i class="fa fa-check"></i><b>B.5.3</b> <code>table()</code></a></li>
<li class="chapter" data-level="B.5.4" data-path="functions-1.html"><a href="functions-1.html#weighted.mean"><i class="fa fa-check"></i><b>B.5.4</b> <code>weighted.mean()</code></a></li>
</ul></li>
<li class="chapter" data-level="B.6" data-path="functions-1.html"><a href="functions-1.html#t.test"><i class="fa fa-check"></i><b>B.6</b> t.test()</a></li>
<li class="chapter" data-level="B.7" data-path="functions-1.html"><a href="functions-1.html#anova"><i class="fa fa-check"></i><b>B.7</b> anova()</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="custom-functions.html"><a href="custom-functions.html"><i class="fa fa-check"></i><b>C</b> Custom functions</a><ul>
<li class="chapter" data-level="C.1" data-path="custom-functions.html"><a href="custom-functions.html#activating-custom-functions"><i class="fa fa-check"></i><b>C.1</b> Activating custom functions</a></li>
<li class="chapter" data-level="C.2" data-path="custom-functions.html"><a href="custom-functions.html#basic-runmatrixanalysis-template"><i class="fa fa-check"></i><b>C.2</b> Basic <code>runMatrixAnalysis()</code> template</a></li>
<li class="chapter" data-level="C.3" data-path="custom-functions.html"><a href="custom-functions.html#advanced-runmatrixanalysis-template"><i class="fa fa-check"></i><b>C.3</b> Advanced <code>runMatrixAnalysis()</code> template</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>D</b> FAQ</a><ul>
<li class="chapter" data-level="D.1" data-path="faq.html"><a href="faq.html#filtering"><i class="fa fa-check"></i><b>D.1</b> Filtering</a></li>
<li class="chapter" data-level="D.2" data-path="faq.html"><a href="faq.html#order-categorical-axes"><i class="fa fa-check"></i><b>D.2</b> Order categorical axes</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="pca-and-big-data.html"><a href="pca-and-big-data.html"><i class="fa fa-check"></i><b>E</b> PCA and Big Data</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R For Chemists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="comparing-means" class="section level1">
<h1><span class="header-section-number">Chapter 16</span> comparing means</h1>
<p>Often, we want to know if our study subjects contain different amounts of certain analytes. For example, “Does this lake over here contain more potassium than that lake over there?” For this, we need statistical tests. Here, we will have a look at comparing mean values for analyte abundance in situations with two samples and in situations with more than two samples.</p>
<p>To run these statistical analyses, we will need several new R packages: <code>rstatix</code>, <code>agricolae</code>, and <code>multcompView</code>. Please install these with <code>install.packages("rstatix")</code>, <code>install.packages("agricolae")</code>, and <code>install.packages("multcompView")</code>. Load them into your R session using <code>library(rstatix)</code>, <code>library(agricolae)</code>, and <code>library(multcompView)</code>.</p>
<div id="the-p-value" class="section level2">
<h2><span class="header-section-number">16.1</span> The p value</h2>
<p>“The p value represents the probability of getting data as extreme as our results if the null hypothesis is true.”</p>
<p>In other words - the p value is the probability that we would observe the differences we did, if in fact there were no differences in the means at all.</p>
<p><img src="http://thebustalab.github.io/R_For_Chemists/figures/stats.png" style="display: block; margin: auto;" /></p>
</div>
<div id="two-means" class="section level2">
<h2><span class="header-section-number">16.2</span> Two means</h2>
<p>When we are comparing two means, we need to first determine what kind of statistical test we can use on our data. If (i) our data can be modelled by a normal distribution and (ii) the variances about the two means are similar, then we can use a more powerful test (i.e. a test that will be more likely to detect a difference in means, assuming one exists).</p>
<p>We can check our data for normality and similar variances using the Shapiro test and the Levene test. Let’s use the <code>hawaii_aquifers</code> data as an example, and let’s consider only the element potassium:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="comparing-means.html#cb74-1"></a><span class="kw">source</span>(<span class="st">&quot;https://thebustalab.github.io/R_For_Chemists/custom_functions/chem.R&quot;</span>)</span>
<span id="cb74-2"><a href="comparing-means.html#cb74-2"></a>K_data &lt;-<span class="st"> </span>hawaii_aquifers <span class="op">%&gt;%</span></span>
<span id="cb74-3"><a href="comparing-means.html#cb74-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(analyte <span class="op">==</span><span class="st"> &quot;K&quot;</span>)</span>
<span id="cb74-4"><a href="comparing-means.html#cb74-4"></a>  K_data</span>
<span id="cb74-5"><a href="comparing-means.html#cb74-5"></a><span class="co">## # A tibble: 110 x 6</span></span>
<span id="cb74-6"><a href="comparing-means.html#cb74-6"></a><span class="co">##    aquifer_code well_name              longitude latitude analyte abundance</span></span>
<span id="cb74-7"><a href="comparing-means.html#cb74-7"></a><span class="co">##    &lt;chr&gt;        &lt;chr&gt;                      &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;</span></span>
<span id="cb74-8"><a href="comparing-means.html#cb74-8"></a><span class="co">##  1 aquifer_1    Alewa_Heights_Spring         NA      NA   K             0.6</span></span>
<span id="cb74-9"><a href="comparing-means.html#cb74-9"></a><span class="co">##  2 aquifer_1    Beretania_High_Service       NA      NA   K             3.1</span></span>
<span id="cb74-10"><a href="comparing-means.html#cb74-10"></a><span class="co">##  3 aquifer_1    Beretania_Low_Service        NA      NA   K             3.6</span></span>
<span id="cb74-11"><a href="comparing-means.html#cb74-11"></a><span class="co">##  4 aquifer_1    Kuliouou_Well              -158.     21.3 K             3.9</span></span>
<span id="cb74-12"><a href="comparing-means.html#cb74-12"></a><span class="co">##  5 aquifer_1    Manoa_Well_II              -158.     21.3 K             0.6</span></span>
<span id="cb74-13"><a href="comparing-means.html#cb74-13"></a><span class="co">##  6 aquifer_1    Moanalua_Wells_Pump_1      -158.     21.4 K             2.9</span></span>
<span id="cb74-14"><a href="comparing-means.html#cb74-14"></a><span class="co">##  7 aquifer_1    Moanalua_Wells_Pump_2      -158.     21.4 K             2.8</span></span>
<span id="cb74-15"><a href="comparing-means.html#cb74-15"></a><span class="co">##  8 aquifer_1    Moanalua_Wells_Pump_3      -158.     21.4 K             3.4</span></span>
<span id="cb74-16"><a href="comparing-means.html#cb74-16"></a><span class="co">##  9 aquifer_1    Nuuanu_Aerator_Well        -158.     21.4 K             0.4</span></span>
<span id="cb74-17"><a href="comparing-means.html#cb74-17"></a><span class="co">## 10 aquifer_1    Palolo_Tunnel              -158.     21.3 K             0.7</span></span>
<span id="cb74-18"><a href="comparing-means.html#cb74-18"></a><span class="co">## # … with 100 more rows</span></span></code></pre></div>
<p>To work with two means, let’s just look at aquifers 1 and 6:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="comparing-means.html#cb75-1"></a>K_data_<span class="dv">1</span>_<span class="dv">2</span> &lt;-<span class="st"> </span>K_data <span class="op">%&gt;%</span></span>
<span id="cb75-2"><a href="comparing-means.html#cb75-2"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">filter</span>(aquifer_code <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;aquifer_1&quot;</span>, <span class="st">&quot;aquifer_6&quot;</span>))</span>
<span id="cb75-3"><a href="comparing-means.html#cb75-3"></a></span>
<span id="cb75-4"><a href="comparing-means.html#cb75-4"></a>K_data_<span class="dv">1</span>_<span class="dv">2</span></span>
<span id="cb75-5"><a href="comparing-means.html#cb75-5"></a><span class="co">## # A tibble: 24 x 6</span></span>
<span id="cb75-6"><a href="comparing-means.html#cb75-6"></a><span class="co">##    aquifer_code well_name              longitude latitude analyte abundance</span></span>
<span id="cb75-7"><a href="comparing-means.html#cb75-7"></a><span class="co">##    &lt;chr&gt;        &lt;chr&gt;                      &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;</span></span>
<span id="cb75-8"><a href="comparing-means.html#cb75-8"></a><span class="co">##  1 aquifer_1    Alewa_Heights_Spring         NA      NA   K             0.6</span></span>
<span id="cb75-9"><a href="comparing-means.html#cb75-9"></a><span class="co">##  2 aquifer_1    Beretania_High_Service       NA      NA   K             3.1</span></span>
<span id="cb75-10"><a href="comparing-means.html#cb75-10"></a><span class="co">##  3 aquifer_1    Beretania_Low_Service        NA      NA   K             3.6</span></span>
<span id="cb75-11"><a href="comparing-means.html#cb75-11"></a><span class="co">##  4 aquifer_1    Kuliouou_Well              -158.     21.3 K             3.9</span></span>
<span id="cb75-12"><a href="comparing-means.html#cb75-12"></a><span class="co">##  5 aquifer_1    Manoa_Well_II              -158.     21.3 K             0.6</span></span>
<span id="cb75-13"><a href="comparing-means.html#cb75-13"></a><span class="co">##  6 aquifer_1    Moanalua_Wells_Pump_1      -158.     21.4 K             2.9</span></span>
<span id="cb75-14"><a href="comparing-means.html#cb75-14"></a><span class="co">##  7 aquifer_1    Moanalua_Wells_Pump_2      -158.     21.4 K             2.8</span></span>
<span id="cb75-15"><a href="comparing-means.html#cb75-15"></a><span class="co">##  8 aquifer_1    Moanalua_Wells_Pump_3      -158.     21.4 K             3.4</span></span>
<span id="cb75-16"><a href="comparing-means.html#cb75-16"></a><span class="co">##  9 aquifer_1    Nuuanu_Aerator_Well        -158.     21.4 K             0.4</span></span>
<span id="cb75-17"><a href="comparing-means.html#cb75-17"></a><span class="co">## 10 aquifer_1    Palolo_Tunnel              -158.     21.3 K             0.7</span></span>
<span id="cb75-18"><a href="comparing-means.html#cb75-18"></a><span class="co">## # … with 14 more rows</span></span>
<span id="cb75-19"><a href="comparing-means.html#cb75-19"></a></span>
<span id="cb75-20"><a href="comparing-means.html#cb75-20"></a><span class="kw">ggplot</span>(K_data_<span class="dv">1</span>_<span class="dv">2</span>, <span class="kw">aes</span>(<span class="dt">x =</span> aquifer_code, <span class="dt">y =</span> abundance)) <span class="op">+</span></span>
<span id="cb75-21"><a href="comparing-means.html#cb75-21"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb75-22"><a href="comparing-means.html#cb75-22"></a><span class="st">    </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-124-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Are these data normally distributed? Do they have similar variance? Let’s get a first approximation by looking at a plot:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="comparing-means.html#cb76-1"></a>K_data_<span class="dv">1</span>_<span class="dv">2</span> <span class="op">%&gt;%</span></span>
<span id="cb76-2"><a href="comparing-means.html#cb76-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> abundance)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb76-3"><a href="comparing-means.html#cb76-3"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">30</span>) <span class="op">+</span></span>
<span id="cb76-4"><a href="comparing-means.html#cb76-4"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>aquifer_code) <span class="op">+</span></span>
<span id="cb76-5"><a href="comparing-means.html#cb76-5"></a><span class="st">    </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..<span class="op">*</span><span class="dv">10</span>), <span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-125-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Based on this graphic, it’s hard to say! Let’s use a statistical test to help. When we want to run the Shaprio test, we are looking to see if each group has normally distributed here (here group is “aquifer_code”, i.e. aquifer_1 and aquifer_6). This means we need to <code>group_by(aquifer_code)</code> before we run the test:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="comparing-means.html#cb77-1"></a>K_data_<span class="dv">1</span>_<span class="dv">2</span> <span class="op">%&gt;%</span></span>
<span id="cb77-2"><a href="comparing-means.html#cb77-2"></a><span class="st">  </span><span class="kw">group_by</span>(aquifer_code) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-3"><a href="comparing-means.html#cb77-3"></a><span class="st">  </span><span class="kw">shapiro_test</span>(abundance)</span>
<span id="cb77-4"><a href="comparing-means.html#cb77-4"></a><span class="co">## # A tibble: 2 x 4</span></span>
<span id="cb77-5"><a href="comparing-means.html#cb77-5"></a><span class="co">##   aquifer_code variable  statistic     p</span></span>
<span id="cb77-6"><a href="comparing-means.html#cb77-6"></a><span class="co">##   &lt;chr&gt;        &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb77-7"><a href="comparing-means.html#cb77-7"></a><span class="co">## 1 aquifer_1    abundance     0.885 0.102</span></span>
<span id="cb77-8"><a href="comparing-means.html#cb77-8"></a><span class="co">## 2 aquifer_6    abundance     0.914 0.239</span></span></code></pre></div>
<p>Both p-values are above 0.05! This means that the distributions are not significantly different from a normal distribution. What about the variances about the two means? Are they similar? For this we need a Levene test. With that test, we are not looking within each group, but rather across groups - this means we do NOT need to <code>group_by(aquifer_code)</code> and should specify a <code>y ~ x</code> formula instead:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="comparing-means.html#cb78-1"></a>K_data_<span class="dv">1</span>_<span class="dv">2</span> <span class="op">%&gt;%</span></span>
<span id="cb78-2"><a href="comparing-means.html#cb78-2"></a><span class="st">  </span><span class="kw">levene_test</span>(abundance <span class="op">~</span><span class="st"> </span>aquifer_code)</span>
<span id="cb78-3"><a href="comparing-means.html#cb78-3"></a><span class="co">## # A tibble: 1 x 4</span></span>
<span id="cb78-4"><a href="comparing-means.html#cb78-4"></a><span class="co">##     df1   df2 statistic     p</span></span>
<span id="cb78-5"><a href="comparing-means.html#cb78-5"></a><span class="co">##   &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb78-6"><a href="comparing-means.html#cb78-6"></a><span class="co">## 1     1    22     0.289 0.596</span></span></code></pre></div>
<p>The p-value from this test is 0.596! This means that their variances are not significantly different. Now, since our data passed both test, this means we can use a normal t-test. A t-test is a parametric test. This means that it relies on modelling the data using a normal distribution in order to make comparisons. It is also a powerful test. This means that it is likely to detect a difference in means, assuming one is present. Let’s try it out:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="comparing-means.html#cb79-1"></a>K_data_<span class="dv">1</span>_<span class="dv">2</span> <span class="op">%&gt;%</span></span>
<span id="cb79-2"><a href="comparing-means.html#cb79-2"></a><span class="st">  </span><span class="kw">t_test</span>(abundance <span class="op">~</span><span class="st"> </span>aquifer_code)</span>
<span id="cb79-3"><a href="comparing-means.html#cb79-3"></a><span class="co">## # A tibble: 1 x 8</span></span>
<span id="cb79-4"><a href="comparing-means.html#cb79-4"></a><span class="co">##   .y.       group1    group2       n1    n2 statistic    df      p</span></span>
<span id="cb79-5"><a href="comparing-means.html#cb79-5"></a><span class="co">##   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;     &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb79-6"><a href="comparing-means.html#cb79-6"></a><span class="co">## 1 abundance aquifer_1 aquifer_6    12    12     -2.75  20.5 0.0121</span></span></code></pre></div>
<p>A p-value of 0.012! This is below 0.05, meaning that there is a 95% chance that the two means are different. Suppose that our data had not passed the Shapiro and/or Levene tests. We would then need to use a Wilcox test. The Wilcox test is a non-parametric test, which means that it does not use a normal distribution to model the data in order to make comparisons. This means that is a less powerful test than the t-test, which means that it is less likely to detect a difference in the means, assuming there is one. For fun, let’s try that one out and compare the p-values from the two methods:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="comparing-means.html#cb80-1"></a>K_data_<span class="dv">1</span>_<span class="dv">2</span> <span class="op">%&gt;%</span></span>
<span id="cb80-2"><a href="comparing-means.html#cb80-2"></a><span class="st">  </span><span class="kw">wilcox_test</span>(abundance <span class="op">~</span><span class="st"> </span>aquifer_code)</span>
<span id="cb80-3"><a href="comparing-means.html#cb80-3"></a><span class="co">## # A tibble: 1 x 7</span></span>
<span id="cb80-4"><a href="comparing-means.html#cb80-4"></a><span class="co">##   .y.       group1    group2       n1    n2 statistic      p</span></span>
<span id="cb80-5"><a href="comparing-means.html#cb80-5"></a><span class="co">##   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;     &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb80-6"><a href="comparing-means.html#cb80-6"></a><span class="co">## 1 abundance aquifer_1 aquifer_6    12    12      33.5 0.0282</span></span></code></pre></div>
<p>A p-value of 0.028! This is higher than the value given by the t-test (0.012). That is because the Wilcox test is a less powerful test: it is less likely to detect differences in means, assuming they exist.</p>
</div>
<div id="more-than-two-means" class="section level2">
<h2><span class="header-section-number">16.3</span> More than two means</h2>
<p>In the previous section we compared two means. What if we want to compare means from more than two study subjects? The first step is again to determine which tests to use. Let’s consider our hawaii aquifer data again, though this time let’s use all the aquifers, not just two:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="comparing-means.html#cb81-1"></a>K_data &lt;-<span class="st"> </span>hawaii_aquifers <span class="op">%&gt;%</span></span>
<span id="cb81-2"><a href="comparing-means.html#cb81-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(analyte <span class="op">==</span><span class="st"> &quot;K&quot;</span>)</span>
<span id="cb81-3"><a href="comparing-means.html#cb81-3"></a></span>
<span id="cb81-4"><a href="comparing-means.html#cb81-4"></a>K_data</span>
<span id="cb81-5"><a href="comparing-means.html#cb81-5"></a><span class="co">## # A tibble: 110 x 6</span></span>
<span id="cb81-6"><a href="comparing-means.html#cb81-6"></a><span class="co">##    aquifer_code well_name              longitude latitude analyte abundance</span></span>
<span id="cb81-7"><a href="comparing-means.html#cb81-7"></a><span class="co">##    &lt;chr&gt;        &lt;chr&gt;                      &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;</span></span>
<span id="cb81-8"><a href="comparing-means.html#cb81-8"></a><span class="co">##  1 aquifer_1    Alewa_Heights_Spring         NA      NA   K             0.6</span></span>
<span id="cb81-9"><a href="comparing-means.html#cb81-9"></a><span class="co">##  2 aquifer_1    Beretania_High_Service       NA      NA   K             3.1</span></span>
<span id="cb81-10"><a href="comparing-means.html#cb81-10"></a><span class="co">##  3 aquifer_1    Beretania_Low_Service        NA      NA   K             3.6</span></span>
<span id="cb81-11"><a href="comparing-means.html#cb81-11"></a><span class="co">##  4 aquifer_1    Kuliouou_Well              -158.     21.3 K             3.9</span></span>
<span id="cb81-12"><a href="comparing-means.html#cb81-12"></a><span class="co">##  5 aquifer_1    Manoa_Well_II              -158.     21.3 K             0.6</span></span>
<span id="cb81-13"><a href="comparing-means.html#cb81-13"></a><span class="co">##  6 aquifer_1    Moanalua_Wells_Pump_1      -158.     21.4 K             2.9</span></span>
<span id="cb81-14"><a href="comparing-means.html#cb81-14"></a><span class="co">##  7 aquifer_1    Moanalua_Wells_Pump_2      -158.     21.4 K             2.8</span></span>
<span id="cb81-15"><a href="comparing-means.html#cb81-15"></a><span class="co">##  8 aquifer_1    Moanalua_Wells_Pump_3      -158.     21.4 K             3.4</span></span>
<span id="cb81-16"><a href="comparing-means.html#cb81-16"></a><span class="co">##  9 aquifer_1    Nuuanu_Aerator_Well        -158.     21.4 K             0.4</span></span>
<span id="cb81-17"><a href="comparing-means.html#cb81-17"></a><span class="co">## 10 aquifer_1    Palolo_Tunnel              -158.     21.3 K             0.7</span></span>
<span id="cb81-18"><a href="comparing-means.html#cb81-18"></a><span class="co">## # … with 100 more rows</span></span>
<span id="cb81-19"><a href="comparing-means.html#cb81-19"></a></span>
<span id="cb81-20"><a href="comparing-means.html#cb81-20"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> K_data, <span class="kw">aes</span>(<span class="dt">x =</span> aquifer_code, <span class="dt">y =</span> abundance)) <span class="op">+</span></span>
<span id="cb81-21"><a href="comparing-means.html#cb81-21"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb81-22"><a href="comparing-means.html#cb81-22"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;maroon&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-130-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Let’s check visually to see if each group is normally distributed and to see if they have roughly equal variance:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="comparing-means.html#cb82-1"></a>K_data <span class="op">%&gt;%</span></span>
<span id="cb82-2"><a href="comparing-means.html#cb82-2"></a><span class="st">  </span><span class="kw">group_by</span>(aquifer_code) <span class="op">%&gt;%</span></span>
<span id="cb82-3"><a href="comparing-means.html#cb82-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> abundance)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb82-4"><a href="comparing-means.html#cb82-4"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">30</span>) <span class="op">+</span></span>
<span id="cb82-5"><a href="comparing-means.html#cb82-5"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>aquifer_code) <span class="op">+</span></span>
<span id="cb82-6"><a href="comparing-means.html#cb82-6"></a><span class="st">    </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..<span class="op">*</span><span class="dv">10</span>), <span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-131-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Again, it is somewhat hard to tell visually if these data are normally distributed. It seems pretty likely that they have different variances about the means, but let’s check using the Shapiro and Levene tests. Don’t forget: with the Shaprio test, we are looking within each group and so need to <code>group_by()</code>, with the Levene test, we are looking across groups, and so need to provide a <code>y~x</code> formula:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="comparing-means.html#cb83-1"></a>K_data <span class="op">%&gt;%</span></span>
<span id="cb83-2"><a href="comparing-means.html#cb83-2"></a><span class="st">  </span><span class="kw">group_by</span>(aquifer_code) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb83-3"><a href="comparing-means.html#cb83-3"></a><span class="st">  </span><span class="kw">shapiro_test</span>(abundance)</span>
<span id="cb83-4"><a href="comparing-means.html#cb83-4"></a><span class="co">## # A tibble: 10 x 4</span></span>
<span id="cb83-5"><a href="comparing-means.html#cb83-5"></a><span class="co">##    aquifer_code variable  statistic          p</span></span>
<span id="cb83-6"><a href="comparing-means.html#cb83-6"></a><span class="co">##    &lt;chr&gt;        &lt;chr&gt;         &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb83-7"><a href="comparing-means.html#cb83-7"></a><span class="co">##  1 aquifer_1    abundance     0.885 0.102     </span></span>
<span id="cb83-8"><a href="comparing-means.html#cb83-8"></a><span class="co">##  2 aquifer_10   abundance     0.864 0.163     </span></span>
<span id="cb83-9"><a href="comparing-means.html#cb83-9"></a><span class="co">##  3 aquifer_2    abundance     0.913 0.459     </span></span>
<span id="cb83-10"><a href="comparing-means.html#cb83-10"></a><span class="co">##  4 aquifer_3    abundance     0.893 0.363     </span></span>
<span id="cb83-11"><a href="comparing-means.html#cb83-11"></a><span class="co">##  5 aquifer_4    abundance     0.948 0.421     </span></span>
<span id="cb83-12"><a href="comparing-means.html#cb83-12"></a><span class="co">##  6 aquifer_5    abundance     0.902 0.421     </span></span>
<span id="cb83-13"><a href="comparing-means.html#cb83-13"></a><span class="co">##  7 aquifer_6    abundance     0.914 0.239     </span></span>
<span id="cb83-14"><a href="comparing-means.html#cb83-14"></a><span class="co">##  8 aquifer_7    abundance     0.915 0.355     </span></span>
<span id="cb83-15"><a href="comparing-means.html#cb83-15"></a><span class="co">##  9 aquifer_8    abundance     0.842 0.220     </span></span>
<span id="cb83-16"><a href="comparing-means.html#cb83-16"></a><span class="co">## 10 aquifer_9    abundance     0.786 0.00000866</span></span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="comparing-means.html#cb84-1"></a>K_data <span class="op">%&gt;%</span></span>
<span id="cb84-2"><a href="comparing-means.html#cb84-2"></a><span class="st">  </span><span class="kw">levene_test</span>(abundance <span class="op">~</span><span class="st"> </span>aquifer_code)</span>
<span id="cb84-3"><a href="comparing-means.html#cb84-3"></a><span class="co">## # A tibble: 1 x 4</span></span>
<span id="cb84-4"><a href="comparing-means.html#cb84-4"></a><span class="co">##     df1   df2 statistic       p</span></span>
<span id="cb84-5"><a href="comparing-means.html#cb84-5"></a><span class="co">##   &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb84-6"><a href="comparing-means.html#cb84-6"></a><span class="co">## 1     9   100      3.12 0.00239</span></span></code></pre></div>
<p>Based on these tests, it looks like the data for aquifer 9 is significantly different from a normal distribution (Shaprio test p = 0.000008), and the means are certainly different from one another (Levene test p = 0.002).</p>
<p>Let’s assume for a second that our data passed these tests. This means that we could reasonably model our data with normal distributions and use a parametric test to compare means. This means that we can use an ANOVA to test for differences in means.</p>
<div id="anova-tukey-tests" class="section level3">
<h3><span class="header-section-number">16.3.1</span> ANOVA, Tukey tests</h3>
<p>We will use the <code>anova_test</code> function from the package <code>rstatix</code>. It will tell us if any of the means in the data are statistically different from one another. However, if there are differences between the means, it will not tell us which of them are different.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="comparing-means.html#cb85-1"></a>K_data <span class="op">%&gt;%</span></span>
<span id="cb85-2"><a href="comparing-means.html#cb85-2"></a><span class="st">  </span><span class="kw">anova_test</span>(abundance <span class="op">~</span><span class="st"> </span>aquifer_code)</span>
<span id="cb85-3"><a href="comparing-means.html#cb85-3"></a><span class="co">## Coefficient covariances computed by hccm()</span></span>
<span id="cb85-4"><a href="comparing-means.html#cb85-4"></a><span class="co">## # A tibble: 1 x 7</span></span>
<span id="cb85-5"><a href="comparing-means.html#cb85-5"></a><span class="co">##   Effect         DFn   DFd     F        p `p&lt;.05`   ges</span></span>
<span id="cb85-6"><a href="comparing-means.html#cb85-6"></a><span class="co">##   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;</span></span>
<span id="cb85-7"><a href="comparing-means.html#cb85-7"></a><span class="co">## 1 aquifer_code     9   100  10.0 7.72e-11 *       0.474</span></span></code></pre></div>
<p>A p-value of 7.7e-11! There are definitely some significant differences among this group. But, WHICH are different from one another though? For this, we need to run Tukey’s Honest Significant Difference test (implemented using <code>tukey_hsd</code>). This will essentially run t-test on all the pairs of study subjects that we can derive from our data set (in this example, aquifer_1 vs. aquifer_2, aquifer_1 vs. aquifer_3, etc.). After that, it will correct the p-values according to the number of comparisons that it performed. This controls the rate of type I error that we can expect from the test. These corrected values are provided to us in the <code>p.adj</code> column.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="comparing-means.html#cb86-1"></a>K_data <span class="op">%&gt;%</span></span>
<span id="cb86-2"><a href="comparing-means.html#cb86-2"></a><span class="st">  </span><span class="kw">tukey_hsd</span>(abundance <span class="op">~</span><span class="st"> </span>aquifer_code)</span>
<span id="cb86-3"><a href="comparing-means.html#cb86-3"></a><span class="co">## # A tibble: 45 x 9</span></span>
<span id="cb86-4"><a href="comparing-means.html#cb86-4"></a><span class="co">##    term  group1 group2 null.value estimate conf.low conf.high   p.adj</span></span>
<span id="cb86-5"><a href="comparing-means.html#cb86-5"></a><span class="co">##    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb86-6"><a href="comparing-means.html#cb86-6"></a><span class="co">##  1 aqui… aquif… aquif…          0  0.00357   -2.00      2.01  1.00e+0</span></span>
<span id="cb86-7"><a href="comparing-means.html#cb86-7"></a><span class="co">##  2 aqui… aquif… aquif…          0  1.44      -0.668     3.55  4.56e-1</span></span>
<span id="cb86-8"><a href="comparing-means.html#cb86-8"></a><span class="co">##  3 aqui… aquif… aquif…          0  0.375     -2.35      3.10  1.00e+0</span></span>
<span id="cb86-9"><a href="comparing-means.html#cb86-9"></a><span class="co">##  4 aqui… aquif… aquif…          0 -1.15      -2.75      0.437 3.68e-1</span></span>
<span id="cb86-10"><a href="comparing-means.html#cb86-10"></a><span class="co">##  5 aqui… aquif… aquif…          0 -0.845     -3.09      1.40  9.68e-1</span></span>
<span id="cb86-11"><a href="comparing-means.html#cb86-11"></a><span class="co">##  6 aqui… aquif… aquif…          0  1.98       0.261     3.71  1.15e-2</span></span>
<span id="cb86-12"><a href="comparing-means.html#cb86-12"></a><span class="co">##  7 aqui… aquif… aquif…          0  2.70       0.837     4.56  3.56e-4</span></span>
<span id="cb86-13"><a href="comparing-means.html#cb86-13"></a><span class="co">##  8 aqui… aquif… aquif…          0 -0.125     -2.85      2.60  1.00e+0</span></span>
<span id="cb86-14"><a href="comparing-means.html#cb86-14"></a><span class="co">##  9 aqui… aquif… aquif…          0 -0.378     -1.78      1.03  9.97e-1</span></span>
<span id="cb86-15"><a href="comparing-means.html#cb86-15"></a><span class="co">## 10 aqui… aquif… aquif…          0  1.44      -0.910     3.79  6.13e-1</span></span>
<span id="cb86-16"><a href="comparing-means.html#cb86-16"></a><span class="co">## # … with 35 more rows, and 1 more variable: p.adj.signif &lt;chr&gt;</span></span></code></pre></div>
<p>Using the output from our tukey test, we can determine which means are similar. We can do this using the p_groups function:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="comparing-means.html#cb87-1"></a><span class="kw">source</span>(<span class="st">&quot;https://thebustalab.github.io/R_For_Chemists/custom_functions/chem.R&quot;</span>)</span>
<span id="cb87-2"><a href="comparing-means.html#cb87-2"></a>groups_based_on_tukey &lt;-<span class="st"> </span>K_data <span class="op">%&gt;%</span></span>
<span id="cb87-3"><a href="comparing-means.html#cb87-3"></a><span class="st">  </span><span class="kw">tukey_hsd</span>(abundance <span class="op">~</span><span class="st"> </span>aquifer_code) <span class="op">%&gt;%</span></span>
<span id="cb87-4"><a href="comparing-means.html#cb87-4"></a><span class="st">  </span><span class="kw">p_groups</span>()</span>
<span id="cb87-5"><a href="comparing-means.html#cb87-5"></a>groups_based_on_tukey</span>
<span id="cb87-6"><a href="comparing-means.html#cb87-6"></a><span class="co">## # A tibble: 10 x 3</span></span>
<span id="cb87-7"><a href="comparing-means.html#cb87-7"></a><span class="co">##    treatment  group spaced_group</span></span>
<span id="cb87-8"><a href="comparing-means.html#cb87-8"></a><span class="co">##    &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;       </span></span>
<span id="cb87-9"><a href="comparing-means.html#cb87-9"></a><span class="co">##  1 aquifer_1  ab    &quot;ab  &quot;      </span></span>
<span id="cb87-10"><a href="comparing-means.html#cb87-10"></a><span class="co">##  2 aquifer_10 abc   &quot;abc &quot;      </span></span>
<span id="cb87-11"><a href="comparing-means.html#cb87-11"></a><span class="co">##  3 aquifer_2  acd   &quot;a cd&quot;      </span></span>
<span id="cb87-12"><a href="comparing-means.html#cb87-12"></a><span class="co">##  4 aquifer_3  abcd  &quot;abcd&quot;      </span></span>
<span id="cb87-13"><a href="comparing-means.html#cb87-13"></a><span class="co">##  5 aquifer_4  b     &quot; b  &quot;      </span></span>
<span id="cb87-14"><a href="comparing-means.html#cb87-14"></a><span class="co">##  6 aquifer_5  ab    &quot;ab  &quot;      </span></span>
<span id="cb87-15"><a href="comparing-means.html#cb87-15"></a><span class="co">##  7 aquifer_6  cd    &quot;  cd&quot;      </span></span>
<span id="cb87-16"><a href="comparing-means.html#cb87-16"></a><span class="co">##  8 aquifer_7  d     &quot;   d&quot;      </span></span>
<span id="cb87-17"><a href="comparing-means.html#cb87-17"></a><span class="co">##  9 aquifer_8  abc   &quot;abc &quot;      </span></span>
<span id="cb87-18"><a href="comparing-means.html#cb87-18"></a><span class="co">## 10 aquifer_9  ab    &quot;ab  &quot;</span></span></code></pre></div>
<p>We can use the output from <code>p_groups</code> to annotate our plot:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="comparing-means.html#cb88-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> K_data, <span class="kw">aes</span>(<span class="dt">x =</span> aquifer_code, <span class="dt">y =</span> abundance)) <span class="op">+</span></span>
<span id="cb88-2"><a href="comparing-means.html#cb88-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb88-3"><a href="comparing-means.html#cb88-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;maroon&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb88-4"><a href="comparing-means.html#cb88-4"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> groups_based_on_tukey, <span class="kw">aes</span>(<span class="dt">x =</span> treatment, <span class="dt">y =</span> <span class="dv">9</span>, <span class="dt">label =</span> group))</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-137-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Excellent! This plot shows us, using the letters above each aquifer, which means are the same and which are different. If a letter is shared among the labels above two aquifers, it means that their means do not differ significantly. For example, aquifer 2 and aquifer 6 both have “b” in their labels, so their means are not different - and are the same as those of aquifers 3 and 10.</p>
</div>
<div id="kruskal-dunn-tests" class="section level3">
<h3><span class="header-section-number">16.3.2</span> Kruskal, Dunn tests</h3>
<p>The above ANOVA example is great, but remember - our data did not pass the Shapiro or Levene tests. This means not all our data can be modelled by a normal distribution and taht we need to use a non-parametric test. The non-parametric alternative to the ANOVA is called the Kruskal test. Like the Wilcox test, it is less powerful that its parametric relative, meaning that it is less likely to detected differences, should they exist. However, since our data do not pass the Shapiro/Levene tests, we have to resort to the Kruskal test. Let’s try it out:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="comparing-means.html#cb89-1"></a>K_data <span class="op">%&gt;%</span></span>
<span id="cb89-2"><a href="comparing-means.html#cb89-2"></a><span class="st">  </span><span class="kw">kruskal_test</span>(abundance <span class="op">~</span><span class="st"> </span>aquifer_code)</span>
<span id="cb89-3"><a href="comparing-means.html#cb89-3"></a><span class="co">## # A tibble: 1 x 6</span></span>
<span id="cb89-4"><a href="comparing-means.html#cb89-4"></a><span class="co">##   .y.           n statistic    df            p method        </span></span>
<span id="cb89-5"><a href="comparing-means.html#cb89-5"></a><span class="co">##   &lt;chr&gt;     &lt;int&gt;     &lt;dbl&gt; &lt;int&gt;        &lt;dbl&gt; &lt;chr&gt;         </span></span>
<span id="cb89-6"><a href="comparing-means.html#cb89-6"></a><span class="co">## 1 abundance   110      57.7     9 0.0000000037 Kruskal-Wallis</span></span></code></pre></div>
<p>A p-value of 3.9e-9! This is higher than the p-value from running ANOVA on the same data (remember, the Kruskal test is less powerful). Never the less, the value is still well below 0.05, meaning that some of the means are different. So, how do we determine WHICH are different from one another? When we ran ANOVA the follow-up test (the post hoc test) was Tukey’s HSD. After the Kruskal test, the post hoc test we use is the Dunn test. Let’s try:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="comparing-means.html#cb90-1"></a>K_data <span class="op">%&gt;%</span></span>
<span id="cb90-2"><a href="comparing-means.html#cb90-2"></a><span class="st">  </span><span class="kw">dunn_test</span>(abundance <span class="op">~</span><span class="st"> </span>aquifer_code)</span>
<span id="cb90-3"><a href="comparing-means.html#cb90-3"></a><span class="co">## # A tibble: 45 x 9</span></span>
<span id="cb90-4"><a href="comparing-means.html#cb90-4"></a><span class="co">##    .y.      group1    group2      n1    n2 statistic       p  p.adj p.adj.signif</span></span>
<span id="cb90-5"><a href="comparing-means.html#cb90-5"></a><span class="co">##    &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;    &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;       </span></span>
<span id="cb90-6"><a href="comparing-means.html#cb90-6"></a><span class="co">##  1 abundan… aquifer_1 aquifer…    12     7    -0.205 0.838   1      ns          </span></span>
<span id="cb90-7"><a href="comparing-means.html#cb90-7"></a><span class="co">##  2 abundan… aquifer_1 aquifer…    12     6     2.25  0.0242  0.702  ns          </span></span>
<span id="cb90-8"><a href="comparing-means.html#cb90-8"></a><span class="co">##  3 abundan… aquifer_1 aquifer…    12     3     0.911 0.362   1      ns          </span></span>
<span id="cb90-9"><a href="comparing-means.html#cb90-9"></a><span class="co">##  4 abundan… aquifer_1 aquifer…    12    17    -2.70  0.00702 0.232  ns          </span></span>
<span id="cb90-10"><a href="comparing-means.html#cb90-10"></a><span class="co">##  5 abundan… aquifer_1 aquifer…    12     5    -1.15  0.252   1      ns          </span></span>
<span id="cb90-11"><a href="comparing-means.html#cb90-11"></a><span class="co">##  6 abundan… aquifer_1 aquifer…    12    12     2.53  0.0113  0.351  ns          </span></span>
<span id="cb90-12"><a href="comparing-means.html#cb90-12"></a><span class="co">##  7 abundan… aquifer_1 aquifer…    12     9     3.02  0.00254 0.0967 ns          </span></span>
<span id="cb90-13"><a href="comparing-means.html#cb90-13"></a><span class="co">##  8 abundan… aquifer_1 aquifer…    12     3     0.182 0.855   1      ns          </span></span>
<span id="cb90-14"><a href="comparing-means.html#cb90-14"></a><span class="co">##  9 abundan… aquifer_1 aquifer…    12    36    -0.518 0.605   1      ns          </span></span>
<span id="cb90-15"><a href="comparing-means.html#cb90-15"></a><span class="co">## 10 abundan… aquifer_… aquifer…     7     6     2.20  0.0278  0.777  ns          </span></span>
<span id="cb90-16"><a href="comparing-means.html#cb90-16"></a><span class="co">## # … with 35 more rows</span></span></code></pre></div>
<p>This gives us adjusted p-values for all pairwise comparisons. Once again, we can use <code>p_groups()</code> to give us a compact letter display for each group, which can then be used to annotate the plot:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="comparing-means.html#cb91-1"></a>groups_based_on_tukey &lt;-<span class="st"> </span>K_data <span class="op">%&gt;%</span></span>
<span id="cb91-2"><a href="comparing-means.html#cb91-2"></a><span class="st">  </span><span class="kw">dunn_test</span>(abundance <span class="op">~</span><span class="st"> </span>aquifer_code) <span class="op">%&gt;%</span></span>
<span id="cb91-3"><a href="comparing-means.html#cb91-3"></a><span class="st">  </span><span class="kw">p_groups</span>()</span>
<span id="cb91-4"><a href="comparing-means.html#cb91-4"></a>groups_based_on_tukey</span>
<span id="cb91-5"><a href="comparing-means.html#cb91-5"></a><span class="co">## # A tibble: 10 x 3</span></span>
<span id="cb91-6"><a href="comparing-means.html#cb91-6"></a><span class="co">##    treatment  group spaced_group</span></span>
<span id="cb91-7"><a href="comparing-means.html#cb91-7"></a><span class="co">##    &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;       </span></span>
<span id="cb91-8"><a href="comparing-means.html#cb91-8"></a><span class="co">##  1 aquifer_1  abcd  &quot;abcd&quot;      </span></span>
<span id="cb91-9"><a href="comparing-means.html#cb91-9"></a><span class="co">##  2 aquifer_10 abcd  &quot;abcd&quot;      </span></span>
<span id="cb91-10"><a href="comparing-means.html#cb91-10"></a><span class="co">##  3 aquifer_2  abc   &quot;abc &quot;      </span></span>
<span id="cb91-11"><a href="comparing-means.html#cb91-11"></a><span class="co">##  4 aquifer_3  abcd  &quot;abcd&quot;      </span></span>
<span id="cb91-12"><a href="comparing-means.html#cb91-12"></a><span class="co">##  5 aquifer_4  d     &quot;   d&quot;      </span></span>
<span id="cb91-13"><a href="comparing-means.html#cb91-13"></a><span class="co">##  6 aquifer_5  acd   &quot;a cd&quot;      </span></span>
<span id="cb91-14"><a href="comparing-means.html#cb91-14"></a><span class="co">##  7 aquifer_6  ab    &quot;ab  &quot;      </span></span>
<span id="cb91-15"><a href="comparing-means.html#cb91-15"></a><span class="co">##  8 aquifer_7  b     &quot; b  &quot;      </span></span>
<span id="cb91-16"><a href="comparing-means.html#cb91-16"></a><span class="co">##  9 aquifer_8  abcd  &quot;abcd&quot;      </span></span>
<span id="cb91-17"><a href="comparing-means.html#cb91-17"></a><span class="co">## 10 aquifer_9  cd    &quot;  cd&quot;</span></span>
<span id="cb91-18"><a href="comparing-means.html#cb91-18"></a></span>
<span id="cb91-19"><a href="comparing-means.html#cb91-19"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> K_data, <span class="kw">aes</span>(<span class="dt">x =</span> aquifer_code, <span class="dt">y =</span> abundance)) <span class="op">+</span></span>
<span id="cb91-20"><a href="comparing-means.html#cb91-20"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb91-21"><a href="comparing-means.html#cb91-21"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;maroon&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb91-22"><a href="comparing-means.html#cb91-22"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> groups_based_on_tukey, <span class="kw">aes</span>(<span class="dt">x =</span> treatment, <span class="dt">y =</span> <span class="dv">9</span>, <span class="dt">label =</span> group))</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-140-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Note that these groupings are different from those generated by ANOVA/Tukey.</p>
</div>
</div>
<div id="further-reading" class="section level2">
<h2><span class="header-section-number">16.4</span> Further reading</h2>
<p>For more on comparing multiple means in R: <a href="https://www.datanovia.com/en/courses/comparing-multiple-means-in-r/">www.datanovia.com</a></p>
<p>For more on parametric versus non-parametric tests: <a href="https://statisticsbyjim.com/hypothesis-testing/nonparametric-parametric-tests/">Statistics by Jim</a></p>
<!-- end -->
<!-- start Exam -->
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Exercises-6.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exam.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

</body>

</html>
