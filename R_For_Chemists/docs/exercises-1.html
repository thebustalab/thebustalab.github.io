<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Exercises 1 | R For Chemists</title>
  <meta name="description" content="Textbook R For Chemists." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Exercises 1 | R For Chemists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Textbook R For Chemists." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Exercises 1 | R For Chemists" />
  
  <meta name="twitter:description" content="Textbook R For Chemists." />
  

<meta name="author" content="Lucas Busta" />


<meta name="date" content="2020-09-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Visualization-1.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a><ul>
<li class="chapter" data-level="2.1" data-path="installation.html"><a href="installation.html#installing-r"><i class="fa fa-check"></i><b>2.1</b> Installing <code>R</code></a></li>
<li class="chapter" data-level="2.2" data-path="installation.html"><a href="installation.html#installing-rstudio"><i class="fa fa-check"></i><b>2.2</b> Installing <code>RStudio</code></a></li>
<li class="chapter" data-level="2.3" data-path="installation.html"><a href="installation.html#verifying-installations"><i class="fa fa-check"></i><b>2.3</b> Verifying installations</a></li>
<li class="chapter" data-level="2.4" data-path="installation.html"><a href="installation.html#installing-the-tidyverse"><i class="fa fa-check"></i><b>2.4</b> Installing the <code>tidyverse</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="R-Basics-1.html"><a href="R-Basics-1.html"><i class="fa fa-check"></i><b>3</b> R Basics 1</a><ul>
<li class="chapter" data-level="3.1" data-path="R-Basics-1.html"><a href="R-Basics-1.html#before-we-start"><i class="fa fa-check"></i><b>3.1</b> Before we start…</a><ul>
<li class="chapter" data-level="3.1.1" data-path="R-Basics-1.html"><a href="R-Basics-1.html#help"><i class="fa fa-check"></i><b>3.1.1</b> Help</a></li>
<li class="chapter" data-level="3.1.2" data-path="R-Basics-1.html"><a href="R-Basics-1.html#syntax"><i class="fa fa-check"></i><b>3.1.2</b> Syntax</a></li>
<li class="chapter" data-level="3.1.3" data-path="R-Basics-1.html"><a href="R-Basics-1.html#paths"><i class="fa fa-check"></i><b>3.1.3</b> Paths</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="R-Basics-1.html"><a href="R-Basics-1.html#functions"><i class="fa fa-check"></i><b>3.2</b> Functions</a></li>
<li class="chapter" data-level="3.3" data-path="R-Basics-1.html"><a href="R-Basics-1.html#objects"><i class="fa fa-check"></i><b>3.3</b> Objects</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Visualization-1.html"><a href="Visualization-1.html"><i class="fa fa-check"></i><b>4</b> Visualization 1</a><ul>
<li class="chapter" data-level="4.1" data-path="Visualization-1.html"><a href="Visualization-1.html#setting-up-a-ggplot"><i class="fa fa-check"></i><b>4.1</b> Setting up a ggplot</a><ul>
<li class="chapter" data-level="4.1.1" data-path="Visualization-1.html"><a href="Visualization-1.html#step-1-define-the-data-you-want-to-use."><i class="fa fa-check"></i><b>4.1.1</b> Step 1: Define the data you want to use.</a></li>
<li class="chapter" data-level="4.1.2" data-path="Visualization-1.html"><a href="Visualization-1.html#step-2-define-how-your-variables-map-onto-the-axes."><i class="fa fa-check"></i><b>4.1.2</b> Step 2: Define how your variables map onto the axes.</a></li>
<li class="chapter" data-level="4.1.3" data-path="Visualization-1.html"><a href="Visualization-1.html#step-3-use-geometric-shapes-to-represent-other-variables-in-your-data."><i class="fa fa-check"></i><b>4.1.3</b> Step 3: Use geometric shapes to represent other variables in your data.</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="Visualization-1.html"><a href="Visualization-1.html#geoms"><i class="fa fa-check"></i><b>4.2</b> Geoms</a><ul>
<li class="chapter" data-level="4.2.1" data-path="Visualization-1.html"><a href="Visualization-1.html#modifying-geoms"><i class="fa fa-check"></i><b>4.2.1</b> Modifying geoms</a></li>
<li class="chapter" data-level="4.2.2" data-path="Visualization-1.html"><a href="Visualization-1.html#using-multiple-geoms"><i class="fa fa-check"></i><b>4.2.2</b> Using multiple geoms</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Exercises-1.html"><a href="Exercises-1.html"><i class="fa fa-check"></i><b>5</b> Exercises 1</a><ul>
<li class="chapter" data-level="5.1" data-path="Exercises-1.html"><a href="Exercises-1.html#part-1"><i class="fa fa-check"></i><b>5.1</b> Part 1:</a><ul>
<li class="chapter" data-level="5.1.1" data-path="Exercises-1.html"><a href="Exercises-1.html#question-1-importing-data"><i class="fa fa-check"></i><b>5.1.1</b> Question 1: Importing data</a></li>
<li class="chapter" data-level="5.1.2" data-path="Exercises-1.html"><a href="Exercises-1.html#question-2-dataset-dimensions"><i class="fa fa-check"></i><b>5.1.2</b> Question 2: Dataset dimensions</a></li>
<li class="chapter" data-level="5.1.3" data-path="Exercises-1.html"><a href="Exercises-1.html#question-3-objects"><i class="fa fa-check"></i><b>5.1.3</b> Question 3: Objects</a></li>
<li class="chapter" data-level="5.1.4" data-path="Exercises-1.html"><a href="Exercises-1.html#question-4-filtering"><i class="fa fa-check"></i><b>5.1.4</b> Question 4: Filtering</a></li>
<li class="chapter" data-level="5.1.5" data-path="Exercises-1.html"><a href="Exercises-1.html#question-5-plotting"><i class="fa fa-check"></i><b>5.1.5</b> Question 5: Plotting</a></li>
<li class="chapter" data-level="5.1.6" data-path="Exercises-1.html"><a href="Exercises-1.html#question-6-plotting"><i class="fa fa-check"></i><b>5.1.6</b> Question 6: Plotting</a></li>
<li class="chapter" data-level="5.1.7" data-path="Exercises-1.html"><a href="Exercises-1.html#question-7-filtering-and-plotting"><i class="fa fa-check"></i><b>5.1.7</b> Question 7: Filtering and plotting</a></li>
<li class="chapter" data-level="5.1.8" data-path="Exercises-1.html"><a href="Exercises-1.html#question-8-filtering-and-plotting"><i class="fa fa-check"></i><b>5.1.8</b> Question 8: Filtering and plotting</a></li>
<li class="chapter" data-level="5.1.9" data-path="Exercises-1.html"><a href="Exercises-1.html#question-9-open-ended-plotting"><i class="fa fa-check"></i><b>5.1.9</b> Question 9: Open-ended plotting</a></li>
<li class="chapter" data-level="5.1.10" data-path="Exercises-1.html"><a href="Exercises-1.html#question-10-a-peek-at-whats-to-come"><i class="fa fa-check"></i><b>5.1.10</b> Question 10: A peek at what’s to come…</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R For Chemists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Exercises_1" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Exercises 1</h1>
<p>In this set of exercises we’re going to practice importing, filtering, and plotting data. We’re going to work with two datasets: (i) <a href="https://thebustalab.github.io/R_For_Chemists/sample_data/algae_data.csv">algae_chemistry_data.csv</a> and (ii) <a href="https://thebustalab.github.io/R_For_Chemists/sample_data/alaska_lake_data.csv">alaska_lake_data.csv</a>. By clicking on those links you can download each dataset.</p>
<p><strong>For these exercises, you will write your code and answers to any questions in the RStudio script editor, then you will save that file and send it to me. That file comprises your submission for this assignment. I should be able to open and run the file on my computer (after changing the pathnames, if any - so don’t worry about compatibility for those). The file should contain both the code that can perform the actions described below and text that specifies the answers to the questions asked below</strong></p>
<div id="part-1" class="section level2">
<h2><span class="header-section-number">5.1</span> Part 1:</h2>
<div id="question-1-importing-data" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Question 1: Importing data</h3>
<p>Import the algae chemistry data. Remember that <code>read_csv()</code> is part of the <code>tidyverse</code>, so that library needs to be loaded into your <code>R</code> session. Also remember that another option is to paste and run <code>readCSV &lt;- function() { return(readr::read_csv(file.choose())) }</code> in your R Console, which then gives you access to the function <code>readCSV()</code>. That command doesn’t require an input path, so you don’t need to mess around with slashes and quotes. If you need examples of how to import data, please see the <a href="R-Basics-1.html#R_Basics_1">R Basics 1</a> section of this book.</p>
</div>
<div id="question-2-dataset-dimensions" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Question 2: Dataset dimensions</h3>
<p>How many rows and columns does the algae chemistry dataset have? (hint: when you display the dataset on your screen by typing its name into the console, dimensions are also displayed). Write the answer to this question in your R Script right below the code you use to find the answer.</p>
</div>
<div id="question-3-objects" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Question 3: Objects</h3>
<p>Import the algae chemistry data and send it into a new object called <code>algae_chemistry_data</code>. Remember about <code>&lt;-</code>. See the <a href="R-Basics-1.html#R_Basics_1">R Basics 1</a> section of this book if you need help.</p>
</div>
<div id="question-4-filtering" class="section level3">
<h3><span class="header-section-number">5.1.4</span> Question 4: Filtering</h3>
<div id="a" class="section level4">
<h4><span class="header-section-number">5.1.4.1</span> A</h4>
<p>Now that you have the algae data imported and stored in an object called <code>algae_chemistry_data</code>, filter the data so that only entries are shown for which the <code>chemical_species</code> is “FAs”. What are the dimensions (i.e. number of rows and columns) of the resulting dataset?</p>
</div>
<div id="b" class="section level4">
<h4><span class="header-section-number">5.1.4.2</span> B</h4>
<p>Now filter the dataset so that only entries for the <code>algae_strain</code> “Tsv1” are shown. What are the dimensions of the resulting dataset?</p>
</div>
<div id="c" class="section level4">
<h4><span class="header-section-number">5.1.4.3</span> C</h4>
<p>Now filter the dataset so that only entries with an abundance greater than 250 are shown. Note that <code>&gt;</code> can be used in the filter command instead of <code>==</code>, and that numbers inside a filter command do not require quotes around them. What are the dimensions of the resulting dataset?</p>
</div>
</div>
<div id="question-5-plotting" class="section level3">
<h3><span class="header-section-number">5.1.5</span> Question 5: Plotting</h3>
<p>Make a ggplot that has algae strain on the x axis and abundance on the y axis. Use points (<code>geom_point()</code>) to represent each compound. You don’t need to color the points.</p>
<p>Which algae strain has the most abundant compound out of all the compounds in the dataset?</p>
</div>
<div id="question-6-plotting" class="section level3">
<h3><span class="header-section-number">5.1.6</span> Question 6: Plotting</h3>
<p>Make a ggplot that has abundance on the x axis and <code>chemical_species</code> on the y axis. Use points to represent each compound. You don’t need to color the points.</p>
<p>Generally speaking, which class of chemical species are the most abundant in these algae strains?</p>
</div>
<div id="question-7-filtering-and-plotting" class="section level3">
<h3><span class="header-section-number">5.1.7</span> Question 7: Filtering and plotting</h3>
<p>I am going to show you an example of how you can filter and plot at the same time:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">algae_chemistry_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://thebustalab.github.io/R_For_Chemists/sample_data/algae_data.csv&quot;</span>)</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">## Parsed with column specification:</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">## cols(</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">##   replicate = col_double(),</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="co">##   algae_strain = col_character(),</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="co">##   harvesting_regime = col_character(),</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">##   chemical_species = col_character(),</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">##   abundance = col_double()</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">## )</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">filter</span>(algae_chemistry_data, chemical_species <span class="op">==</span><span class="st"> &quot;essential_Aas&quot;</span>), <span class="kw">aes</span>(<span class="dt">x =</span> algae_strain, <span class="dt">y =</span> abundance)) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-23-1.png" width="576" /></p>
<p>Using the above as a template, make a plot that shows just <code>omega_3_polyunsaturated_Fas</code>, with algae_strain on the x axis, and abundance on the y axis. Color the points so that they correspond to harvesting_regime. Remember that mapping a feature of a shape onto a variable must be done inside <code>aes()</code>.</p>
<p>Which harvesting regime leads to higher levels of <code>omega_3_polyunsaturated_Fas</code>?</p>
<p>Now change the plot so that all the points are size = 5. Remember that mapping features of a shape to a constant needs to be done outside <code>aes()</code>.</p>
</div>
<div id="question-8-filtering-and-plotting" class="section level3">
<h3><span class="header-section-number">5.1.8</span> Question 8: Filtering and plotting</h3>
</div>
<div id="question-9-open-ended-plotting" class="section level3">
<h3><span class="header-section-number">5.1.9</span> Question 9: Open-ended plotting</h3>
<p>With the ease of modifying plots in ggplot, we can use graphics to quickly evaluate dataset quality. For this question, make a plot that checks to see whether any of the three replicates consistently have higher abundance than the others. Use filtered data so that just one algae strain is shown, an x and a y axis, and points to represent the measurements. The points should be colored according to harvesting_regime. Make 3 plots, one for each strain of algae.</p>
<p>Do you see any obvious bias across the replicates?</p>
</div>
<div id="question-10-a-peek-at-whats-to-come" class="section level3">
<h3><span class="header-section-number">5.1.10</span> Question 10: A peek at what’s to come…</h3>
<p>Take the code that you made for Question 9. Remove the filtering. Add the following line to the end of the plot: <code>facet_grid(harvesting_regime~algae_strain)</code>. Remember that adding things to plots is done with the <code>+</code> sign, so your code should look something like:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>algae_data<span class="op">&gt;</span>, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="op">&lt;</span>something<span class="op">&gt;</span>, <span class="dt">y =</span> <span class="op">&lt;</span>something <span class="cf">else</span><span class="op">&gt;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="op">&lt;</span>maybe some things<span class="op">&gt;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="st">  </span><span class="kw">facet_grid</span>(harvesting_regime<span class="op">~</span>algae_strain)</a></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Visualization-1.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

</body>

</html>
