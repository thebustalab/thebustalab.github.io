<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Chemometrics 2 | R For Chemists</title>
  <meta name="description" content="Textbook R For Chemists." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Chemometrics 2 | R For Chemists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Textbook R For Chemists." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Chemometrics 2 | R For Chemists" />
  
  <meta name="twitter:description" content="Textbook R For Chemists." />
  

<meta name="author" content="Lucas Busta" />


<meta name="date" content="2020-09-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Exercises-4.html"/>
<link rel="next" href="functions-1.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a><ul>
<li class="chapter" data-level="2.1" data-path="installation.html"><a href="installation.html#installing-r"><i class="fa fa-check"></i><b>2.1</b> Installing <code>R</code></a></li>
<li class="chapter" data-level="2.2" data-path="installation.html"><a href="installation.html#installing-rstudio"><i class="fa fa-check"></i><b>2.2</b> Installing <code>RStudio</code></a></li>
<li class="chapter" data-level="2.3" data-path="installation.html"><a href="installation.html#verifying-installations"><i class="fa fa-check"></i><b>2.3</b> Verifying installations</a></li>
<li class="chapter" data-level="2.4" data-path="installation.html"><a href="installation.html#installing-the-tidyverse"><i class="fa fa-check"></i><b>2.4</b> Installing the <code>tidyverse</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="R-Basics-1.html"><a href="R-Basics-1.html"><i class="fa fa-check"></i><b>3</b> R Basics 1</a><ul>
<li class="chapter" data-level="3.1" data-path="R-Basics-1.html"><a href="R-Basics-1.html#before-we-start"><i class="fa fa-check"></i><b>3.1</b> Before we startâ€¦</a><ul>
<li class="chapter" data-level="3.1.1" data-path="R-Basics-1.html"><a href="R-Basics-1.html#help"><i class="fa fa-check"></i><b>3.1.1</b> Help</a></li>
<li class="chapter" data-level="3.1.2" data-path="R-Basics-1.html"><a href="R-Basics-1.html#syntax"><i class="fa fa-check"></i><b>3.1.2</b> Syntax</a></li>
<li class="chapter" data-level="3.1.3" data-path="R-Basics-1.html"><a href="R-Basics-1.html#paths"><i class="fa fa-check"></i><b>3.1.3</b> Paths</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="R-Basics-1.html"><a href="R-Basics-1.html#functions"><i class="fa fa-check"></i><b>3.2</b> Functions</a></li>
<li class="chapter" data-level="3.3" data-path="R-Basics-1.html"><a href="R-Basics-1.html#objects"><i class="fa fa-check"></i><b>3.3</b> Objects</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Visualization-1.html"><a href="Visualization-1.html"><i class="fa fa-check"></i><b>4</b> Visualization 1</a><ul>
<li class="chapter" data-level="4.1" data-path="Visualization-1.html"><a href="Visualization-1.html#setting-up-a-ggplot"><i class="fa fa-check"></i><b>4.1</b> Setting up a ggplot</a><ul>
<li class="chapter" data-level="4.1.1" data-path="Visualization-1.html"><a href="Visualization-1.html#step-1-define-the-data-you-want-to-use."><i class="fa fa-check"></i><b>4.1.1</b> Step 1: Define the data you want to use.</a></li>
<li class="chapter" data-level="4.1.2" data-path="Visualization-1.html"><a href="Visualization-1.html#step-2-define-how-your-variables-map-onto-the-axes."><i class="fa fa-check"></i><b>4.1.2</b> Step 2: Define how your variables map onto the axes.</a></li>
<li class="chapter" data-level="4.1.3" data-path="Visualization-1.html"><a href="Visualization-1.html#step-3-use-geometric-shapes-to-represent-other-variables-in-your-data."><i class="fa fa-check"></i><b>4.1.3</b> Step 3: Use geometric shapes to represent other variables in your data.</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="Visualization-1.html"><a href="Visualization-1.html#geoms"><i class="fa fa-check"></i><b>4.2</b> Geoms</a><ul>
<li class="chapter" data-level="4.2.1" data-path="Visualization-1.html"><a href="Visualization-1.html#modifying-geoms"><i class="fa fa-check"></i><b>4.2.1</b> Modifying geoms</a></li>
<li class="chapter" data-level="4.2.2" data-path="Visualization-1.html"><a href="Visualization-1.html#using-multiple-geoms"><i class="fa fa-check"></i><b>4.2.2</b> Using multiple geoms</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Exercises-1.html"><a href="Exercises-1.html"><i class="fa fa-check"></i><b>5</b> Exercises 1</a><ul>
<li class="chapter" data-level="5.1" data-path="Exercises-1.html"><a href="Exercises-1.html#part-1-algae-chemistry-dataset"><i class="fa fa-check"></i><b>5.1</b> Part 1: Algae Chemistry Dataset</a><ul>
<li class="chapter" data-level="5.1.1" data-path="Exercises-1.html"><a href="Exercises-1.html#question-1-importing-data"><i class="fa fa-check"></i><b>5.1.1</b> Question 1: Importing data</a></li>
<li class="chapter" data-level="5.1.2" data-path="Exercises-1.html"><a href="Exercises-1.html#question-2-dataset-dimensions"><i class="fa fa-check"></i><b>5.1.2</b> Question 2: Dataset dimensions</a></li>
<li class="chapter" data-level="5.1.3" data-path="Exercises-1.html"><a href="Exercises-1.html#question-3-objects"><i class="fa fa-check"></i><b>5.1.3</b> Question 3: Objects</a></li>
<li class="chapter" data-level="5.1.4" data-path="Exercises-1.html"><a href="Exercises-1.html#question-4-filtering"><i class="fa fa-check"></i><b>5.1.4</b> Question 4: Filtering</a></li>
<li class="chapter" data-level="5.1.5" data-path="Exercises-1.html"><a href="Exercises-1.html#question-5-plotting"><i class="fa fa-check"></i><b>5.1.5</b> Question 5: Plotting</a></li>
<li class="chapter" data-level="5.1.6" data-path="Exercises-1.html"><a href="Exercises-1.html#question-6-plotting"><i class="fa fa-check"></i><b>5.1.6</b> Question 6: Plotting</a></li>
<li class="chapter" data-level="5.1.7" data-path="Exercises-1.html"><a href="Exercises-1.html#question-7-filtering-and-plotting"><i class="fa fa-check"></i><b>5.1.7</b> Question 7: Filtering and plotting</a></li>
<li class="chapter" data-level="5.1.8" data-path="Exercises-1.html"><a href="Exercises-1.html#question-8-filtering-and-plotting"><i class="fa fa-check"></i><b>5.1.8</b> Question 8: Filtering and plotting</a></li>
<li class="chapter" data-level="5.1.9" data-path="Exercises-1.html"><a href="Exercises-1.html#question-9-open-ended-plotting"><i class="fa fa-check"></i><b>5.1.9</b> Question 9: Open-ended plotting</a></li>
<li class="chapter" data-level="5.1.10" data-path="Exercises-1.html"><a href="Exercises-1.html#question-10-a-peek-at-whats-to-come"><i class="fa fa-check"></i><b>5.1.10</b> Question 10: A peek at whatâ€™s to comeâ€¦</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="Exercises-1.html"><a href="Exercises-1.html#part-2-alaska-lakes-dataset"><i class="fa fa-check"></i><b>5.2</b> Part 2: Alaska Lakes Dataset</a><ul>
<li class="chapter" data-level="5.2.1" data-path="Exercises-1.html"><a href="Exercises-1.html#question-1-importing-data-1"><i class="fa fa-check"></i><b>5.2.1</b> Question 1: Importing Data</a></li>
<li class="chapter" data-level="5.2.2" data-path="Exercises-1.html"><a href="Exercises-1.html#question-2-objects"><i class="fa fa-check"></i><b>5.2.2</b> Question 2: Objects</a></li>
<li class="chapter" data-level="5.2.3" data-path="Exercises-1.html"><a href="Exercises-1.html#question-3-filtering"><i class="fa fa-check"></i><b>5.2.3</b> Question 3: Filtering</a></li>
<li class="chapter" data-level="5.2.4" data-path="Exercises-1.html"><a href="Exercises-1.html#question-4-plotting"><i class="fa fa-check"></i><b>5.2.4</b> Question 4: Plotting</a></li>
<li class="chapter" data-level="5.2.5" data-path="Exercises-1.html"><a href="Exercises-1.html#question-5-plotting-1"><i class="fa fa-check"></i><b>5.2.5</b> Question 5: Plotting</a></li>
<li class="chapter" data-level="5.2.6" data-path="Exercises-1.html"><a href="Exercises-1.html#question-6-filtering-and-plotting"><i class="fa fa-check"></i><b>5.2.6</b> Question 6: Filtering and Plotting</a></li>
<li class="chapter" data-level="5.2.7" data-path="Exercises-1.html"><a href="Exercises-1.html#question-7-filtering-and-plotting-1"><i class="fa fa-check"></i><b>5.2.7</b> Question 7: Filtering and Plotting</a></li>
<li class="chapter" data-level="5.2.8" data-path="Exercises-1.html"><a href="Exercises-1.html#question-8-open-ended-plotting"><i class="fa fa-check"></i><b>5.2.8</b> Question 8: Open-ended Plotting</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="Exercises-1.html"><a href="Exercises-1.html#more-geoms."><i class="fa fa-check"></i><b>5.3</b> More geoms.</a></li>
<li class="chapter" data-level="5.4" data-path="Exercises-1.html"><a href="Exercises-1.html#small-multiples"><i class="fa fa-check"></i><b>5.4</b> Small multiples</a></li>
<li class="chapter" data-level="5.5" data-path="Exercises-1.html"><a href="Exercises-1.html#scales"><i class="fa fa-check"></i><b>5.5</b> Scales</a></li>
<li class="chapter" data-level="5.6" data-path="Exercises-1.html"><a href="Exercises-1.html#non-data-ink-themes"><i class="fa fa-check"></i><b>5.6</b> Non-data ink (themes)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="R-Basics-2.html"><a href="R-Basics-2.html"><i class="fa fa-check"></i><b>6</b> R Basics 2</a><ul>
<li class="chapter" data-level="6.1" data-path="R-Basics-2.html"><a href="R-Basics-2.html#geoms-1"><i class="fa fa-check"></i><b>6.1</b> Geoms</a></li>
<li class="chapter" data-level="6.2" data-path="R-Basics-2.html"><a href="R-Basics-2.html#facets"><i class="fa fa-check"></i><b>6.2</b> Facets</a></li>
<li class="chapter" data-level="6.3" data-path="R-Basics-2.html"><a href="R-Basics-2.html#scales-1"><i class="fa fa-check"></i><b>6.3</b> Scales</a></li>
<li class="chapter" data-level="6.4" data-path="R-Basics-2.html"><a href="R-Basics-2.html#themes"><i class="fa fa-check"></i><b>6.4</b> Themes</a><ul>
<li class="chapter" data-level="6.4.1" data-path="R-Basics-2.html"><a href="R-Basics-2.html#complete-themes"><i class="fa fa-check"></i><b>6.4.1</b> Complete themes</a></li>
<li class="chapter" data-level="6.4.2" data-path="R-Basics-2.html"><a href="R-Basics-2.html#theme-components"><i class="fa fa-check"></i><b>6.4.2</b> Theme components</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Exercises-2.html"><a href="Exercises-2.html"><i class="fa fa-check"></i><b>7</b> Exercises 2</a><ul>
<li class="chapter" data-level="7.1" data-path="Exercises-2.html"><a href="Exercises-2.html#question-1"><i class="fa fa-check"></i><b>7.1</b> Question 1</a></li>
<li class="chapter" data-level="7.2" data-path="Exercises-2.html"><a href="Exercises-2.html#question-2"><i class="fa fa-check"></i><b>7.2</b> Question 2</a></li>
<li class="chapter" data-level="7.3" data-path="Exercises-2.html"><a href="Exercises-2.html#question-3"><i class="fa fa-check"></i><b>7.3</b> Question 3</a></li>
<li class="chapter" data-level="7.4" data-path="Exercises-2.html"><a href="Exercises-2.html#question-4"><i class="fa fa-check"></i><b>7.4</b> Question 4</a></li>
<li class="chapter" data-level="7.5" data-path="Exercises-2.html"><a href="Exercises-2.html#question-5"><i class="fa fa-check"></i><b>7.5</b> Question 5</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="R-Basics-3.html"><a href="R-Basics-3.html"><i class="fa fa-check"></i><b>8</b> R Basics 3</a><ul>
<li class="chapter" data-level="8.1" data-path="R-Basics-3.html"><a href="R-Basics-3.html#summary-statistics"><i class="fa fa-check"></i><b>8.1</b> Summary statistics</a></li>
<li class="chapter" data-level="8.2" data-path="R-Basics-3.html"><a href="R-Basics-3.html#the-pipe"><i class="fa fa-check"></i><b>8.2</b> The pipe (%&gt;%)</a></li>
<li class="chapter" data-level="8.3" data-path="R-Basics-3.html"><a href="R-Basics-3.html#tidy-data"><i class="fa fa-check"></i><b>8.3</b> Tidy data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Exercises-3.html"><a href="Exercises-3.html"><i class="fa fa-check"></i><b>9</b> Exercises 3</a><ul>
<li class="chapter" data-level="9.1" data-path="Exercises-3.html"><a href="Exercises-3.html#question-1-1"><i class="fa fa-check"></i><b>9.1</b> Question 1</a></li>
<li class="chapter" data-level="9.2" data-path="Exercises-3.html"><a href="Exercises-3.html#question-2-1"><i class="fa fa-check"></i><b>9.2</b> Question 2</a></li>
<li class="chapter" data-level="9.3" data-path="Exercises-3.html"><a href="Exercises-3.html#question-3-1"><i class="fa fa-check"></i><b>9.3</b> Question 3</a></li>
<li class="chapter" data-level="9.4" data-path="Exercises-3.html"><a href="Exercises-3.html#question-4-1"><i class="fa fa-check"></i><b>9.4</b> Question 4</a></li>
<li class="chapter" data-level="9.5" data-path="Exercises-3.html"><a href="Exercises-3.html#question-5-1"><i class="fa fa-check"></i><b>9.5</b> Question 5</a></li>
<li class="chapter" data-level="9.6" data-path="Exercises-3.html"><a href="Exercises-3.html#question-6"><i class="fa fa-check"></i><b>9.6</b> Question 6</a></li>
<li class="chapter" data-level="9.7" data-path="Exercises-3.html"><a href="Exercises-3.html#question-7"><i class="fa fa-check"></i><b>9.7</b> Question 7</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Chemometrics-1.html"><a href="Chemometrics-1.html"><i class="fa fa-check"></i><b>10</b> Chemometrics 1</a></li>
<li class="chapter" data-level="11" data-path="Exercises-4.html"><a href="Exercises-4.html"><i class="fa fa-check"></i><b>11</b> Exercises 4</a></li>
<li class="chapter" data-level="12" data-path="Chemometrics-2.html"><a href="Chemometrics-2.html"><i class="fa fa-check"></i><b>12</b> Chemometrics 2</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="functions-1.html"><a href="functions-1.html"><i class="fa fa-check"></i><b>A</b> Functions</a></li>
<li class="chapter" data-level="B" data-path="custom-functions.html"><a href="custom-functions.html"><i class="fa fa-check"></i><b>B</b> Custom functions</a><ul>
<li class="chapter" data-level="B.1" data-path="custom-functions.html"><a href="custom-functions.html#readcsv"><i class="fa fa-check"></i><b>B.1</b> readCSV</a></li>
<li class="chapter" data-level="B.2" data-path="custom-functions.html"><a href="custom-functions.html#runmatrixanalysis"><i class="fa fa-check"></i><b>B.2</b> runMatrixAnalysis</a><ul>
<li class="chapter" data-level="B.2.1" data-path="custom-functions.html"><a href="custom-functions.html#once-you-have-activated-runmatrixanalysis-in-your-r-session-see-below-you-can-use-the-function-by-filling-out-and-executing-this-template"><i class="fa fa-check"></i><b>B.2.1</b> Once you have activated <code>runMatrixAnalysis</code> in your R session (see below), you can use the function by filling out and executing this template:</a></li>
<li class="chapter" data-level="B.2.2" data-path="custom-functions.html"><a href="custom-functions.html#to-activate-runmatrixanalysis-in-your-session-run-the-following-in-your-console"><i class="fa fa-check"></i><b>B.2.2</b> To activate <code>runMatrixAnalysis</code> in your session, run the following in your console:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>C</b> FAQ</a><ul>
<li class="chapter" data-level="C.1" data-path="faq.html"><a href="faq.html#filtering"><i class="fa fa-check"></i><b>C.1</b> Filtering</a></li>
<li class="chapter" data-level="C.2" data-path="faq.html"><a href="faq.html#order-categorical-axes"><i class="fa fa-check"></i><b>C.2</b> Order categorical axes</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="pca-and-big-data.html"><a href="pca-and-big-data.html"><i class="fa fa-check"></i><b>D</b> PCA and Big Data</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R For Chemists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Chemometrics_2" class="section level1">
<h1><span class="header-section-number">Chapter 12</span> Chemometrics 2</h1>
<p>There is another way to look at our data in a cluster context - i.e.Â another way to identify clusters of samples that have similar properties based on the analytes in the dataset. This method is called k-means, which we will look at later, but for it we need to have a look at dimensionality reduction techniques, particularly principal components analysis (PCA). PCA looks at all the variance in a high dimensional dataset and chooses new axes within that dataset that align with the directions containing higest variance. These new axes are called principal components. Letâ€™s look at an example:</p>
<p><img src="https://thebustalab.github.io/R_For_Chemists/figures/PCA.png" style="display: block; margin: auto;" /></p>
<p>In the example above, the three dimensional space can be reduced to a two dimensional space with the principal components analysis. New axes (principal components) are selected (bold arrows on left) that become the x and y axes in the principal components space (right).</p>
<p>We can run and visualize principal components analyses using the runMatrixAnalysis() function as in the example below:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">AK_lakes &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://thebustalab.github.io/R_For_Chemists/sample_data/alaska_lake_data.csv&quot;</span>)</a>
<a class="sourceLine" id="cb55-2" data-line-number="2"><span class="kw">head</span>(AK_lakes)</a>
<a class="sourceLine" id="cb55-3" data-line-number="3"><span class="co">## # A tibble: 6 x 7</span></a>
<a class="sourceLine" id="cb55-4" data-line-number="4"><span class="co">##   lake                park  water_temp    pH element mg_per_L element_type</span></a>
<a class="sourceLine" id="cb55-5" data-line-number="5"><span class="co">##   &lt;chr&gt;               &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;       </span></a>
<a class="sourceLine" id="cb55-6" data-line-number="6"><span class="co">## 1 Devil_Mountain_Lake BELA        6.46  7.69 C          3.4   bound       </span></a>
<a class="sourceLine" id="cb55-7" data-line-number="7"><span class="co">## 2 Devil_Mountain_Lake BELA        6.46  7.69 N          0.028 bound       </span></a>
<a class="sourceLine" id="cb55-8" data-line-number="8"><span class="co">## 3 Devil_Mountain_Lake BELA        6.46  7.69 P          0     bound       </span></a>
<a class="sourceLine" id="cb55-9" data-line-number="9"><span class="co">## 4 Devil_Mountain_Lake BELA        6.46  7.69 Cl        10.4   free        </span></a>
<a class="sourceLine" id="cb55-10" data-line-number="10"><span class="co">## 5 Devil_Mountain_Lake BELA        6.46  7.69 S          0.62  free        </span></a>
<a class="sourceLine" id="cb55-11" data-line-number="11"><span class="co">## 6 Devil_Mountain_Lake BELA        6.46  7.69 F          0.04  free</span></a>
<a class="sourceLine" id="cb55-12" data-line-number="12"></a>
<a class="sourceLine" id="cb55-13" data-line-number="13">    AK_lakes_analyzed &lt;-<span class="st"> </span><span class="kw">runMatrixAnalysis</span>(</a>
<a class="sourceLine" id="cb55-14" data-line-number="14">        <span class="dt">data =</span> AK_lakes,</a>
<a class="sourceLine" id="cb55-15" data-line-number="15">        <span class="dt">analysis =</span> <span class="kw">c</span>(<span class="st">&quot;pca&quot;</span>),</a>
<a class="sourceLine" id="cb55-16" data-line-number="16">        <span class="dt">column_w_names_of_multiple_analytes =</span> <span class="st">&quot;element&quot;</span>,</a>
<a class="sourceLine" id="cb55-17" data-line-number="17">        <span class="dt">column_w_values_for_multiple_analytes =</span> <span class="st">&quot;mg_per_L&quot;</span>,</a>
<a class="sourceLine" id="cb55-18" data-line-number="18">        <span class="dt">columns_w_values_for_single_analyte =</span> <span class="kw">c</span>(<span class="st">&quot;water_temp&quot;</span>, <span class="st">&quot;pH&quot;</span>),</a>
<a class="sourceLine" id="cb55-19" data-line-number="19">        <span class="dt">columns_w_additional_analyte_info =</span> <span class="st">&quot;element_type&quot;</span>,</a>
<a class="sourceLine" id="cb55-20" data-line-number="20">        <span class="dt">columns_w_sample_ID_info =</span> <span class="kw">c</span>(<span class="st">&quot;lake&quot;</span>, <span class="st">&quot;park&quot;</span>)</a>
<a class="sourceLine" id="cb55-21" data-line-number="21">    )</a></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-90-1.png" width="576" /><img src="bio723-book_files/figure-html/unnamed-chunk-90-2.png" width="576" /></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"></a>
<a class="sourceLine" id="cb56-2" data-line-number="2"><span class="kw">library</span>(ggrepel)</a>
<a class="sourceLine" id="cb56-3" data-line-number="3"></a>
<a class="sourceLine" id="cb56-4" data-line-number="4"><span class="kw">ggplot</span>(<span class="dt">data =</span> AK_lakes_analyzed, <span class="kw">aes</span>(<span class="dt">x =</span> Dim<span class="fl">.1</span>, <span class="dt">y =</span> Dim<span class="fl">.2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb56-5" data-line-number="5"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> park), <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb56-6" data-line-number="6"><span class="st">    </span><span class="kw">geom_label_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> lake), <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb56-7" data-line-number="7"><span class="st">    </span><span class="kw">theme_classic</span>()</a></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-90-3.png" width="576" /></p>
<p>It is possible that you will want access to the information that creates the ordination plot as well as the the percent variances explained by each of the principal components. These can be obtained using <code>analysis = &quot;pca-ord&quot;</code> and <code>analysis = &quot;pca-dim</code>. See below:</p>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   atomic_symbol = col_character(),
##   state_at_RT = col_character()
## )
## See spec(...) for full column specifications.</code></pre>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-91-1.png" width="576" /><img src="bio723-book_files/figure-html/unnamed-chunk-91-2.png" width="576" /></p>
<pre><code>## # A tibble: 6 x 3
##    Dim.1  Dim.2 sample_unique_ID         
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;                    
## 1  0.395  0.400 atomic_mass_rounded      
## 2  0.840 -0.365 melting_point_C          
## 3  0.908 -0.262 boiling_point_C          
## 4  0.746 -0.215 density_g_per_mL         
## 5 -0.471 -0.629 electronegativity_pauling
## 6 -0.743 -0.456 first_ionization_poten_eV</code></pre>
<p>library(ggforce)
ggplot(clustering) +
geom_segment(aes(x = 0, y = 0, xend = Dim.1, yend = Dim.2), size = 1) +
geom_circle(aes(x0 = 0, y0 = 0, r = 1))
```</p>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="Exercises-4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="functions-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

</body>

</html>
