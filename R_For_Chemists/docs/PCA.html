<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 PCA | R For Chemists</title>
  <meta name="description" content="Textbook R For Chemists." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 PCA | R For Chemists" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Textbook R For Chemists." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 PCA | R For Chemists" />
  
  <meta name="twitter:description" content="Textbook R For Chemists." />
  

<meta name="author" content="Lucas Busta" />


<meta name="date" content="2020-10-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Exercises-4.html"/>
<link rel="next" href="Exercises-5.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a><ul>
<li class="chapter" data-level="2.1" data-path="installation.html"><a href="installation.html#installing-r"><i class="fa fa-check"></i><b>2.1</b> Installing <code>R</code></a></li>
<li class="chapter" data-level="2.2" data-path="installation.html"><a href="installation.html#installing-rstudio"><i class="fa fa-check"></i><b>2.2</b> Installing <code>RStudio</code></a></li>
<li class="chapter" data-level="2.3" data-path="installation.html"><a href="installation.html#verifying-installations"><i class="fa fa-check"></i><b>2.3</b> Verifying installations</a></li>
<li class="chapter" data-level="2.4" data-path="installation.html"><a href="installation.html#installing-the-tidyverse"><i class="fa fa-check"></i><b>2.4</b> Installing the <code>tidyverse</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="R-Basics.html"><a href="R-Basics.html"><i class="fa fa-check"></i><b>3</b> R Basics</a><ul>
<li class="chapter" data-level="3.1" data-path="R-Basics.html"><a href="R-Basics.html#before-we-start"><i class="fa fa-check"></i><b>3.1</b> Before we start…</a><ul>
<li class="chapter" data-level="3.1.1" data-path="R-Basics.html"><a href="R-Basics.html#help"><i class="fa fa-check"></i><b>3.1.1</b> Help</a></li>
<li class="chapter" data-level="3.1.2" data-path="R-Basics.html"><a href="R-Basics.html#syntax"><i class="fa fa-check"></i><b>3.1.2</b> Syntax</a></li>
<li class="chapter" data-level="3.1.3" data-path="R-Basics.html"><a href="R-Basics.html#paths"><i class="fa fa-check"></i><b>3.1.3</b> Paths</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="R-Basics.html"><a href="R-Basics.html#functions"><i class="fa fa-check"></i><b>3.2</b> Functions</a></li>
<li class="chapter" data-level="3.3" data-path="R-Basics.html"><a href="R-Basics.html#objects"><i class="fa fa-check"></i><b>3.3</b> Objects</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>4</b> ggplot2</a><ul>
<li class="chapter" data-level="4.1" data-path="ggplot2.html"><a href="ggplot2.html#setting-up-a-ggplot"><i class="fa fa-check"></i><b>4.1</b> Setting up a ggplot</a><ul>
<li class="chapter" data-level="4.1.1" data-path="ggplot2.html"><a href="ggplot2.html#step-1-define-the-data-you-want-to-use."><i class="fa fa-check"></i><b>4.1.1</b> Step 1: Define the data you want to use.</a></li>
<li class="chapter" data-level="4.1.2" data-path="ggplot2.html"><a href="ggplot2.html#step-2-define-how-your-variables-map-onto-the-axes."><i class="fa fa-check"></i><b>4.1.2</b> Step 2: Define how your variables map onto the axes.</a></li>
<li class="chapter" data-level="4.1.3" data-path="ggplot2.html"><a href="ggplot2.html#step-3-use-geometric-shapes-to-represent-other-variables-in-your-data."><i class="fa fa-check"></i><b>4.1.3</b> Step 3: Use geometric shapes to represent other variables in your data.</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ggplot2.html"><a href="ggplot2.html#geoms"><i class="fa fa-check"></i><b>4.2</b> Geoms</a><ul>
<li class="chapter" data-level="4.2.1" data-path="ggplot2.html"><a href="ggplot2.html#modifying-geoms"><i class="fa fa-check"></i><b>4.2.1</b> Modifying geoms</a></li>
<li class="chapter" data-level="4.2.2" data-path="ggplot2.html"><a href="ggplot2.html#using-multiple-geoms"><i class="fa fa-check"></i><b>4.2.2</b> Using multiple geoms</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Exercises-1.html"><a href="Exercises-1.html"><i class="fa fa-check"></i><b>5</b> Exercises 1</a><ul>
<li class="chapter" data-level="5.1" data-path="Exercises-1.html"><a href="Exercises-1.html#part-1-algae-chemistry-dataset"><i class="fa fa-check"></i><b>5.1</b> Part 1: Algae Chemistry Dataset</a><ul>
<li class="chapter" data-level="5.1.1" data-path="Exercises-1.html"><a href="Exercises-1.html#question-1-importing-data"><i class="fa fa-check"></i><b>5.1.1</b> Question 1: Importing data</a></li>
<li class="chapter" data-level="5.1.2" data-path="Exercises-1.html"><a href="Exercises-1.html#question-2-dataset-dimensions"><i class="fa fa-check"></i><b>5.1.2</b> Question 2: Dataset dimensions</a></li>
<li class="chapter" data-level="5.1.3" data-path="Exercises-1.html"><a href="Exercises-1.html#question-3-objects"><i class="fa fa-check"></i><b>5.1.3</b> Question 3: Objects</a></li>
<li class="chapter" data-level="5.1.4" data-path="Exercises-1.html"><a href="Exercises-1.html#question-4-filtering"><i class="fa fa-check"></i><b>5.1.4</b> Question 4: Filtering</a></li>
<li class="chapter" data-level="5.1.5" data-path="Exercises-1.html"><a href="Exercises-1.html#question-5-plotting"><i class="fa fa-check"></i><b>5.1.5</b> Question 5: Plotting</a></li>
<li class="chapter" data-level="5.1.6" data-path="Exercises-1.html"><a href="Exercises-1.html#question-6-plotting"><i class="fa fa-check"></i><b>5.1.6</b> Question 6: Plotting</a></li>
<li class="chapter" data-level="5.1.7" data-path="Exercises-1.html"><a href="Exercises-1.html#question-7-filtering-and-plotting"><i class="fa fa-check"></i><b>5.1.7</b> Question 7: Filtering and plotting</a></li>
<li class="chapter" data-level="5.1.8" data-path="Exercises-1.html"><a href="Exercises-1.html#question-8-filtering-and-plotting"><i class="fa fa-check"></i><b>5.1.8</b> Question 8: Filtering and plotting</a></li>
<li class="chapter" data-level="5.1.9" data-path="Exercises-1.html"><a href="Exercises-1.html#question-9-open-ended-plotting"><i class="fa fa-check"></i><b>5.1.9</b> Question 9: Open-ended plotting</a></li>
<li class="chapter" data-level="5.1.10" data-path="Exercises-1.html"><a href="Exercises-1.html#question-10-a-peek-at-whats-to-come"><i class="fa fa-check"></i><b>5.1.10</b> Question 10: A peek at what’s to come…</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="Exercises-1.html"><a href="Exercises-1.html#part-2-alaska-lakes-dataset"><i class="fa fa-check"></i><b>5.2</b> Part 2: Alaska Lakes Dataset</a><ul>
<li class="chapter" data-level="5.2.1" data-path="Exercises-1.html"><a href="Exercises-1.html#question-1-importing-data-1"><i class="fa fa-check"></i><b>5.2.1</b> Question 1: Importing Data</a></li>
<li class="chapter" data-level="5.2.2" data-path="Exercises-1.html"><a href="Exercises-1.html#question-2-objects"><i class="fa fa-check"></i><b>5.2.2</b> Question 2: Objects</a></li>
<li class="chapter" data-level="5.2.3" data-path="Exercises-1.html"><a href="Exercises-1.html#question-3-filtering"><i class="fa fa-check"></i><b>5.2.3</b> Question 3: Filtering</a></li>
<li class="chapter" data-level="5.2.4" data-path="Exercises-1.html"><a href="Exercises-1.html#question-4-plotting"><i class="fa fa-check"></i><b>5.2.4</b> Question 4: Plotting</a></li>
<li class="chapter" data-level="5.2.5" data-path="Exercises-1.html"><a href="Exercises-1.html#question-5-plotting-1"><i class="fa fa-check"></i><b>5.2.5</b> Question 5: Plotting</a></li>
<li class="chapter" data-level="5.2.6" data-path="Exercises-1.html"><a href="Exercises-1.html#question-6-filtering-and-plotting"><i class="fa fa-check"></i><b>5.2.6</b> Question 6: Filtering and Plotting</a></li>
<li class="chapter" data-level="5.2.7" data-path="Exercises-1.html"><a href="Exercises-1.html#question-7-filtering-and-plotting-1"><i class="fa fa-check"></i><b>5.2.7</b> Question 7: Filtering and Plotting</a></li>
<li class="chapter" data-level="5.2.8" data-path="Exercises-1.html"><a href="Exercises-1.html#question-8-open-ended-plotting"><i class="fa fa-check"></i><b>5.2.8</b> Question 8: Open-ended Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html"><i class="fa fa-check"></i><b>6</b> geoms, facets, scales, themes</a><ul>
<li class="chapter" data-level="6.1" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#geoms-1"><i class="fa fa-check"></i><b>6.1</b> Geoms</a></li>
<li class="chapter" data-level="6.2" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#facets"><i class="fa fa-check"></i><b>6.2</b> Facets</a></li>
<li class="chapter" data-level="6.3" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#scales"><i class="fa fa-check"></i><b>6.3</b> Scales</a></li>
<li class="chapter" data-level="6.4" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#themes"><i class="fa fa-check"></i><b>6.4</b> Themes</a><ul>
<li class="chapter" data-level="6.4.1" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#complete-themes"><i class="fa fa-check"></i><b>6.4.1</b> Complete themes</a></li>
<li class="chapter" data-level="6.4.2" data-path="geoms-facets-scales-themes.html"><a href="geoms-facets-scales-themes.html#theme-components"><i class="fa fa-check"></i><b>6.4.2</b> Theme components</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Exercises-2.html"><a href="Exercises-2.html"><i class="fa fa-check"></i><b>7</b> Exercises 2</a><ul>
<li class="chapter" data-level="7.1" data-path="Exercises-2.html"><a href="Exercises-2.html#question-1"><i class="fa fa-check"></i><b>7.1</b> Question 1</a></li>
<li class="chapter" data-level="7.2" data-path="Exercises-2.html"><a href="Exercises-2.html#question-2"><i class="fa fa-check"></i><b>7.2</b> Question 2</a></li>
<li class="chapter" data-level="7.3" data-path="Exercises-2.html"><a href="Exercises-2.html#question-3"><i class="fa fa-check"></i><b>7.3</b> Question 3</a></li>
<li class="chapter" data-level="7.4" data-path="Exercises-2.html"><a href="Exercises-2.html#question-4"><i class="fa fa-check"></i><b>7.4</b> Question 4</a></li>
<li class="chapter" data-level="7.5" data-path="Exercises-2.html"><a href="Exercises-2.html#question-5"><i class="fa fa-check"></i><b>7.5</b> Question 5</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="summary-statistics.html"><a href="summary-statistics.html"><i class="fa fa-check"></i><b>8</b> Summary Statistics</a><ul>
<li class="chapter" data-level="8.1" data-path="summary-statistics.html"><a href="summary-statistics.html#summary-statistics"><i class="fa fa-check"></i><b>8.1</b> Summary statistics</a></li>
<li class="chapter" data-level="8.2" data-path="summary-statistics.html"><a href="summary-statistics.html#the-pipe"><i class="fa fa-check"></i><b>8.2</b> The pipe (%&gt;%)</a></li>
<li class="chapter" data-level="8.3" data-path="summary-statistics.html"><a href="summary-statistics.html#tidy-data"><i class="fa fa-check"></i><b>8.3</b> Tidy data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Exercises-3.html"><a href="Exercises-3.html"><i class="fa fa-check"></i><b>9</b> Exercises 3</a><ul>
<li class="chapter" data-level="9.1" data-path="Exercises-3.html"><a href="Exercises-3.html#question-1-1"><i class="fa fa-check"></i><b>9.1</b> Question 1</a></li>
<li class="chapter" data-level="9.2" data-path="Exercises-3.html"><a href="Exercises-3.html#question-2-1"><i class="fa fa-check"></i><b>9.2</b> Question 2</a></li>
<li class="chapter" data-level="9.3" data-path="Exercises-3.html"><a href="Exercises-3.html#question-3-1"><i class="fa fa-check"></i><b>9.3</b> Question 3</a></li>
<li class="chapter" data-level="9.4" data-path="Exercises-3.html"><a href="Exercises-3.html#question-4-1"><i class="fa fa-check"></i><b>9.4</b> Question 4</a></li>
<li class="chapter" data-level="9.5" data-path="Exercises-3.html"><a href="Exercises-3.html#question-5-1"><i class="fa fa-check"></i><b>9.5</b> Question 5</a></li>
<li class="chapter" data-level="9.6" data-path="Exercises-3.html"><a href="Exercises-3.html#question-6"><i class="fa fa-check"></i><b>9.6</b> Question 6</a></li>
<li class="chapter" data-level="9.7" data-path="Exercises-3.html"><a href="Exercises-3.html#question-7"><i class="fa fa-check"></i><b>9.7</b> Question 7</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Clustering.html"><a href="Clustering.html"><i class="fa fa-check"></i><b>10</b> Clustering</a></li>
<li class="chapter" data-level="11" data-path="Exercises-4.html"><a href="Exercises-4.html"><i class="fa fa-check"></i><b>11</b> Exercises 4</a></li>
<li class="chapter" data-level="12" data-path="PCA.html"><a href="PCA.html"><i class="fa fa-check"></i><b>12</b> PCA</a><ul>
<li class="chapter" data-level="12.1" data-path="PCA.html"><a href="PCA.html#pca"><i class="fa fa-check"></i><b>12.1</b> PCA</a></li>
<li class="chapter" data-level="12.2" data-path="PCA.html"><a href="PCA.html#drivers-of-pca-dimensions"><i class="fa fa-check"></i><b>12.2</b> Drivers of PCA dimensions</a></li>
<li class="chapter" data-level="12.3" data-path="PCA.html"><a href="PCA.html#comparing-principal-components"><i class="fa fa-check"></i><b>12.3</b> Comparing principal components</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="Exercises-5.html"><a href="Exercises-5.html"><i class="fa fa-check"></i><b>13</b> Exercises 5</a><ul>
<li class="chapter" data-level="13.1" data-path="Exercises-5.html"><a href="Exercises-5.html#option-1-human-metabolomics."><i class="fa fa-check"></i><b>13.1</b> Option 1: Human metabolomics.</a></li>
<li class="chapter" data-level="13.2" data-path="Exercises-5.html"><a href="Exercises-5.html#option-2-grape-vine-varieties"><i class="fa fa-check"></i><b>13.2</b> Option 2: Grape vine varieties</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="k-means.html"><a href="k-means.html"><i class="fa fa-check"></i><b>14</b> k-means</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="functions-1.html"><a href="functions-1.html"><i class="fa fa-check"></i><b>A</b> Functions</a><ul>
<li class="chapter" data-level="A.1" data-path="functions-1.html"><a href="functions-1.html#libraries-and-packages"><i class="fa fa-check"></i><b>A.1</b> Libraries and packages</a><ul>
<li class="chapter" data-level="A.1.1" data-path="functions-1.html"><a href="functions-1.html#install.packages"><i class="fa fa-check"></i><b>A.1.1</b> <code>install.packages()</code></a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="functions-1.html"><a href="functions-1.html#operators"><i class="fa fa-check"></i><b>A.2</b> Operators</a><ul>
<li class="chapter" data-level="A.2.1" data-path="functions-1.html"><a href="functions-1.html#in"><i class="fa fa-check"></i><b>A.2.1</b> <code>%in%</code></a></li>
<li class="chapter" data-level="A.2.2" data-path="functions-1.html"><a href="functions-1.html#section"><i class="fa fa-check"></i><b>A.2.2</b> &lt;</a></li>
<li class="chapter" data-level="A.2.3" data-path="functions-1.html"><a href="functions-1.html#section-1"><i class="fa fa-check"></i><b>A.2.3</b> &lt;=</a></li>
<li class="chapter" data-level="A.2.4" data-path="functions-1.html"><a href="functions-1.html#section-2"><i class="fa fa-check"></i><b>A.2.4</b> &gt;</a></li>
<li class="chapter" data-level="A.2.5" data-path="functions-1.html"><a href="functions-1.html#section-3"><i class="fa fa-check"></i><b>A.2.5</b> &gt;=</a></li>
<li class="chapter" data-level="A.2.6" data-path="functions-1.html"><a href="functions-1.html#section-4"><i class="fa fa-check"></i><b>A.2.6</b> ==</a></li>
<li class="chapter" data-level="A.2.7" data-path="functions-1.html"><a href="functions-1.html#section-5"><i class="fa fa-check"></i><b>A.2.7</b> !=</a></li>
<li class="chapter" data-level="A.2.8" data-path="functions-1.html"><a href="functions-1.html#section-6"><i class="fa fa-check"></i><b>A.2.8</b> |</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="functions-1.html"><a href="functions-1.html#data-wrangling"><i class="fa fa-check"></i><b>A.3</b> Data wrangling</a><ul>
<li class="chapter" data-level="A.3.1" data-path="functions-1.html"><a href="functions-1.html#tidyverseread_csv"><i class="fa fa-check"></i><b>A.3.1</b> <code>tidyverse::read_csv()</code></a></li>
<li class="chapter" data-level="A.3.2" data-path="functions-1.html"><a href="functions-1.html#read.csv"><i class="fa fa-check"></i><b>A.3.2</b> <code>read.csv()</code></a></li>
<li class="chapter" data-level="A.3.3" data-path="functions-1.html"><a href="functions-1.html#readcsv"><i class="fa fa-check"></i><b>A.3.3</b> <code>readCSV()</code></a></li>
<li class="chapter" data-level="A.3.4" data-path="functions-1.html"><a href="functions-1.html#head"><i class="fa fa-check"></i><b>A.3.4</b> <code>head()</code></a></li>
<li class="chapter" data-level="A.3.5" data-path="functions-1.html"><a href="functions-1.html#dplyrfilter-a-dplyr-function---part-of-the-tidyverse-use-it-to-filter-your-data."><i class="fa fa-check"></i><b>A.3.5</b> <code>dplyr::filter()</code> (a dplyr function - part of the tidyverse) Use it to filter your data.</a></li>
<li class="chapter" data-level="A.3.6" data-path="functions-1.html"><a href="functions-1.html#dplyrmutate-a-dplyr-function---part-of-the-tidyverse.-an-example"><i class="fa fa-check"></i><b>A.3.6</b> <code>dplyr::mutate()</code> (a dplyr function - part of the tidyverse). An example:</a></li>
<li class="chapter" data-level="A.3.7" data-path="functions-1.html"><a href="functions-1.html#dplyrcase_when-a-dplyr-function---part-of-the-tidyverse"><i class="fa fa-check"></i><b>A.3.7</b> <code>dplyr::case_when()</code> (a dplyr function - part of the tidyverse)</a></li>
<li class="chapter" data-level="A.3.8" data-path="functions-1.html"><a href="functions-1.html#tidyrpivot_longer"><i class="fa fa-check"></i><b>A.3.8</b> <code>tidyr::pivot_longer()</code></a></li>
<li class="chapter" data-level="A.3.9" data-path="functions-1.html"><a href="functions-1.html#dplyrgroup_by"><i class="fa fa-check"></i><b>A.3.9</b> <code>dplyr::group_by()</code></a></li>
<li class="chapter" data-level="A.3.10" data-path="functions-1.html"><a href="functions-1.html#dplyrsummarize"><i class="fa fa-check"></i><b>A.3.10</b> <code>dplyr::summarize()</code></a></li>
<li class="chapter" data-level="A.3.11" data-path="functions-1.html"><a href="functions-1.html#section-7"><i class="fa fa-check"></i><b>A.3.11</b> <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="functions-1.html"><a href="functions-1.html#plotting"><i class="fa fa-check"></i><b>A.4</b> Plotting</a><ul>
<li class="chapter" data-level="A.4.1" data-path="functions-1.html"><a href="functions-1.html#plot"><i class="fa fa-check"></i><b>A.4.1</b> <code>plot()</code></a></li>
<li class="chapter" data-level="A.4.2" data-path="functions-1.html"><a href="functions-1.html#ggplot2ggplot"><i class="fa fa-check"></i><b>A.4.2</b> <code>ggplot2::ggplot()</code></a></li>
<li class="chapter" data-level="A.4.3" data-path="functions-1.html"><a href="functions-1.html#ggplot2aes"><i class="fa fa-check"></i><b>A.4.3</b> <code>ggplot2::aes()</code></a></li>
<li class="chapter" data-level="A.4.4" data-path="functions-1.html"><a href="functions-1.html#ggplot2geom_"><i class="fa fa-check"></i><b>A.4.4</b> <code>ggplot2::geom_*()</code></a></li>
<li class="chapter" data-level="A.4.5" data-path="functions-1.html"><a href="functions-1.html#ggplot2facet_grid"><i class="fa fa-check"></i><b>A.4.5</b> <code>ggplot2::facet_grid()</code></a></li>
<li class="chapter" data-level="A.4.6" data-path="functions-1.html"><a href="functions-1.html#ggplot2scale__"><i class="fa fa-check"></i><b>A.4.6</b> <code>ggplot2::scale_*_*()</code></a></li>
<li class="chapter" data-level="A.4.7" data-path="functions-1.html"><a href="functions-1.html#ggplot2theme_"><i class="fa fa-check"></i><b>A.4.7</b> <code>ggplot2::theme_*()</code></a></li>
<li class="chapter" data-level="A.4.8" data-path="functions-1.html"><a href="functions-1.html#ggplot2coord_flip"><i class="fa fa-check"></i><b>A.4.8</b> <code>ggplot2::coord_flip()</code></a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="functions-1.html"><a href="functions-1.html#statistics"><i class="fa fa-check"></i><b>A.5</b> Statistics</a><ul>
<li class="chapter" data-level="A.5.1" data-path="functions-1.html"><a href="functions-1.html#mean"><i class="fa fa-check"></i><b>A.5.1</b> <code>mean()</code></a></li>
<li class="chapter" data-level="A.5.2" data-path="functions-1.html"><a href="functions-1.html#sd"><i class="fa fa-check"></i><b>A.5.2</b> <code>sd()</code></a></li>
<li class="chapter" data-level="A.5.3" data-path="functions-1.html"><a href="functions-1.html#table"><i class="fa fa-check"></i><b>A.5.3</b> <code>table()</code></a></li>
<li class="chapter" data-level="A.5.4" data-path="functions-1.html"><a href="functions-1.html#statsweighted.mean"><i class="fa fa-check"></i><b>A.5.4</b> <code>stats::weighted.mean()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="custom-functions.html"><a href="custom-functions.html"><i class="fa fa-check"></i><b>B</b> Custom functions</a><ul>
<li class="chapter" data-level="B.1" data-path="custom-functions.html"><a href="custom-functions.html#activating-custom-functions"><i class="fa fa-check"></i><b>B.1</b> Activating custom functions</a></li>
<li class="chapter" data-level="B.2" data-path="custom-functions.html"><a href="custom-functions.html#basic-runmatrixanalysis-template"><i class="fa fa-check"></i><b>B.2</b> Basic <code>runMatrixAnalysis()</code> template</a></li>
<li class="chapter" data-level="B.3" data-path="custom-functions.html"><a href="custom-functions.html#advanced-runmatrixanalysis-template"><i class="fa fa-check"></i><b>B.3</b> Advanced <code>runMatrixAnalysis()</code> template</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>C</b> FAQ</a><ul>
<li class="chapter" data-level="C.1" data-path="faq.html"><a href="faq.html#filtering"><i class="fa fa-check"></i><b>C.1</b> Filtering</a></li>
<li class="chapter" data-level="C.2" data-path="faq.html"><a href="faq.html#order-categorical-axes"><i class="fa fa-check"></i><b>C.2</b> Order categorical axes</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="pca-and-big-data.html"><a href="pca-and-big-data.html"><i class="fa fa-check"></i><b>D</b> PCA and Big Data</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R For Chemists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="PCA" class="section level1">
<h1><span class="header-section-number">Chapter 12</span> PCA</h1>
<p>There is another way to look at our data in a cluster context - i.e. another way to identify clusters of samples that have similar properties based on the analytes in the data set. This method is called k-means, which we will look at later, because for it we first need to have a look at dimensionality reduction techniques, particularly principal components analysis (PCA).</p>
<div id="pca" class="section level2">
<h2><span class="header-section-number">12.1</span> PCA</h2>
<p>PCA looks at all the variance in a high dimensional data set and chooses new axes within that data set that align with the directions containing highest variance. These new axes are called principal components. Let’s look at an example:</p>
<p><img src="https://thebustalab.github.io/R_For_Chemists/figures/PCA.png" style="display: block; margin: auto;" /></p>
<p>In the example above, the three dimensional space can be reduced to a two dimensional space with the principal components analysis. New axes (principal components) are selected (bold arrows on left) that become the x and y axes in the principal components space (right).</p>
<p>We can run and visualize principal components analyses using the <code>runMatrixAnalysis()</code> function as in the example below:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="PCA.html#cb55-1"></a><span class="kw">source</span>(<span class="st">&quot;https://thebustalab.github.io/R_For_Chemists/custom_functions/chem.R&quot;</span>)</span>
<span id="cb55-2"><a href="PCA.html#cb55-2"></a>AK_lakes &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://thebustalab.github.io/R_For_Chemists/sample_data/alaska_lake_data.csv&quot;</span>)</span>
<span id="cb55-3"><a href="PCA.html#cb55-3"></a><span class="kw">head</span>(AK_lakes)</span>
<span id="cb55-4"><a href="PCA.html#cb55-4"></a><span class="co">## # A tibble: 6 x 7</span></span>
<span id="cb55-5"><a href="PCA.html#cb55-5"></a><span class="co">##   lake                park  water_temp    pH element mg_per_L element_type</span></span>
<span id="cb55-6"><a href="PCA.html#cb55-6"></a><span class="co">##   &lt;chr&gt;               &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;       </span></span>
<span id="cb55-7"><a href="PCA.html#cb55-7"></a><span class="co">## 1 Devil_Mountain_Lake BELA        6.46  7.69 C          3.4   bound       </span></span>
<span id="cb55-8"><a href="PCA.html#cb55-8"></a><span class="co">## 2 Devil_Mountain_Lake BELA        6.46  7.69 N          0.028 bound       </span></span>
<span id="cb55-9"><a href="PCA.html#cb55-9"></a><span class="co">## 3 Devil_Mountain_Lake BELA        6.46  7.69 P          0     bound       </span></span>
<span id="cb55-10"><a href="PCA.html#cb55-10"></a><span class="co">## 4 Devil_Mountain_Lake BELA        6.46  7.69 Cl        10.4   free        </span></span>
<span id="cb55-11"><a href="PCA.html#cb55-11"></a><span class="co">## 5 Devil_Mountain_Lake BELA        6.46  7.69 S          0.62  free        </span></span>
<span id="cb55-12"><a href="PCA.html#cb55-12"></a><span class="co">## 6 Devil_Mountain_Lake BELA        6.46  7.69 F          0.04  free</span></span>
<span id="cb55-13"><a href="PCA.html#cb55-13"></a></span>
<span id="cb55-14"><a href="PCA.html#cb55-14"></a>AK_lakes_pca &lt;-<span class="st"> </span><span class="kw">runMatrixAnalysis</span>(</span>
<span id="cb55-15"><a href="PCA.html#cb55-15"></a>    <span class="dt">data =</span> AK_lakes,</span>
<span id="cb55-16"><a href="PCA.html#cb55-16"></a>    <span class="dt">analysis =</span> <span class="kw">c</span>(<span class="st">&quot;pca&quot;</span>),</span>
<span id="cb55-17"><a href="PCA.html#cb55-17"></a>    <span class="dt">column_w_names_of_multiple_analytes =</span> <span class="st">&quot;element&quot;</span>,</span>
<span id="cb55-18"><a href="PCA.html#cb55-18"></a>    <span class="dt">column_w_values_for_multiple_analytes =</span> <span class="st">&quot;mg_per_L&quot;</span>,</span>
<span id="cb55-19"><a href="PCA.html#cb55-19"></a>    <span class="dt">columns_w_values_for_single_analyte =</span> <span class="kw">c</span>(<span class="st">&quot;water_temp&quot;</span>, <span class="st">&quot;pH&quot;</span>),</span>
<span id="cb55-20"><a href="PCA.html#cb55-20"></a>    <span class="dt">columns_w_additional_analyte_info =</span> <span class="st">&quot;element_type&quot;</span>,</span>
<span id="cb55-21"><a href="PCA.html#cb55-21"></a>    <span class="dt">columns_w_sample_ID_info =</span> <span class="kw">c</span>(<span class="st">&quot;lake&quot;</span>, <span class="st">&quot;park&quot;</span>)</span>
<span id="cb55-22"><a href="PCA.html#cb55-22"></a>)</span>
<span id="cb55-23"><a href="PCA.html#cb55-23"></a><span class="co">## Not replacing any NAs in your data set</span></span>
<span id="cb55-24"><a href="PCA.html#cb55-24"></a></span>
<span id="cb55-25"><a href="PCA.html#cb55-25"></a><span class="kw">library</span>(ggrepel)</span>
<span id="cb55-26"><a href="PCA.html#cb55-26"></a></span>
<span id="cb55-27"><a href="PCA.html#cb55-27"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> AK_lakes_pca, <span class="kw">aes</span>(<span class="dt">x =</span> Dim<span class="fl">.1</span>, <span class="dt">y =</span> Dim<span class="fl">.2</span>)) <span class="op">+</span></span>
<span id="cb55-28"><a href="PCA.html#cb55-28"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> park), <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span></span>
<span id="cb55-29"><a href="PCA.html#cb55-29"></a><span class="st">    </span><span class="kw">geom_label_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> lake), <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb55-30"><a href="PCA.html#cb55-30"></a><span class="st">    </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-91-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Great! In this plot we can see that White Fish Lake and North Killeak Lake, both in BELA park, are quite different from the other parks (they are separated from the others along dimension 1, i.e. the first principal component). At the same time, Wild Lake, Iniakuk Lake, Walker Lake, and several other lakes in GAAR park are different from all the others (they are separated from the others along dimension 2, i.e. the second principal component).</p>
<p>Important question: what makes the lakes listed above different from the others? Certainly some aspect of their chemistry, since that’s the data that this analysis is built upon, but how do we determine which analyte(s) are driving the differences among the lakes that we see in the PCA plot?</p>
</div>
<div id="drivers-of-pca-dimensions" class="section level2">
<h2><span class="header-section-number">12.2</span> Drivers of PCA dimensions</h2>
<p>Let’s look at how to access the information about which analytes are major contributors to each principal component. This is important because it will tell you which analytes are associated with particular dimensions, and by extension, which analytes are associated with (and are markers for) particular groups in the PCA plot. This can be determined using an ordination plot. Let’s look at an example. We can obtain the ordination plot information using <code>runMatrixAnalysis()</code> with <code>analysis = "pca-ord"</code>:</p>
<pre><code>## Not replacing any NAs in your data set
## # A tibble: 6 x 3
##   analyte      Dim.1   Dim.2
##   &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;
## 1 water_temp 0.0769  -0.267 
## 2 pH         0.704    0.0190
## 3 C          0.297   -0.248 
## 4 N          0.00446  0.732 
## 5 P          0.485   -0.0817
## 6 Cl         0.978    0.0152</code></pre>
<p>We can now visualize the ordination plot using our standard ggplot plotting techniques. Note the use of <code>geom_label_repel()</code> and <code>filter()</code> to label certain segments in the ordination plot. You do not need to use <code>geom_label_repel()</code>, you could use the built in <code>geom_label()</code>, but <code>geom_label_repel()</code> can make labelling your segments easier.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="PCA.html#cb57-1"></a><span class="kw">source</span>(<span class="st">&quot;https://thebustalab.github.io/R_For_Chemists/custom_functions/chem.R&quot;</span>)</span>
<span id="cb57-2"><a href="PCA.html#cb57-2"></a>AK_lakes_pca_ord &lt;-<span class="st"> </span><span class="kw">runMatrixAnalysis</span>(</span>
<span id="cb57-3"><a href="PCA.html#cb57-3"></a>    <span class="dt">data =</span> AK_lakes,</span>
<span id="cb57-4"><a href="PCA.html#cb57-4"></a>    <span class="dt">analysis =</span> <span class="kw">c</span>(<span class="st">&quot;pca-ord&quot;</span>),</span>
<span id="cb57-5"><a href="PCA.html#cb57-5"></a>    <span class="dt">column_w_names_of_multiple_analytes =</span> <span class="st">&quot;element&quot;</span>,</span>
<span id="cb57-6"><a href="PCA.html#cb57-6"></a>    <span class="dt">column_w_values_for_multiple_analytes =</span> <span class="st">&quot;mg_per_L&quot;</span>,</span>
<span id="cb57-7"><a href="PCA.html#cb57-7"></a>    <span class="dt">columns_w_values_for_single_analyte =</span> <span class="kw">c</span>(<span class="st">&quot;water_temp&quot;</span>, <span class="st">&quot;pH&quot;</span>),</span>
<span id="cb57-8"><a href="PCA.html#cb57-8"></a>    <span class="dt">columns_w_additional_analyte_info =</span> <span class="st">&quot;element_type&quot;</span>,</span>
<span id="cb57-9"><a href="PCA.html#cb57-9"></a>    <span class="dt">columns_w_sample_ID_info =</span> <span class="kw">c</span>(<span class="st">&quot;lake&quot;</span>, <span class="st">&quot;park&quot;</span>)</span>
<span id="cb57-10"><a href="PCA.html#cb57-10"></a>)</span>
<span id="cb57-11"><a href="PCA.html#cb57-11"></a></span>
<span id="cb57-12"><a href="PCA.html#cb57-12"></a><span class="kw">library</span>(ggforce) <span class="co"># Gives access to geom_circle</span></span>
<span id="cb57-13"><a href="PCA.html#cb57-13"></a><span class="kw">library</span>(ggrepel) <span class="co"># Gives access to geom_label_repel</span></span>
<span id="cb57-14"><a href="PCA.html#cb57-14"></a><span class="kw">head</span>(AK_lakes_pca_ord)</span>
<span id="cb57-15"><a href="PCA.html#cb57-15"></a><span class="co">## # A tibble: 6 x 3</span></span>
<span id="cb57-16"><a href="PCA.html#cb57-16"></a><span class="co">##   analyte      Dim.1   Dim.2</span></span>
<span id="cb57-17"><a href="PCA.html#cb57-17"></a><span class="co">##   &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb57-18"><a href="PCA.html#cb57-18"></a><span class="co">## 1 water_temp 0.0769  -0.267 </span></span>
<span id="cb57-19"><a href="PCA.html#cb57-19"></a><span class="co">## 2 pH         0.704    0.0190</span></span>
<span id="cb57-20"><a href="PCA.html#cb57-20"></a><span class="co">## 3 C          0.297   -0.248 </span></span>
<span id="cb57-21"><a href="PCA.html#cb57-21"></a><span class="co">## 4 N          0.00446  0.732 </span></span>
<span id="cb57-22"><a href="PCA.html#cb57-22"></a><span class="co">## 5 P          0.485   -0.0817</span></span>
<span id="cb57-23"><a href="PCA.html#cb57-23"></a><span class="co">## 6 Cl         0.978    0.0152</span></span>
<span id="cb57-24"><a href="PCA.html#cb57-24"></a><span class="kw">ggplot</span>(AK_lakes_pca_ord) <span class="op">+</span></span>
<span id="cb57-25"><a href="PCA.html#cb57-25"></a><span class="st">    </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">xend =</span> Dim<span class="fl">.1</span>, <span class="dt">yend =</span> Dim<span class="fl">.2</span>, <span class="dt">color =</span> analyte), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb57-26"><a href="PCA.html#cb57-26"></a><span class="st">    </span><span class="kw">geom_circle</span>(<span class="kw">aes</span>(<span class="dt">x0 =</span> <span class="dv">0</span>, <span class="dt">y0 =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb57-27"><a href="PCA.html#cb57-27"></a><span class="st">  </span><span class="kw">geom_label_repel</span>(</span>
<span id="cb57-28"><a href="PCA.html#cb57-28"></a>    <span class="dt">data =</span> <span class="kw">filter</span>(AK_lakes_pca_ord, Dim<span class="fl">.1</span> <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.9</span>, Dim<span class="fl">.2</span> <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.1</span>, Dim<span class="fl">.2</span> <span class="op">&gt;</span><span class="st"> </span><span class="fl">-0.1</span>),</span>
<span id="cb57-29"><a href="PCA.html#cb57-29"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> Dim<span class="fl">.1</span>, <span class="dt">y =</span> Dim<span class="fl">.2</span>, <span class="dt">label =</span> analyte), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">1.5</span>)</span>
<span id="cb57-30"><a href="PCA.html#cb57-30"></a>  ) <span class="op">+</span></span>
<span id="cb57-31"><a href="PCA.html#cb57-31"></a><span class="st">  </span><span class="kw">geom_label_repel</span>(</span>
<span id="cb57-32"><a href="PCA.html#cb57-32"></a>    <span class="dt">data =</span> <span class="kw">filter</span>(AK_lakes_pca_ord, Dim<span class="fl">.2</span> <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>),</span>
<span id="cb57-33"><a href="PCA.html#cb57-33"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> Dim<span class="fl">.1</span>, <span class="dt">y =</span> Dim<span class="fl">.2</span>, <span class="dt">label =</span> analyte), <span class="dt">direction =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">1.5</span>)</span>
<span id="cb57-34"><a href="PCA.html#cb57-34"></a>  ) <span class="op">+</span></span>
<span id="cb57-35"><a href="PCA.html#cb57-35"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="fl">1.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="fl">1.5</span>)) <span class="op">+</span></span>
<span id="cb57-36"><a href="PCA.html#cb57-36"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-93-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Great! With this ordination plot we can now see that the abundances of K, Cl, Br, and Na are the major contributors of variance to the first principal component (or the first dimension). The abundances of these elements are what make White Fish Lake and North Killeak Lake different from the other lakes. We can also see that the abundances of N, S, and Ca are the major contributors to variance in teh second dimension, whic means that these elements ar what set Wild Lake, Iniakuk Lake, Walker Lake, and several other lakes in GAAR park apart from the rest of the lakes in the data set.</p>
</div>
<div id="comparing-principal-components" class="section level2">
<h2><span class="header-section-number">12.3</span> Comparing principal components</h2>
<p>We also can access information about the how much of the variance in the data set is explained by each principal component:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="PCA.html#cb58-1"></a>AK_lakes_pca_ord &lt;-<span class="st"> </span><span class="kw">runMatrixAnalysis</span>(</span>
<span id="cb58-2"><a href="PCA.html#cb58-2"></a>    <span class="dt">data =</span> AK_lakes,</span>
<span id="cb58-3"><a href="PCA.html#cb58-3"></a>    <span class="dt">analysis =</span> <span class="kw">c</span>(<span class="st">&quot;pca-dim&quot;</span>),</span>
<span id="cb58-4"><a href="PCA.html#cb58-4"></a>    <span class="dt">column_w_names_of_multiple_analytes =</span> <span class="st">&quot;element&quot;</span>,</span>
<span id="cb58-5"><a href="PCA.html#cb58-5"></a>    <span class="dt">column_w_values_for_multiple_analytes =</span> <span class="st">&quot;mg_per_L&quot;</span>,</span>
<span id="cb58-6"><a href="PCA.html#cb58-6"></a>    <span class="dt">columns_w_values_for_single_analyte =</span> <span class="kw">c</span>(<span class="st">&quot;water_temp&quot;</span>, <span class="st">&quot;pH&quot;</span>),</span>
<span id="cb58-7"><a href="PCA.html#cb58-7"></a>    <span class="dt">columns_w_additional_analyte_info =</span> <span class="st">&quot;element_type&quot;</span>,</span>
<span id="cb58-8"><a href="PCA.html#cb58-8"></a>    <span class="dt">columns_w_sample_ID_info =</span> <span class="kw">c</span>(<span class="st">&quot;lake&quot;</span>, <span class="st">&quot;park&quot;</span>)</span>
<span id="cb58-9"><a href="PCA.html#cb58-9"></a>)</span>
<span id="cb58-10"><a href="PCA.html#cb58-10"></a><span class="co">## Not replacing any NAs in your data set</span></span>
<span id="cb58-11"><a href="PCA.html#cb58-11"></a><span class="kw">head</span>(AK_lakes_pca_ord)</span>
<span id="cb58-12"><a href="PCA.html#cb58-12"></a><span class="co">## # A tibble: 6 x 2</span></span>
<span id="cb58-13"><a href="PCA.html#cb58-13"></a><span class="co">##   principal_component percent_variance_explained</span></span>
<span id="cb58-14"><a href="PCA.html#cb58-14"></a><span class="co">##                 &lt;dbl&gt;                      &lt;dbl&gt;</span></span>
<span id="cb58-15"><a href="PCA.html#cb58-15"></a><span class="co">## 1                   1                      48.8 </span></span>
<span id="cb58-16"><a href="PCA.html#cb58-16"></a><span class="co">## 2                   2                      18.6 </span></span>
<span id="cb58-17"><a href="PCA.html#cb58-17"></a><span class="co">## 3                   3                      11.6 </span></span>
<span id="cb58-18"><a href="PCA.html#cb58-18"></a><span class="co">## 4                   4                       7.88</span></span>
<span id="cb58-19"><a href="PCA.html#cb58-19"></a><span class="co">## 5                   5                       4.68</span></span>
<span id="cb58-20"><a href="PCA.html#cb58-20"></a><span class="co">## 6                   6                       3.33</span></span></code></pre></div>
<p>And we can now plot that using ggplot:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="PCA.html#cb59-1"></a><span class="kw">ggplot</span>(</span>
<span id="cb59-2"><a href="PCA.html#cb59-2"></a>  <span class="dt">data =</span> AK_lakes_pca_ord, </span>
<span id="cb59-3"><a href="PCA.html#cb59-3"></a>  <span class="kw">aes</span>(<span class="dt">x =</span> principal_component, <span class="dt">y =</span> percent_variance_explained)</span>
<span id="cb59-4"><a href="PCA.html#cb59-4"></a>) <span class="op">+</span></span>
<span id="cb59-5"><a href="PCA.html#cb59-5"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb59-6"><a href="PCA.html#cb59-6"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb59-7"><a href="PCA.html#cb59-7"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="bio723-book_files/figure-html/unnamed-chunk-95-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>Cool! We can see that the first principal component retains nearly 50% of the variance in the original dataset, while the second dimension contains only about 20%.
<!-- end --></p>
<!-- start Exercises 5 -->
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Exercises-4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Exercises-5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

</body>

</html>
