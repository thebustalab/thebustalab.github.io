<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 clustering | R For Chemists</title>
  <meta name="description" content="8 clustering | R For Chemists" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="8 clustering | R For Chemists" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 clustering | R For Chemists" />
  
  
  

<meta name="author" content="Lucas Busta" />


<meta name="date" content="2021-10-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Exercises_3.html"/>
<link rel="next" href="Exercises_4.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="tufte.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>1</b> installation</a>
<ul>
<li class="chapter" data-level="1.1" data-path="installation.html"><a href="installation.html#r"><i class="fa fa-check"></i><b>1.1</b> R</a></li>
<li class="chapter" data-level="1.2" data-path="installation.html"><a href="installation.html#rstudio"><i class="fa fa-check"></i><b>1.2</b> RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="installation.html"><a href="installation.html#verification"><i class="fa fa-check"></i><b>1.3</b> Verification</a></li>
<li class="chapter" data-level="1.4" data-path="installation.html"><a href="installation.html#tidyverse"><i class="fa fa-check"></i><b>1.4</b> tidyverse</a></li>
<li class="chapter" data-level="1.5" data-path="installation.html"><a href="installation.html#tex"><i class="fa fa-check"></i><b>1.5</b> TeX</a></li>
<li class="chapter" data-level="1.6" data-path="installation.html"><a href="installation.html#phylochemistry"><i class="fa fa-check"></i><b>1.6</b> phylochemistry</a></li>
<li class="chapter" data-level="1.7" data-path="installation.html"><a href="installation.html#xcms"><i class="fa fa-check"></i><b>1.7</b> xcms</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="R_Markdown.html"><a href="R_Markdown.html"><i class="fa fa-check"></i><b>2</b> ggplot and markdown</a>
<ul>
<li class="chapter" data-level="2.1" data-path="R_Markdown.html"><a href="R_Markdown.html#objects"><i class="fa fa-check"></i><b>2.1</b> Objects</a></li>
<li class="chapter" data-level="2.2" data-path="R_Markdown.html"><a href="R_Markdown.html#functions"><i class="fa fa-check"></i><b>2.2</b> Functions</a></li>
<li class="chapter" data-level="2.3" data-path="R_Markdown.html"><a href="R_Markdown.html#ggplot"><i class="fa fa-check"></i><b>2.3</b> ggplot</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="R_Markdown.html"><a href="R_Markdown.html#modifying-geoms"><i class="fa fa-check"></i><b>2.3.1</b> modifying geoms</a></li>
<li class="chapter" data-level="2.3.2" data-path="R_Markdown.html"><a href="R_Markdown.html#multiple-geoms"><i class="fa fa-check"></i><b>2.3.2</b> multiple geoms</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="R_Markdown.html"><a href="R_Markdown.html#markdown"><i class="fa fa-check"></i><b>2.4</b> markdown</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Exercises_1.html"><a href="Exercises_1.html"><i class="fa fa-check"></i><b>3</b> Exercises 1</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Exercises_1.html"><a href="Exercises_1.html#algae-chemistry-dataset"><i class="fa fa-check"></i><b>3.1</b> Algae Chemistry Dataset</a></li>
<li class="chapter" data-level="3.2" data-path="Exercises_1.html"><a href="Exercises_1.html#alaska-lakes-dataset"><i class="fa fa-check"></i><b>3.2</b> Alaska Lakes Dataset</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geoms_facets_scales_themes.html"><a href="geoms_facets_scales_themes.html"><i class="fa fa-check"></i><b>4</b> geoms, facets, scales, themes</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geoms_facets_scales_themes.html"><a href="geoms_facets_scales_themes.html#geoms"><i class="fa fa-check"></i><b>4.1</b> geoms</a></li>
<li class="chapter" data-level="4.2" data-path="geoms_facets_scales_themes.html"><a href="geoms_facets_scales_themes.html#facets"><i class="fa fa-check"></i><b>4.2</b> facets</a></li>
<li class="chapter" data-level="4.3" data-path="geoms_facets_scales_themes.html"><a href="geoms_facets_scales_themes.html#scales"><i class="fa fa-check"></i><b>4.3</b> scales</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="geoms_facets_scales_themes.html"><a href="geoms_facets_scales_themes.html#rcolorbrewer"><i class="fa fa-check"></i><b>4.3.1</b> RColorBrewer</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="geoms_facets_scales_themes.html"><a href="geoms_facets_scales_themes.html#themes"><i class="fa fa-check"></i><b>4.4</b> themes</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="geoms_facets_scales_themes.html"><a href="geoms_facets_scales_themes.html#complete-themes"><i class="fa fa-check"></i><b>4.4.1</b> Complete themes</a></li>
<li class="chapter" data-level="4.4.2" data-path="geoms_facets_scales_themes.html"><a href="geoms_facets_scales_themes.html#theme-components"><i class="fa fa-check"></i><b>4.4.2</b> Theme components</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="geoms_facets_scales_themes.html"><a href="geoms_facets_scales_themes.html#exercises"><i class="fa fa-check"></i><b>4.5</b> exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="import-and-tidying.html"><a href="import-and-tidying.html"><i class="fa fa-check"></i><b>5</b> import and tidying</a>
<ul>
<li class="chapter" data-level="5.1" data-path="import-and-tidying.html"><a href="import-and-tidying.html#data-import"><i class="fa fa-check"></i><b>5.1</b> data import</a></li>
<li class="chapter" data-level="5.2" data-path="import-and-tidying.html"><a href="import-and-tidying.html#tidy-data"><i class="fa fa-check"></i><b>5.2</b> tidy data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="summary_statistics.html"><a href="summary_statistics.html"><i class="fa fa-check"></i><b>6</b> the pipe and summaries</a>
<ul>
<li class="chapter" data-level="6.1" data-path="summary_statistics.html"><a href="summary_statistics.html#the-pipe"><i class="fa fa-check"></i><b>6.1</b> the pipe (%&gt;%)</a></li>
<li class="chapter" data-level="6.2" data-path="summary_statistics.html"><a href="summary_statistics.html#summary-statistics"><i class="fa fa-check"></i><b>6.2</b> summary statistics</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Exercises_3.html"><a href="Exercises_3.html"><i class="fa fa-check"></i><b>7</b> exercises 3</a></li>
<li class="chapter" data-level="8" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>8</b> clustering</a></li>
<li class="chapter" data-level="9" data-path="Exercises_4.html"><a href="Exercises_4.html"><i class="fa fa-check"></i><b>9</b> exercises 4</a></li>
<li class="chapter" data-level="10" data-path="PCA.html"><a href="PCA.html"><i class="fa fa-check"></i><b>10</b> pca</a>
<ul>
<li class="chapter" data-level="10.1" data-path="PCA.html"><a href="PCA.html#pca"><i class="fa fa-check"></i><b>10.1</b> pca</a></li>
<li class="chapter" data-level="10.2" data-path="PCA.html"><a href="PCA.html#ordination-plots"><i class="fa fa-check"></i><b>10.2</b> ordination plots</a></li>
<li class="chapter" data-level="10.3" data-path="PCA.html"><a href="PCA.html#principal-components"><i class="fa fa-check"></i><b>10.3</b> principal components</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="Exercises_5.html"><a href="Exercises_5.html"><i class="fa fa-check"></i><b>11</b> exercises 5</a>
<ul>
<li class="chapter" data-level="11.1" data-path="Exercises_5.html"><a href="Exercises_5.html#option-1-human-metabolomics."><i class="fa fa-check"></i><b>11.1</b> option 1: human metabolomics.</a></li>
<li class="chapter" data-level="11.2" data-path="Exercises_5.html"><a href="Exercises_5.html#option-2-grape-vine-chemistry"><i class="fa fa-check"></i><b>11.2</b> option 2: grape vine chemistry</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="k-means.html"><a href="k-means.html"><i class="fa fa-check"></i><b>12</b> k-means</a>
<ul>
<li class="chapter" data-level="12.1" data-path="k-means.html"><a href="k-means.html#theory"><i class="fa fa-check"></i><b>12.1</b> theory</a></li>
<li class="chapter" data-level="12.2" data-path="k-means.html"><a href="k-means.html#exercises-1"><i class="fa fa-check"></i><b>12.2</b> exercises</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="k-means.html"><a href="k-means.html#question-1"><i class="fa fa-check"></i><b>12.2.1</b> Question 1</a></li>
<li class="chapter" data-level="12.2.2" data-path="k-means.html"><a href="k-means.html#question-2"><i class="fa fa-check"></i><b>12.2.2</b> Question 2</a></li>
<li class="chapter" data-level="12.2.3" data-path="k-means.html"><a href="k-means.html#question-3"><i class="fa fa-check"></i><b>12.2.3</b> Question 3</a></li>
<li class="chapter" data-level="12.2.4" data-path="k-means.html"><a href="k-means.html#question-4"><i class="fa fa-check"></i><b>12.2.4</b> Question 4</a></li>
<li class="chapter" data-level="12.2.5" data-path="k-means.html"><a href="k-means.html#question-5"><i class="fa fa-check"></i><b>12.2.5</b> Question 5</a></li>
<li class="chapter" data-level="12.2.6" data-path="k-means.html"><a href="k-means.html#question-6"><i class="fa fa-check"></i><b>12.2.6</b> Question 6</a></li>
<li class="chapter" data-level="12.2.7" data-path="k-means.html"><a href="k-means.html#question-7"><i class="fa fa-check"></i><b>12.2.7</b> Question 7</a></li>
<li class="chapter" data-level="12.2.8" data-path="k-means.html"><a href="k-means.html#challenge-optional"><i class="fa fa-check"></i><b>12.2.8</b> Challenge (optional)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="wrangling-2.html"><a href="wrangling-2.html"><i class="fa fa-check"></i><b>13</b> wrangling 2</a>
<ul>
<li class="chapter" data-level="13.1" data-path="wrangling-2.html"><a href="wrangling-2.html#subsetting"><i class="fa fa-check"></i><b>13.1</b> subsetting</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="writing.html"><a href="writing.html"><i class="fa fa-check"></i><b>14</b> Writing</a>
<ul>
<li class="chapter" data-level="14.1" data-path="writing.html"><a href="writing.html#captions"><i class="fa fa-check"></i><b>14.1</b> Captions</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="links.html"><a href="links.html"><i class="fa fa-check"></i><b>15</b> links</a>
<ul>
<li class="chapter" data-level="15.1" data-path="links.html"><a href="links.html#geoms-1"><i class="fa fa-check"></i><b>15.1</b> geoms</a></li>
<li class="chapter" data-level="15.2" data-path="links.html"><a href="links.html#colors"><i class="fa fa-check"></i><b>15.2</b> colors</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>16</b> FAQ</a>
<ul>
<li class="chapter" data-level="16.1" data-path="faq.html"><a href="faq.html#filtering"><i class="fa fa-check"></i><b>16.1</b> filtering</a></li>
<li class="chapter" data-level="16.2" data-path="faq.html"><a href="faq.html#ordering"><i class="fa fa-check"></i><b>16.2</b> ordering</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="templates.html"><a href="templates.html"><i class="fa fa-check"></i><b>17</b> templates</a>
<ul>
<li class="chapter" data-level="17.1" data-path="templates.html"><a href="templates.html#matrix-analyses"><i class="fa fa-check"></i><b>17.1</b> matrix analyses</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="templates.html"><a href="templates.html#basic-runmatrixanalysis-template"><i class="fa fa-check"></i><b>17.1.1</b> basic <code>runMatrixAnalysis()</code> template</a></li>
<li class="chapter" data-level="17.1.2" data-path="templates.html"><a href="templates.html#advanced-runmatrixanalysis-template"><i class="fa fa-check"></i><b>17.1.2</b> advanced <code>runMatrixAnalysis()</code> template</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R For Chemists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="clustering" class="section level1" number="8">
<h1><span class="header-section-number">8</span> clustering</h1>
<p>So far we have been looking at how to plot raw data, as well as data that has been summarize across samples. This is important stuff and very useful. However, we often have questions about how samples in our datasets relate to one another. For example: in the Alaska lakes dataset, which lake is most similar, chemically speaking, to Lake Narvakrak? Answering this requires calculating numeric distances between samples based on their chemical properties. For this, and other questions, we need to use matrix analyses. For this, we will use <code>runMatrixAnalysis()</code>, a function that is loaded into your R Session when you run the source() command.</p>
<p>Matrix analyses can be a bit difficult to set up. There are two things that we can do to help us with this: (i) we will use a template for <code>runMatrixAnalysis()</code> (see below) and (ii) it is <em>critical</em> that we think about our data in terms of <strong>samples</strong> and <strong>analytes</strong>. Let’s consider our Alaska lakes data set:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="clustering.html#cb54-1" aria-hidden="true" tabindex="-1"></a>alaska_lake_data</span>
<span id="cb54-2"><a href="clustering.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 220 × 7</span></span>
<span id="cb54-3"><a href="clustering.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="do">##    lake                park  water_temp    pH element mg_per_L element_type</span></span>
<span id="cb54-4"><a href="clustering.html#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;chr&gt;               &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;       </span></span>
<span id="cb54-5"><a href="clustering.html#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 Devil_Mountain_Lake BELA        6.46  7.69 C          3.4   bound       </span></span>
<span id="cb54-6"><a href="clustering.html#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 Devil_Mountain_Lake BELA        6.46  7.69 N          0.028 bound       </span></span>
<span id="cb54-7"><a href="clustering.html#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 Devil_Mountain_Lake BELA        6.46  7.69 P          0     bound       </span></span>
<span id="cb54-8"><a href="clustering.html#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 Devil_Mountain_Lake BELA        6.46  7.69 Cl        10.4   free        </span></span>
<span id="cb54-9"><a href="clustering.html#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 Devil_Mountain_Lake BELA        6.46  7.69 S          0.62  free        </span></span>
<span id="cb54-10"><a href="clustering.html#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 Devil_Mountain_Lake BELA        6.46  7.69 F          0.04  free        </span></span>
<span id="cb54-11"><a href="clustering.html#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 Devil_Mountain_Lake BELA        6.46  7.69 Br         0.02  free        </span></span>
<span id="cb54-12"><a href="clustering.html#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 Devil_Mountain_Lake BELA        6.46  7.69 Na         8.92  free        </span></span>
<span id="cb54-13"><a href="clustering.html#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 Devil_Mountain_Lake BELA        6.46  7.69 K          1.2   free        </span></span>
<span id="cb54-14"><a href="clustering.html#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 Devil_Mountain_Lake BELA        6.46  7.69 Ca         5.73  free        </span></span>
<span id="cb54-15"><a href="clustering.html#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="do">## # … with 210 more rows</span></span></code></pre></div>
<p>We can see that this dataset is comprised of measurements of various <em>analytes</em> (i.e. several chemical elements, as well as water_temp, and pH), in different <em>samples</em> (i.e. lakes). We need to tell the <code>runMatrixAnalysis()</code> function how each column relates to this samples and analytes structure. See the image below for an explanation.</p>
<p><img src="http://thebustalab.github.io/R_For_Chemists_2/images/runMatrixAnalysis1.png" style="display: block; margin: auto;" /></p>
<p>With this in mind, let’s try out our template:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="clustering.html#cb55-1" aria-hidden="true" tabindex="-1"></a>AK_lakes_clustered <span class="ot">&lt;-</span> <span class="fu">runMatrixAnalysis</span>(</span>
<span id="cb55-2"><a href="clustering.html#cb55-2" aria-hidden="true" tabindex="-1"></a>                                </span>
<span id="cb55-3"><a href="clustering.html#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> alaska_lake_data,</span>
<span id="cb55-4"><a href="clustering.html#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="clustering.html#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">analysis =</span> <span class="st">&quot;hclust&quot;</span>,</span>
<span id="cb55-6"><a href="clustering.html#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="clustering.html#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_w_names_of_multiple_analytes =</span> <span class="st">&quot;element&quot;</span>,</span>
<span id="cb55-8"><a href="clustering.html#cb55-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_w_values_for_multiple_analytes =</span> <span class="st">&quot;mg_per_L&quot;</span>,</span>
<span id="cb55-9"><a href="clustering.html#cb55-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-10"><a href="clustering.html#cb55-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns_w_values_for_single_analyte =</span> <span class="fu">c</span>(<span class="st">&quot;water_temp&quot;</span>, <span class="st">&quot;pH&quot;</span>),</span>
<span id="cb55-11"><a href="clustering.html#cb55-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-12"><a href="clustering.html#cb55-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns_w_additional_analyte_info =</span> <span class="st">&quot;element_type&quot;</span>,</span>
<span id="cb55-13"><a href="clustering.html#cb55-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-14"><a href="clustering.html#cb55-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns_w_sample_ID_info =</span> <span class="fu">c</span>(<span class="st">&quot;lake&quot;</span>, <span class="st">&quot;park&quot;</span>)</span>
<span id="cb55-15"><a href="clustering.html#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="clustering.html#cb55-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-17"><a href="clustering.html#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Analytes are all numeric and compatible with the analysis selected.</span></span>
<span id="cb55-18"><a href="clustering.html#cb55-18" aria-hidden="true" tabindex="-1"></a>AK_lakes_clustered</span>
<span id="cb55-19"><a href="clustering.html#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 39 × 25</span></span>
<span id="cb55-20"><a href="clustering.html#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="do">##    sample_unique_ID  lake    park  parent  node branch.length label  isTip     x</span></span>
<span id="cb55-21"><a href="clustering.html#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;chr&gt;             &lt;chr&gt;   &lt;chr&gt;  &lt;int&gt; &lt;int&gt;         &lt;dbl&gt; &lt;chr&gt;  &lt;lgl&gt; &lt;dbl&gt;</span></span>
<span id="cb55-22"><a href="clustering.html#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 Devil_Mountain_L… Devil_… BELA      33     1          7.25 Devil… TRUE   204.</span></span>
<span id="cb55-23"><a href="clustering.html#cb55-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 Imuruk_Lake_BELA  Imuruk… BELA      32     2          4.91 Imuru… TRUE   204.</span></span>
<span id="cb55-24"><a href="clustering.html#cb55-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 Kuzitrin_Lake_BE… Kuzitr… BELA      36     3          3.27 Kuzit… TRUE   204.</span></span>
<span id="cb55-25"><a href="clustering.html#cb55-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 Lava_Lake_BELA    Lava_L… BELA      35     4          3.02 Lava_… TRUE   204.</span></span>
<span id="cb55-26"><a href="clustering.html#cb55-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 North_Killeak_La… North_… BELA      21     5        204.   North… TRUE   204.</span></span>
<span id="cb55-27"><a href="clustering.html#cb55-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 White_Fish_Lake_… White_… BELA      22     6         65.2  White… TRUE   204.</span></span>
<span id="cb55-28"><a href="clustering.html#cb55-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 Iniakuk_Lake_GAAR Iniaku… GAAR      29     7          3.60 Iniak… TRUE   204.</span></span>
<span id="cb55-29"><a href="clustering.html#cb55-29" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 Kurupa_Lake_GAAR  Kurupa… GAAR      31     8          8.57 Kurup… TRUE   204.</span></span>
<span id="cb55-30"><a href="clustering.html#cb55-30" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 Lake_Matcharak_G… Lake_M… GAAR      29     9          3.60 Lake_… TRUE   204.</span></span>
<span id="cb55-31"><a href="clustering.html#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 Lake_Selby_GAAR   Lake_S… GAAR      30    10          5.24 Lake_… TRUE   204.</span></span>
<span id="cb55-32"><a href="clustering.html#cb55-32" aria-hidden="true" tabindex="-1"></a><span class="do">## # … with 29 more rows, and 16 more variables: y &lt;dbl&gt;, branch &lt;dbl&gt;,</span></span>
<span id="cb55-33"><a href="clustering.html#cb55-33" aria-hidden="true" tabindex="-1"></a><span class="do">## #   angle &lt;dbl&gt;, water_temp &lt;dbl&gt;, pH &lt;dbl&gt;, C &lt;dbl&gt;, N &lt;dbl&gt;, P &lt;dbl&gt;,</span></span>
<span id="cb55-34"><a href="clustering.html#cb55-34" aria-hidden="true" tabindex="-1"></a><span class="do">## #   Cl &lt;dbl&gt;, S &lt;dbl&gt;, F &lt;dbl&gt;, Br &lt;dbl&gt;, Na &lt;dbl&gt;, K &lt;dbl&gt;, Ca &lt;dbl&gt;, Mg &lt;dbl&gt;</span></span></code></pre></div>
<p>It works! Now we can plot our cluster diagram with a ggplot add-on called ggtree. We’ve seen that ggplot takes a “data” argument (i.e. <code>ggplot(data = &lt;some_data&gt;) + geom_*()</code> etc.). In contrast, ggtree takes an argument called <code>tr</code>, though if you’re using the <code>runMatrixAnalysis()</code> function, you can treat these two (<code>data</code> and <code>tr</code>) the same, so, use: <code>ggtree(tr = &lt;output_from_runMatrixAnalysis&gt;) + geom_*()</code> etc.</p>
<p>Note that <code>ggtree</code> also comes with several great new geoms: <code>geom_tiplab()</code> and <code>geom_tippoint()</code>. Let’s try those out:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="clustering.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtree)</span>
<span id="cb56-2"><a href="clustering.html#cb56-2" aria-hidden="true" tabindex="-1"></a>AK_lakes_clustered <span class="sc">%&gt;%</span></span>
<span id="cb56-3"><a href="clustering.html#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtree</span>() <span class="sc">+</span></span>
<span id="cb56-4"><a href="clustering.html#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tiplab</span>() <span class="sc">+</span></span>
<span id="cb56-5"><a href="clustering.html#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tippoint</span>() <span class="sc">+</span></span>
<span id="cb56-6"><a href="clustering.html#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-87-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Cool! Though that plot could use some tweaking… let’s try:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="clustering.html#cb57-1" aria-hidden="true" tabindex="-1"></a>AK_lakes_clustered <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="clustering.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtree</span>() <span class="sc">+</span></span>
<span id="cb57-3"><a href="clustering.html#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tiplab</span>(<span class="fu">aes</span>(<span class="at">label =</span> lake), <span class="at">offset =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb57-4"><a href="clustering.html#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tippoint</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="fu">aes</span>(<span class="at">fill =</span> park), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb57-5"><a href="clustering.html#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">400</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-88-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Very nice!
<!-- end --></p>
<!-- start exercises 4-->
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Exercises_3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Exercises_4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "sepia",
"family": "serif",
"size": 1
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "section"
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

</body>

</html>
