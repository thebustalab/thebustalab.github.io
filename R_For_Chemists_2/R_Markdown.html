<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 ggplot and markdown | R For Chemists</title>
  <meta name="description" content="2 ggplot and markdown | R For Chemists" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="2 ggplot and markdown | R For Chemists" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 ggplot and markdown | R For Chemists" />
  
  
  

<meta name="author" content="Lucas Busta" />


<meta name="date" content="2021-12-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-visualization.html"/>
<link rel="next" href="geoms_facets_scales_themes.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="tufte.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="section.html#section"></a></li>
<li class="chapter" data-level="" data-path="r-for-chemists.html"><a href="r-for-chemists.html"><i class="fa fa-check"></i>R FOR CHEMISTS</a></li>
<li><a href="section-1.html#section-1"></a></li>
<li class="chapter" data-level="" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i>GETTING STARTED</a></li>
<li class="chapter" data-level="1" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>1</b> installation</a>
<ul>
<li class="chapter" data-level="1.1" data-path="installation.html"><a href="installation.html#r"><i class="fa fa-check"></i><b>1.1</b> R</a></li>
<li class="chapter" data-level="1.2" data-path="installation.html"><a href="installation.html#rstudio"><i class="fa fa-check"></i><b>1.2</b> RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="installation.html"><a href="installation.html#verification"><i class="fa fa-check"></i><b>1.3</b> Verification</a></li>
<li class="chapter" data-level="1.4" data-path="installation.html"><a href="installation.html#tidyverse"><i class="fa fa-check"></i><b>1.4</b> tidyverse</a></li>
<li class="chapter" data-level="1.5" data-path="installation.html"><a href="installation.html#tex"><i class="fa fa-check"></i><b>1.5</b> TeX</a></li>
<li class="chapter" data-level="1.6" data-path="installation.html"><a href="installation.html#phylochemistry"><i class="fa fa-check"></i><b>1.6</b> phylochemistry</a></li>
<li class="chapter" data-level="1.7" data-path="installation.html"><a href="installation.html#xcms"><i class="fa fa-check"></i><b>1.7</b> xcms</a></li>
<li class="chapter" data-level="1.8" data-path="installation.html"><a href="installation.html#updating-r-and-r-packages"><i class="fa fa-check"></i><b>1.8</b> Updating R and R Packages</a></li>
</ul></li>
<li><a href="section-2.html#section-2"></a></li>
<li class="chapter" data-level="" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i>DATA VISUALIZATION</a></li>
<li class="chapter" data-level="2" data-path="R_Markdown.html"><a href="R_Markdown.html"><i class="fa fa-check"></i><b>2</b> ggplot and markdown</a>
<ul>
<li class="chapter" data-level="2.1" data-path="R_Markdown.html"><a href="R_Markdown.html#objects"><i class="fa fa-check"></i><b>2.1</b> Objects</a></li>
<li class="chapter" data-level="2.2" data-path="R_Markdown.html"><a href="R_Markdown.html#functions"><i class="fa fa-check"></i><b>2.2</b> Functions</a></li>
<li class="chapter" data-level="2.3" data-path="R_Markdown.html"><a href="R_Markdown.html#ggplot"><i class="fa fa-check"></i><b>2.3</b> ggplot</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="R_Markdown.html"><a href="R_Markdown.html#modifying-geoms"><i class="fa fa-check"></i><b>2.3.1</b> modifying geoms</a></li>
<li class="chapter" data-level="2.3.2" data-path="R_Markdown.html"><a href="R_Markdown.html#multiple-geoms"><i class="fa fa-check"></i><b>2.3.2</b> multiple geoms</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="R_Markdown.html"><a href="R_Markdown.html#markdown"><i class="fa fa-check"></i><b>2.4</b> markdown</a></li>
<li class="chapter" data-level="2.5" data-path="R_Markdown.html"><a href="R_Markdown.html#exercises"><i class="fa fa-check"></i><b>2.5</b> exercises</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="R_Markdown.html"><a href="R_Markdown.html#algae-chemistry-dataset"><i class="fa fa-check"></i><b>2.5.1</b> Algae Chemistry Dataset</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="R_Markdown.html"><a href="R_Markdown.html#alaska-lakes-dataset"><i class="fa fa-check"></i><b>2.6</b> Alaska Lakes Dataset</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="geoms_facets_scales_themes.html"><a href="geoms_facets_scales_themes.html"><i class="fa fa-check"></i><b>3</b> geoms, facets, scales, themes</a>
<ul>
<li class="chapter" data-level="3.1" data-path="geoms_facets_scales_themes.html"><a href="geoms_facets_scales_themes.html#geoms"><i class="fa fa-check"></i><b>3.1</b> geoms</a></li>
<li class="chapter" data-level="3.2" data-path="geoms_facets_scales_themes.html"><a href="geoms_facets_scales_themes.html#facets"><i class="fa fa-check"></i><b>3.2</b> facets</a></li>
<li class="chapter" data-level="3.3" data-path="geoms_facets_scales_themes.html"><a href="geoms_facets_scales_themes.html#scales"><i class="fa fa-check"></i><b>3.3</b> scales</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="geoms_facets_scales_themes.html"><a href="geoms_facets_scales_themes.html#rcolorbrewer"><i class="fa fa-check"></i><b>3.3.1</b> RColorBrewer</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="geoms_facets_scales_themes.html"><a href="geoms_facets_scales_themes.html#themes"><i class="fa fa-check"></i><b>3.4</b> themes</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="geoms_facets_scales_themes.html"><a href="geoms_facets_scales_themes.html#complete-themes"><i class="fa fa-check"></i><b>3.4.1</b> Complete themes</a></li>
<li class="chapter" data-level="3.4.2" data-path="geoms_facets_scales_themes.html"><a href="geoms_facets_scales_themes.html#theme-components"><i class="fa fa-check"></i><b>3.4.2</b> Theme components</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="geoms_facets_scales_themes.html"><a href="geoms_facets_scales_themes.html#exercises-1"><i class="fa fa-check"></i><b>3.5</b> exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="import-and-tidying.html"><a href="import-and-tidying.html"><i class="fa fa-check"></i><b>4</b> import and tidying</a>
<ul>
<li class="chapter" data-level="4.1" data-path="import-and-tidying.html"><a href="import-and-tidying.html#data-import"><i class="fa fa-check"></i><b>4.1</b> data import</a></li>
<li class="chapter" data-level="4.2" data-path="import-and-tidying.html"><a href="import-and-tidying.html#tidy-data"><i class="fa fa-check"></i><b>4.2</b> tidy data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="summary_statistics.html"><a href="summary_statistics.html"><i class="fa fa-check"></i><b>5</b> the pipe and summaries</a>
<ul>
<li class="chapter" data-level="5.1" data-path="summary_statistics.html"><a href="summary_statistics.html#the-pipe"><i class="fa fa-check"></i><b>5.1</b> the pipe (%&gt;%)</a></li>
<li class="chapter" data-level="5.2" data-path="summary_statistics.html"><a href="summary_statistics.html#summary-statistics"><i class="fa fa-check"></i><b>5.2</b> summary statistics</a></li>
<li class="chapter" data-level="5.3" data-path="summary_statistics.html"><a href="summary_statistics.html#exercises-2"><i class="fa fa-check"></i><b>5.3</b> exercises</a></li>
</ul></li>
<li><a href="section-3.html#section-3"></a></li>
<li class="chapter" data-level="" data-path="chemometrics.html"><a href="chemometrics.html"><i class="fa fa-check"></i>CHEMOMETRICS</a></li>
<li class="chapter" data-level="6" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>6</b> clustering</a>
<ul>
<li class="chapter" data-level="6.1" data-path="clustering.html"><a href="clustering.html#theory"><i class="fa fa-check"></i><b>6.1</b> theory</a></li>
<li class="chapter" data-level="6.2" data-path="clustering.html"><a href="clustering.html#exercises-3"><i class="fa fa-check"></i><b>6.2</b> exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="PCA.html"><a href="PCA.html"><i class="fa fa-check"></i><b>7</b> pca</a>
<ul>
<li class="chapter" data-level="7.1" data-path="PCA.html"><a href="PCA.html#pca"><i class="fa fa-check"></i><b>7.1</b> pca</a></li>
<li class="chapter" data-level="7.2" data-path="PCA.html"><a href="PCA.html#ordination-plots"><i class="fa fa-check"></i><b>7.2</b> ordination plots</a></li>
<li class="chapter" data-level="7.3" data-path="PCA.html"><a href="PCA.html#principal-components"><i class="fa fa-check"></i><b>7.3</b> principal components</a></li>
<li class="chapter" data-level="7.4" data-path="PCA.html"><a href="PCA.html#exercises-4"><i class="fa fa-check"></i><b>7.4</b> exercises</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="PCA.html"><a href="PCA.html#option-1-human-metabolomics."><i class="fa fa-check"></i><b>7.4.1</b> option 1: human metabolomics.</a></li>
<li class="chapter" data-level="7.4.2" data-path="PCA.html"><a href="PCA.html#option-2-grape-vine-chemistry"><i class="fa fa-check"></i><b>7.4.2</b> option 2: grape vine chemistry</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="k-means.html"><a href="k-means.html"><i class="fa fa-check"></i><b>8</b> k-means</a>
<ul>
<li class="chapter" data-level="8.1" data-path="k-means.html"><a href="k-means.html#theory-1"><i class="fa fa-check"></i><b>8.1</b> theory</a></li>
<li class="chapter" data-level="8.2" data-path="k-means.html"><a href="k-means.html#exercises-5"><i class="fa fa-check"></i><b>8.2</b> exercises</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="k-means.html"><a href="k-means.html#question-1"><i class="fa fa-check"></i><b>8.2.1</b> Question 1</a></li>
<li class="chapter" data-level="8.2.2" data-path="k-means.html"><a href="k-means.html#question-2"><i class="fa fa-check"></i><b>8.2.2</b> Question 2</a></li>
<li class="chapter" data-level="8.2.3" data-path="k-means.html"><a href="k-means.html#question-3"><i class="fa fa-check"></i><b>8.2.3</b> Question 3</a></li>
<li class="chapter" data-level="8.2.4" data-path="k-means.html"><a href="k-means.html#question-4"><i class="fa fa-check"></i><b>8.2.4</b> Question 4</a></li>
<li class="chapter" data-level="8.2.5" data-path="k-means.html"><a href="k-means.html#question-5"><i class="fa fa-check"></i><b>8.2.5</b> Question 5</a></li>
<li class="chapter" data-level="8.2.6" data-path="k-means.html"><a href="k-means.html#question-6"><i class="fa fa-check"></i><b>8.2.6</b> Question 6</a></li>
<li class="chapter" data-level="8.2.7" data-path="k-means.html"><a href="k-means.html#question-7"><i class="fa fa-check"></i><b>8.2.7</b> Question 7</a></li>
<li class="chapter" data-level="8.2.8" data-path="k-means.html"><a href="k-means.html#challenge-optional"><i class="fa fa-check"></i><b>8.2.8</b> Challenge (optional)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="models.html"><a href="models.html"><i class="fa fa-check"></i><b>9</b> models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="models.html"><a href="models.html#theory-2"><i class="fa fa-check"></i><b>9.1</b> theory</a></li>
<li class="chapter" data-level="9.2" data-path="models.html"><a href="models.html#exercises-6"><i class="fa fa-check"></i><b>9.2</b> exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="comparing-means.html"><a href="comparing-means.html"><i class="fa fa-check"></i><b>10</b> comparing means</a>
<ul>
<li class="chapter" data-level="10.1" data-path="comparing-means.html"><a href="comparing-means.html#definitions"><i class="fa fa-check"></i><b>10.1</b> definitions</a></li>
<li class="chapter" data-level="10.2" data-path="comparing-means.html"><a href="comparing-means.html#test-selection"><i class="fa fa-check"></i><b>10.2</b> test selection</a></li>
<li class="chapter" data-level="10.3" data-path="comparing-means.html"><a href="comparing-means.html#two-means"><i class="fa fa-check"></i><b>10.3</b> two means</a></li>
<li class="chapter" data-level="10.4" data-path="comparing-means.html"><a href="comparing-means.html#more-than-two-means"><i class="fa fa-check"></i><b>10.4</b> more than two means</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="comparing-means.html"><a href="comparing-means.html#anova-tukey-tests"><i class="fa fa-check"></i><b>10.4.1</b> ANOVA, Tukey tests</a></li>
<li class="chapter" data-level="10.4.2" data-path="comparing-means.html"><a href="comparing-means.html#kruskal-dunn-tests"><i class="fa fa-check"></i><b>10.4.2</b> Kruskal, Dunn tests</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="comparing-means.html"><a href="comparing-means.html#pairs-of-means"><i class="fa fa-check"></i><b>10.5</b> pairs of means</a></li>
<li class="chapter" data-level="10.6" data-path="comparing-means.html"><a href="comparing-means.html#further-reading"><i class="fa fa-check"></i><b>10.6</b> further reading</a></li>
<li class="chapter" data-level="10.7" data-path="comparing-means.html"><a href="comparing-means.html#exercises-7"><i class="fa fa-check"></i><b>10.7</b> exercises</a></li>
</ul></li>
<li><a href="section-4.html#section-4"></a></li>
<li class="chapter" data-level="" data-path="writing.html"><a href="writing.html"><i class="fa fa-check"></i>WRITING</a></li>
<li class="chapter" data-level="11" data-path="figures-captions.html"><a href="figures-captions.html"><i class="fa fa-check"></i><b>11</b> figures &amp; captions</a></li>
<li class="chapter" data-level="12" data-path="results-and-discussion.html"><a href="results-and-discussion.html"><i class="fa fa-check"></i><b>12</b> results and discussion</a>
<ul>
<li class="chapter" data-level="12.1" data-path="results-and-discussion.html"><a href="results-and-discussion.html#structure"><i class="fa fa-check"></i><b>12.1</b> structure</a></li>
<li class="chapter" data-level="12.2" data-path="results-and-discussion.html"><a href="results-and-discussion.html#suggestions"><i class="fa fa-check"></i><b>12.2</b> suggestions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="conclusion-and-introduction.html"><a href="conclusion-and-introduction.html"><i class="fa fa-check"></i><b>13</b> conclusion and introduction</a>
<ul>
<li class="chapter" data-level="13.1" data-path="conclusion-and-introduction.html"><a href="conclusion-and-introduction.html#structure-1"><i class="fa fa-check"></i><b>13.1</b> structure</a></li>
<li class="chapter" data-level="13.2" data-path="conclusion-and-introduction.html"><a href="conclusion-and-introduction.html#suggestions-1"><i class="fa fa-check"></i><b>13.2</b> suggestions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="abstract-and-title.html"><a href="abstract-and-title.html"><i class="fa fa-check"></i><b>14</b> abstract and title</a>
<ul>
<li class="chapter" data-level="14.1" data-path="abstract-and-title.html"><a href="abstract-and-title.html#abstract"><i class="fa fa-check"></i><b>14.1</b> abstract</a></li>
<li class="chapter" data-level="14.2" data-path="abstract-and-title.html"><a href="abstract-and-title.html#title"><i class="fa fa-check"></i><b>14.2</b> title</a></li>
<li class="chapter" data-level="14.3" data-path="abstract-and-title.html"><a href="abstract-and-title.html#further-reading-1"><i class="fa fa-check"></i><b>14.3</b> further reading</a></li>
</ul></li>
<li><a href="section-5.html#section-5"></a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>APPENDIX</a></li>
<li class="chapter" data-level="15" data-path="links.html"><a href="links.html"><i class="fa fa-check"></i><b>15</b> links</a>
<ul>
<li class="chapter" data-level="15.1" data-path="links.html"><a href="links.html#geoms-1"><i class="fa fa-check"></i><b>15.1</b> geoms</a></li>
<li class="chapter" data-level="15.2" data-path="links.html"><a href="links.html#colors"><i class="fa fa-check"></i><b>15.2</b> colors</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>16</b> faq</a>
<ul>
<li class="chapter" data-level="16.1" data-path="faq.html"><a href="faq.html#filtering"><i class="fa fa-check"></i><b>16.1</b> filtering</a></li>
<li class="chapter" data-level="16.2" data-path="faq.html"><a href="faq.html#ordering"><i class="fa fa-check"></i><b>16.2</b> ordering</a></li>
<li class="chapter" data-level="16.3" data-path="faq.html"><a href="faq.html#column-manipulation"><i class="fa fa-check"></i><b>16.3</b> column manipulation</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="templates.html"><a href="templates.html"><i class="fa fa-check"></i><b>17</b> templates</a>
<ul>
<li class="chapter" data-level="17.1" data-path="templates.html"><a href="templates.html#matrix-analyses"><i class="fa fa-check"></i><b>17.1</b> matrix analyses</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="templates.html"><a href="templates.html#basic-runmatrixanalysis-template"><i class="fa fa-check"></i><b>17.1.1</b> basic <code>runMatrixAnalysis()</code> template</a></li>
<li class="chapter" data-level="17.1.2" data-path="templates.html"><a href="templates.html#advanced-runmatrixanalysis-template"><i class="fa fa-check"></i><b>17.1.2</b> advanced <code>runMatrixAnalysis()</code> template</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R For Chemists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="R_Markdown" class="section level1" number="2">
<h1><span class="header-section-number">2</span> ggplot and markdown</h1>
<div id="objects" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Objects</h2>
<p>Ok, we’ve got the installation out of the way. Let’s get down to working with data and generating reports! In R, data is stored in objects. You can think of objects as if they were “files” inside an R session. <code>phylochemistry</code> provides a variety of objects for us to work with.</p>
<p>Let’s look at how to create an object. For this, we can use an arrow: <code>&lt;-</code> . The arrow will take something and store it inside an object. For example:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="R_Markdown.html#cb12-1" aria-hidden="true" tabindex="-1"></a>new_object <span class="ot">&lt;-</span> <span class="dv">1</span></span></code></pre></div>
<p>Now we’ve got a new object called <code>new_object</code>, and inside of it is the number 1. To look at what’s inside an object, we can simply type the name of the object into the console:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="R_Markdown.html#cb13-1" aria-hidden="true" tabindex="-1"></a>new_object</span>
<span id="cb13-2"><a href="R_Markdown.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span></code></pre></div>
<p>Easy! Let’s look at one of the objects that comes with our class code base. What are the dimensions of the “algae_data” data set?</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="R_Markdown.html#cb14-1" aria-hidden="true" tabindex="-1"></a>algae_data</span>
<span id="cb14-2"><a href="R_Markdown.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 180 × 5</span></span>
<span id="cb14-3"><a href="R_Markdown.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="do">##    replicate algae_strain harvesting_regime chemical_species           abundance</span></span>
<span id="cb14-4"><a href="R_Markdown.html#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="do">##        &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;             &lt;chr&gt;                          &lt;dbl&gt;</span></span>
<span id="cb14-5"><a href="R_Markdown.html#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  1         1 Tsv1         Heavy             FAs                            520. </span></span>
<span id="cb14-6"><a href="R_Markdown.html#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  2         1 Tsv1         Heavy             saturated_Fas                  123. </span></span>
<span id="cb14-7"><a href="R_Markdown.html#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  3         1 Tsv1         Heavy             omega_3_polyunsaturated_F…     186. </span></span>
<span id="cb14-8"><a href="R_Markdown.html#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  4         1 Tsv1         Heavy             monounsaturated_Fas             28.4</span></span>
<span id="cb14-9"><a href="R_Markdown.html#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  5         1 Tsv1         Heavy             polyunsaturated_Fas            369. </span></span>
<span id="cb14-10"><a href="R_Markdown.html#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  6         1 Tsv1         Heavy             omega_6_polyunsaturated_F…     183. </span></span>
<span id="cb14-11"><a href="R_Markdown.html#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  7         1 Tsv1         Heavy             lysine                          84.1</span></span>
<span id="cb14-12"><a href="R_Markdown.html#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  8         1 Tsv1         Heavy             methionine                      24.1</span></span>
<span id="cb14-13"><a href="R_Markdown.html#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  9         1 Tsv1         Heavy             essential_Aas                  692. </span></span>
<span id="cb14-14"><a href="R_Markdown.html#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 10         1 Tsv1         Heavy             non_essential_Aas              919. </span></span>
<span id="cb14-15"><a href="R_Markdown.html#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="do">## # … with 170 more rows</span></span></code></pre></div>
</div>
<div id="functions" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Functions</h2>
<p>Excellent - we’ve got data. Now we need to manipulate it. For this we need functions:</p>
<ul>
<li>A function is a command that tells R to perform an action!</li>
<li>A function begins and ends with parentheses: <code>this_is_a_function()</code></li>
<li>The stuff inside the parentheses are the details of how you want the function to perform its action: <code>run_this_analysis(on_this_data)</code></li>
</ul>
<p>Let’s illustrate this with an example. <code>algae_data</code> is a pretty big object. For our next chapter on visualization, it would be nice to have a smaller dataset object to work with. Let’s use another <code>tidyverse</code> command called <code>filter</code> to filter the <code>algae_data</code> object. We will need to tell the filter command what to filter out using “logical predicates” (things like equal to: <code>==</code>, less than: <code>&lt;</code>, greater than: <code>&gt;</code>, greater-than-or-equal-to: <code>&lt;=</code>, etc.). Let’s filter <code>algae_data</code> so that only rows where the <code>chemical_species</code> is equal to <code>FAs</code> (fatty acids) is preserved. This will look like <code>chemical_species == "FAs"</code>. Here we go:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="R_Markdown.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(algae_data, chemical_species <span class="sc">==</span> <span class="st">&quot;FAs&quot;</span>)</span>
<span id="cb15-2"><a href="R_Markdown.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 18 × 5</span></span>
<span id="cb15-3"><a href="R_Markdown.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="do">##    replicate algae_strain harvesting_regime chemical_species abundance</span></span>
<span id="cb15-4"><a href="R_Markdown.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="do">##        &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;             &lt;chr&gt;                &lt;dbl&gt;</span></span>
<span id="cb15-5"><a href="R_Markdown.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  1         1 Tsv1         Heavy             FAs                   520.</span></span>
<span id="cb15-6"><a href="R_Markdown.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  2         2 Tsv1         Heavy             FAs                   450.</span></span>
<span id="cb15-7"><a href="R_Markdown.html#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  3         3 Tsv1         Heavy             FAs                   514.</span></span>
<span id="cb15-8"><a href="R_Markdown.html#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  4         1 Tsv1         Light             FAs                   580.</span></span>
<span id="cb15-9"><a href="R_Markdown.html#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  5         2 Tsv1         Light             FAs                   535.</span></span>
<span id="cb15-10"><a href="R_Markdown.html#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  6         3 Tsv1         Light             FAs                   513.</span></span>
<span id="cb15-11"><a href="R_Markdown.html#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  7         1 Tsv2         Heavy             FAs                   373.</span></span>
<span id="cb15-12"><a href="R_Markdown.html#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  8         2 Tsv2         Heavy             FAs                   409.</span></span>
<span id="cb15-13"><a href="R_Markdown.html#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  9         3 Tsv2         Heavy             FAs                   390.</span></span>
<span id="cb15-14"><a href="R_Markdown.html#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 10         1 Tsv2         Light             FAs                   490.</span></span>
<span id="cb15-15"><a href="R_Markdown.html#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 11         2 Tsv2         Light             FAs                   541.</span></span>
<span id="cb15-16"><a href="R_Markdown.html#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 12         3 Tsv2         Light             FAs                   461.</span></span>
<span id="cb15-17"><a href="R_Markdown.html#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 13         1 Tsv11        Heavy             FAs                   474.</span></span>
<span id="cb15-18"><a href="R_Markdown.html#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 14         2 Tsv11        Heavy             FAs                   331.</span></span>
<span id="cb15-19"><a href="R_Markdown.html#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 15         3 Tsv11        Heavy             FAs                   530.</span></span>
<span id="cb15-20"><a href="R_Markdown.html#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 16         1 Tsv11        Light             FAs                   526.</span></span>
<span id="cb15-21"><a href="R_Markdown.html#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 17         2 Tsv11        Light             FAs                   514.</span></span>
<span id="cb15-22"><a href="R_Markdown.html#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 18         3 Tsv11        Light             FAs                   544.</span></span></code></pre></div>
<p>Cool! Now it’s just showing us the 18 rows where the chemical_species is fatty acids (FAs). Let’s write this new, smaller dataset into a new object. For that we use <code>&lt;-</code>, remember?</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="R_Markdown.html#cb16-1" aria-hidden="true" tabindex="-1"></a>algae_data_small <span class="ot">&lt;-</span> <span class="fu">filter</span>(algae_data, chemical_species <span class="sc">==</span> <span class="st">&quot;FAs&quot;</span>)</span>
<span id="cb16-2"><a href="R_Markdown.html#cb16-2" aria-hidden="true" tabindex="-1"></a>algae_data_small</span>
<span id="cb16-3"><a href="R_Markdown.html#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 18 × 5</span></span>
<span id="cb16-4"><a href="R_Markdown.html#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="do">##    replicate algae_strain harvesting_regime chemical_species abundance</span></span>
<span id="cb16-5"><a href="R_Markdown.html#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="do">##        &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;             &lt;chr&gt;                &lt;dbl&gt;</span></span>
<span id="cb16-6"><a href="R_Markdown.html#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  1         1 Tsv1         Heavy             FAs                   520.</span></span>
<span id="cb16-7"><a href="R_Markdown.html#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  2         2 Tsv1         Heavy             FAs                   450.</span></span>
<span id="cb16-8"><a href="R_Markdown.html#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  3         3 Tsv1         Heavy             FAs                   514.</span></span>
<span id="cb16-9"><a href="R_Markdown.html#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  4         1 Tsv1         Light             FAs                   580.</span></span>
<span id="cb16-10"><a href="R_Markdown.html#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  5         2 Tsv1         Light             FAs                   535.</span></span>
<span id="cb16-11"><a href="R_Markdown.html#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  6         3 Tsv1         Light             FAs                   513.</span></span>
<span id="cb16-12"><a href="R_Markdown.html#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  7         1 Tsv2         Heavy             FAs                   373.</span></span>
<span id="cb16-13"><a href="R_Markdown.html#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  8         2 Tsv2         Heavy             FAs                   409.</span></span>
<span id="cb16-14"><a href="R_Markdown.html#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  9         3 Tsv2         Heavy             FAs                   390.</span></span>
<span id="cb16-15"><a href="R_Markdown.html#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 10         1 Tsv2         Light             FAs                   490.</span></span>
<span id="cb16-16"><a href="R_Markdown.html#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 11         2 Tsv2         Light             FAs                   541.</span></span>
<span id="cb16-17"><a href="R_Markdown.html#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 12         3 Tsv2         Light             FAs                   461.</span></span>
<span id="cb16-18"><a href="R_Markdown.html#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 13         1 Tsv11        Heavy             FAs                   474.</span></span>
<span id="cb16-19"><a href="R_Markdown.html#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 14         2 Tsv11        Heavy             FAs                   331.</span></span>
<span id="cb16-20"><a href="R_Markdown.html#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 15         3 Tsv11        Heavy             FAs                   530.</span></span>
<span id="cb16-21"><a href="R_Markdown.html#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 16         1 Tsv11        Light             FAs                   526.</span></span>
<span id="cb16-22"><a href="R_Markdown.html#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 17         2 Tsv11        Light             FAs                   514.</span></span>
<span id="cb16-23"><a href="R_Markdown.html#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 18         3 Tsv11        Light             FAs                   544.</span></span></code></pre></div>
</div>
<div id="ggplot" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> ggplot</h2>
<p>Now we have a nice, small table that we can use to practice data visualization. For visualization, we’re going to use <code>ggplot2</code> - a powerful set of commands for plot generation.</p>
<p>There are three steps to setting up a ggplot:</p>
<ol style="list-style-type: decimal">
<li><strong>Define the data you want to use.</strong></li>
</ol>
<p>We do this using the ggplot function’s data argument. When we run that line, it just shows a grey plot space. Why is this? It’s because all we’ve done is told ggplot that (i) we want to make a plot and (ii) what data should be used. We haven’t explained how to represent features of the data using ink.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="R_Markdown.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> algae_data_small)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" width="384" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Define how your variables map onto the axes.</strong></li>
</ol>
<p>This is called aesthetic mapping and is done with the <code>aes()</code> function. <code>aes()</code> should be placed inside the <code>ggplot</code> command. Now when we run it, we get our axes!</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="R_Markdown.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> algae_data_small, <span class="fu">aes</span>(<span class="at">x =</span> algae_strain, <span class="at">y =</span> abundance))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" width="384" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Use geometric shapes to represent other variables in your data.</strong></li>
</ol>
<p>Map your variables onto the geometric features of the shapes. To define which shape should be used, use a <code>geom_*</code> command. Some options are, for example, <code>geom_point()</code>, <code>geom_boxplot()</code>, and <code>geom_violin()</code>. These functions should be added to your plot using the <code>+</code> sign. We can use a new line to keep the code from getting too wide, just make sure the <code>+</code> sign is at the end fo the top line. Let’s try it:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="R_Markdown.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> algae_data_small, <span class="fu">aes</span>(<span class="at">x =</span> algae_strain, <span class="at">y =</span> abundance)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="R_Markdown.html#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>In the same way that we mapped variables in our dataset to the plot axes, we can map variables in the dataset to the geometric features of the shapes we are using to represent our data. For this, again, use <code>aes()</code> to map your variables onto the geometric features of the shapes:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="R_Markdown.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> algae_data_small, <span class="fu">aes</span>(<span class="at">x =</span> algae_strain, <span class="at">y =</span> abundance)) <span class="sc">+</span> </span>
<span id="cb20-2"><a href="R_Markdown.html#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> harvesting_regime))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-23-1.png" width="384" style="display: block; margin: auto;" /></p>
<div id="modifying-geoms" class="section level3" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> modifying geoms</h3>
<p>In the last plot in the previous section, the points were a bit small, how could we fix that? We can modify the features of the shapes by adding additional arguments to the <code>geom_*()</code> functions. To change the size of the points created by the <code>geom_point()</code> function, this means that we need to add the <code>size =</code> argument. Here’s an example:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="R_Markdown.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> algae_data_small, <span class="fu">aes</span>(<span class="at">x =</span> algae_strain, <span class="at">y =</span> abundance)) <span class="sc">+</span> </span>
<span id="cb21-2"><a href="R_Markdown.html#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> harvesting_regime), <span class="at">size =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>One powerful aspect of <code>ggplot</code> is the ability to quickly change mappings to see if alternative plots are more effective at bringing out the trends in the data. For example, we could modify the plot above by switching how harvesting_regime is mapped:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="R_Markdown.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> algae_data_small, <span class="fu">aes</span>(<span class="at">x =</span> algae_strain, <span class="at">y =</span> abundance)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="R_Markdown.html#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> harvesting_regime), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-25-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>** Important note: Inside the <code>aes()</code> function, map aesthetics (the features of the geom’s shape) to a <em>variable</em>. Outside the <code>aes()</code> function, map aesthetics to <em>constants</em>. You can see this in the above two plots - in the first one, color is inside <code>aes()</code> and mapped to the variable called harvesting_regime, while size is outside the <code>aes()</code> call and is set to the constant 5. In the second plot, the situation is reversed, with size being inside the <code>aes()</code> function and mapped to the variable harvesting_regime, while color is outside the <code>aes()</code> call and is mapped to the constant “black”.</p>
</div>
<div id="multiple-geoms" class="section level3" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> multiple geoms</h3>
<p>We can also stack geoms on top of one another by using multiple <code>+</code> signs. We also don’t have to assign the same mappings to each geom.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="R_Markdown.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> algae_data_small, <span class="fu">aes</span>(<span class="at">x =</span> algae_strain, <span class="at">y =</span> abundance)) <span class="sc">+</span> </span>
<span id="cb23-2"><a href="R_Markdown.html#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb23-3"><a href="R_Markdown.html#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> harvesting_regime), <span class="at">size =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-26-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>As you can probably guess right now, there are lots of mappings that can be done, and lots of different ways to look at the same data!</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="R_Markdown.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> algae_data_small, <span class="fu">aes</span>(<span class="at">x =</span> algae_strain, <span class="at">y =</span> abundance)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="R_Markdown.html#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> algae_strain)) <span class="sc">+</span></span>
<span id="cb24-3"><a href="R_Markdown.html#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> harvesting_regime, <span class="at">size =</span> replicate))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" width="384" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="R_Markdown.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> algae_data_small, <span class="fu">aes</span>(<span class="at">x =</span> algae_strain, <span class="at">y =</span> abundance)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="R_Markdown.html#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="markdown" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> markdown</h2>
<p>Now that we are able to filter our data and make plots, we are ready to make reports to show others the data processing and visualization that we are doing. For this, we will use R Markdown. You can open a new markdown document in RStudio by clicking: <code>File -&gt; New File -&gt; R Markdown</code>. You should get a template document that compiles when you press “knit”.</p>
<p>Customize this document by modifying the title, and add <code>author: "your_name"</code> to the header. Delete all the content below the header, then compile again. You should get a page that is blank except for the title and the author name.</p>
<p>You can think of your markdown document as a stand-alone R Session. This means you will need to load our class code base into each new markdown doument you create. You can do this by adding a “chunk” or R code. That looks like this:</p>
<p><img src="http://thebustalab.github.io/R_For_Chemists_2/images/markdown_1.png" style="display: block; margin: auto;" /></p>
<p>You should notice a few things when you compile this document:</p>
<ol style="list-style-type: decimal">
<li><p>Headings: When you compile that code, the “# My first analysis” creates a header. You can create headers of various levels by increasing the number of hashtags you use in front of the header. For example, “## Part 1” will create a subheading, “### Part 1.1” will create a sub-subheading, and so on.</p></li>
<li><p>Plain text: Plain text in an R Markdown document creates a plan text entry in your compiled document. You can use this to explain your analyses and your figures, etc.</p></li>
</ol>
<p>We can also run R chunks right in markdown and create figures. Dr. Busta will show you how to do this in class.</p>
</div>
<div id="exercises" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> exercises</h2>
<p>In this set of exercises we’re going to practice filtering and plotting data in R Markdown. We’re going to work with two datasets: (i) algae_data and (ii) alaska_lake_data. <strong>For these exercises, you will write your code and answers to all questions in an R Markdown report, compile it as a pdf, and submit it on Canvas. If you have any questions please let me know</strong></p>
<p>Some pointers:</p>
<ul>
<li><p>If your code goes off the page, don’t be afraid to wrap it across multiple lines, as shown in some of the examples.</p></li>
<li><p>Don’t be afraid to put the variable with the long elements / long text on the y-axis and the continuous variable on the x-axis.</p></li>
</ul>
<div id="algae-chemistry-dataset" class="section level3" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Algae Chemistry Dataset</h3>
<ol style="list-style-type: decimal">
<li><strong>Filtering 1</strong></li>
</ol>
<p>You will have <code>algae_data</code> stored in an object called <code>algae_data</code> as soon as you run <code>source("http://thebustalab.github.io/phylochemistry/phylochemistry.R")</code>. For this question, filter the data so that only entries are shown for which the <code>chemical_species</code> is “FAs” (remember that quotes are needed around FAs here!). What are the dimensions (i.e. number of rows and columns) of the resulting dataset?</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Filtering 2</strong></li>
</ol>
<p>Now filter the dataset so that only entries for the <code>algae_strain</code> “Tsv1” are shown. What are the dimensions of the resulting dataset?</p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Filtering 3</strong></li>
</ol>
<p>Now filter the dataset so that only entries with an abundance greater than 250 are shown. Note that <code>&gt;</code> can be used in the filter command instead of <code>==</code>, and that numbers inside a filter command do not require quotes around them. What are the dimensions of the resulting dataset?</p>
<ol start="4" style="list-style-type: decimal">
<li><strong>Plotting</strong></li>
</ol>
<p>Make a ggplot that has <code>algae_strain</code> on the x axis and <code>abundance</code> on the y axis. Remember about <code>aes()</code>. Use points (<code>geom_point()</code>) to represent each compound. You don’t need to color the points.</p>
<p>Which algae strain has the most abundant compound out of all the compounds in the dataset?</p>
<ol start="5" style="list-style-type: decimal">
<li><strong>Plotting</strong></li>
</ol>
<p>Make a ggplot that has <code>abundance</code> on the x axis and <code>chemical_species</code> on the y axis. Use points to represent each compound. You don’t need to color the points.</p>
<p>Generally speaking, what are the two most abundant classes of chemical species in these algae strains? (FAs/Fas stand for fatty acids, AAs/Aas stand for amino acids.)</p>
<ol start="6" style="list-style-type: decimal">
<li><strong>Filtering and plotting</strong></li>
</ol>
<p>I am going to show you an example of how you can filter and plot at the same time. To do this, we nest the filter command inside ggplot’s data argument:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="R_Markdown.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb26-2"><a href="R_Markdown.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">filter</span>(algae_data, chemical_species <span class="sc">==</span> <span class="st">&quot;essential_Aas&quot;</span>),</span>
<span id="cb26-3"><a href="R_Markdown.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> algae_strain, <span class="at">y =</span> abundance)) <span class="sc">+</span></span>
<span id="cb26-4"><a href="R_Markdown.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-35-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Using the above as a template, make a plot that shows just <code>omega_3_polyunsaturated_Fas</code>, with algae_strain on the x axis, and abundance on the y axis. Color the points so that they correspond to <code>harvesting_regime</code>. Remember that mapping a feature of a shape onto a variable must be done inside <code>aes()</code>. Change the plot so that all the points are size = 5. Remember that mapping features of a shape to a constant needs to be done outside <code>aes()</code>. Which harvesting regime leads to higher levels of <code>omega_3_polyunsaturated_Fas</code>?</p>
<ol start="7" style="list-style-type: decimal">
<li><strong>Filtering and plotting</strong></li>
</ol>
<p>Use a combination of filtering and plotting to show the abundance of the different chemical species in just the <code>algae_strain</code> called “Tsv1”. Use an x and y axis, as well as points to represent the measurements. Make point size correspond to the replicate, and color the points according to harvesting regime.</p>
<ol start="8" style="list-style-type: decimal">
<li><strong>Open-ended plotting</strong></li>
</ol>
<p>Make a plot that checks to see which <code>chemical_species</code> were more abundant under light as opposed to heavy <code>harvesting_regime</code> in all three replicates. Use filtered data so that just one <code>algae_strain</code> is shown, an x and a y axis, and points to represent the measurements. Make the points <code>size = 5</code> and also set the point’s <code>alpha = 0.6</code>. The points should be colored according to harvesting_regime. Make 3 plots, one for each strain of algae.</p>
<ol start="9" style="list-style-type: decimal">
<li><strong>A peek at what’s to come…</strong></li>
</ol>
<p>Take the code that you made for Question 9. Remove the filtering. Add the following line to the end of the plot: <code>facet_grid(.~algae_strain)</code>. Remember that adding things to plots is done with the <code>+</code> sign, so your code should look something like:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="R_Markdown.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> algae_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">&lt;</span>something<span class="sc">&gt;</span>, <span class="at">y =</span> <span class="sc">&lt;</span>something <span class="cf">else</span><span class="sc">&gt;</span>)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="R_Markdown.html#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="sc">&lt;</span>some things<span class="sc">&gt;</span>), <span class="sc">&lt;</span>some here too<span class="sc">&gt;</span>) <span class="sc">+</span></span>
<span id="cb27-3"><a href="R_Markdown.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>algae_strain)</span></code></pre></div>
<p>Also try, instead of <code>facet_grid(.~algae_strain)</code>, <code>facet_grid(algae_strain~.)</code> at the end of you plot command. (note the swap in the position of the <code>.~</code> relative to <code>algae_strain</code>). This means your code should look something like:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="R_Markdown.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> algae_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">&lt;</span>something<span class="sc">&gt;</span>, <span class="at">y =</span> <span class="sc">&lt;</span>something <span class="cf">else</span><span class="sc">&gt;</span>)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="R_Markdown.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="sc">&lt;</span>some things<span class="sc">&gt;</span>), <span class="sc">&lt;</span>some here too<span class="sc">&gt;</span>) <span class="sc">+</span></span>
<span id="cb28-3"><a href="R_Markdown.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(algae_strain<span class="sc">~</span>.)</span></code></pre></div>
<p>What advantages does this one extra line (i.e. facet_grid) provide over what you had to do in question 8?</p>
</div>
</div>
<div id="alaska-lakes-dataset" class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> Alaska Lakes Dataset</h2>
<ol style="list-style-type: decimal">
<li><strong>Viewing Data</strong></li>
</ol>
<p>Use R to view the first few lines of the <code>alaska_lake_data</code> dataset. Do your best to describe, in written format, the kind of data that are in this data set.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Objects</strong></li>
</ol>
<p>How many variables are in the Alaska lakes dataset?</p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Filtering</strong></li>
</ol>
<p>Filter the data set so only meausurements of free elements (i.e. element_type is “free”) are shown. Remember, it’s <code>==</code>, not <code>=</code>. What are the dimensions of the resulting dataset?</p>
<ol start="4" style="list-style-type: decimal">
<li><strong>Plotting</strong></li>
</ol>
<p>Make a plot that shows the water temperatures of each lake. Don’t worry if you get a warning message from R about “missing values”. Which is the hottest lake? The coolest?</p>
<ol start="5" style="list-style-type: decimal">
<li><strong>Plotting</strong></li>
</ol>
<p>Make a plot that shows the water temperature of each lake. The x axis should be <code>park</code>, the y axis <code>water temp</code>. Add geom_violin() to the plot first, then geom_point(). Make the points size = 5. Color the points according to water_temp. Which park has four lakes with very similar temperatures?</p>
<ol start="6" style="list-style-type: decimal">
<li><strong>Filtering and Plotting</strong></li>
</ol>
<p>From the plot you made for question 5, it should be apparent that there is one lake in NOAT that is much warmer than the others. Filter the data so that only entries from <code>park == "NOAT"</code> are shown (note the double equals sign and the quotes around NOAT…). Combine this filtering with plotting and use geom_point() to make a plot that shows which specific lake that is.</p>
<ol start="7" style="list-style-type: decimal">
<li><strong>Filtering and Plotting</strong></li>
</ol>
<p>Make a plot that shows which lake has the highest abundance of sulfur.</p>
<ol start="8" style="list-style-type: decimal">
<li><strong>Open-ended Plotting</strong></li>
</ol>
<p>Make a plot that uses geom_point(). Set the “shape” aesthetic of the points to 21, i.e. <code>geom_point(aes(...), shape = 21)</code>. This gives you access to a new aesthetics: <code>fill</code>. It also changes the behaviour of the <code>color</code> aesthetic slightly, in that it now controls border color, not the internal color. Here is an example (though it doesn’t make a very nice plot):</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="R_Markdown.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb29-2"><a href="R_Markdown.html#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">filter</span>(alaska_lake_data, lake <span class="sc">==</span> <span class="st">&quot;Lake_Narvakrak&quot;</span>),</span>
<span id="cb29-3"><a href="R_Markdown.html#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> lake, <span class="at">y =</span> mg_per_L)</span>
<span id="cb29-4"><a href="R_Markdown.html#cb29-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="R_Markdown.html#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb29-6"><a href="R_Markdown.html#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb29-7"><a href="R_Markdown.html#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;green&quot;</span></span>
<span id="cb29-8"><a href="R_Markdown.html#cb29-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-52-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Now we have lots of aesthetics we can map to: x, y, size, color, and fill (leave shape set to 21 for now). Make a plot of your own design. It should include filtering, and all the aesthetics listed above, though whether you map them to a variable or a constant is up to you.</p>
<p>When you are done with this plot, take a screen shot of it. Go to <a href="https://docs.google.com/presentation/d/1G0BJ_qye9a_HAPLktFytj66qSj20BjoUOTKtjmCyuN0/edit?usp=sharing">THIS GOOGLE SHEET</a>, make a slide for yourself (you don’t have to include your name), and paste your screen shot there. Add a small caption that explains how your variables are mapped.
<!-- end --></p>
<!-- start geoms, facets, scales, themes -->
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-visualization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="geoms_facets_scales_themes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "sepia",
"family": "serif",
"size": 1
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "section"
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

</body>

</html>
